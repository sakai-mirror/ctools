<project name="build-samigo" basedir="." default="info-samigo" >

  <!--

$Id: build.xml 5796 2006-02-06 19:03:57Z dlhaines@umich.edu $
$HeadURL: https://source.sakaiproject.org/svn/branches/ctools-winter-06/tools/build.xml $

Add samigo.

  -->

  <!-- 
       TTD:
  -->


  <target name="info-samigo" >
    <echo>
      fill me in.
    </echo>
  </target>


  <!-- ================================================== -->
  <!--      deal with Samigo specific source       -->
  <!-- ================================================== -->

  <!-- source is included in sakai -->
  <!-- edit the web.xml for db configuration -->

  <target name="editSamigo" unless="samigo.install.skip">

    <!-- update web.xml so that store files in a proper directory rather than in the db -->
    <replaceregexp match="/tmp/" replace="${samigo.upload.dir}">
      <fileset dir="${build.dir}/sam/tool/sakai-samigo/webapp" >
	<include name="**/web.xml" />
      </fileset>
    </replaceregexp>

    <!-- set the parameter to save the files to the file system, not the db -->
    <replaceregexp flags="i">
      <regexp pattern="(&lt;.*filter-class&gt;com.corejsf.UploadFilter&lt;/filter-class&gt;.*)">
      </regexp>
      <substitution expression="\1 &lt;init-param&gt; &lt;param-name&gt;com.corejsf.UploadFilter.saveMediaToDb&lt;/param-name&gt; &lt;param-value&gt;false&lt;/param-value&gt; &lt;/init-param&gt;" />

      <fileset dir="${build.dir}/sam/tool/sakai-samigo/webapp" >
	<include name="**/web.xml" />
      </fileset>
    </replaceregexp>

  </target>

  

</project>
