svn diff -r20725:20726 https://source.sakaiproject.org/svn
Index: rwiki/rwiki-model/.classpath
===================================================================
--- rwiki/rwiki-model/.classpath	(revision 20725)
+++ rwiki/rwiki-model/.classpath	(revision 20726)
@@ -1,6 +1,7 @@
 <?xml version="1.0" encoding="UTF-8"?>
 <classpath>
 	<classpathentry kind="src" path="src/java"/>
+	<classpathentry kind="src" path="src/test"/>
 	<classpathentry kind="con" path="org.eclipse.jdt.launching.JRE_CONTAINER"/>
 	<classpathentry kind="var" path="JUNIT_HOME/junit.jar"/>
 	<classpathentry combineaccessrules="false" kind="src" path="/rwiki-api"/>
Index: rwiki/rwiki-model/src/test/uk/ac/cam/caret/sakai/rwiki/model/test/RWikiObjectContentImplTest.java
===================================================================
--- rwiki/rwiki-model/src/test/uk/ac/cam/caret/sakai/rwiki/model/test/RWikiObjectContentImplTest.java	(revision 0)
+++ rwiki/rwiki-model/src/test/uk/ac/cam/caret/sakai/rwiki/model/test/RWikiObjectContentImplTest.java	(revision 20726)
@@ -0,0 +1,58 @@
+/**********************************************************************************
+ * $URL$
+ * $Id$
+ ***********************************************************************************
+ *
+ * Copyright (c) 2003, 2004, 2005, 2006, 2007 The Sakai Foundation.
+ *
+ * Licensed under the Educational Community License, Version 1.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.opensource.org/licenses/ecl1.php
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ **********************************************************************************/
+
+package uk.ac.cam.caret.sakai.rwiki.model.test;
+
+/**
+ * @author David Haines
+ *
+ */
+import uk.ac.cam.caret.sakai.rwiki.model.RWikiObjectContentImpl;
+import junit.framework.TestCase;
+
+public class RWikiObjectContentImplTest extends TestCase {
+
+        RWikiObjectContentImpl roci = null;
+        
+        protected void setUp() throws Exception {
+                super.setUp();
+                roci = new RWikiObjectContentImpl();
+        }
+
+        public void testSetContentString() {
+                String testContent = "testContentString";
+                roci.setContent(testContent);
+                assertTrue("content mismatch",testContent.equals(roci.getContent()));
+        }
+        
+        public void testSetContentEmptyString() {
+                String testContent = "";
+                roci.setContent(testContent);
+                assertTrue("content mismatch",testContent.equals(roci.getContent()));
+        }
+        
+        public void testSetContentNull() {
+                String testContent = null;
+                roci.setContent(testContent);
+                assertTrue("content mismatch","".equals(roci.getContent()));
+        }
+
+}

Index: rwiki/rwiki-model/src/java/uk/ac/cam/caret/sakai/rwiki/model/RWikiObjectContentImpl.java
===================================================================
--- rwiki/rwiki-model/src/java/uk/ac/cam/caret/sakai/rwiki/model/RWikiObjectContentImpl.java	(revision 20725)
+++ rwiki/rwiki-model/src/java/uk/ac/cam/caret/sakai/rwiki/model/RWikiObjectContentImpl.java	(revision 20726)
@@ -54,13 +54,14 @@
 
 	public String getContent()
 	{
+		if ( content == null ) content = "";
 		return content;
 	}
 
 	public void setContent(String content)
 	{
 		// SAK-2470
-		if (this.content == null) this.content = "";
+		if (content == null) content = "";
 		this.content= content.replaceAll("[\\x00-\\x08\\x0b\\x0c\\x0e-\\x1f\\ud800-\\udfff\\uffff\\ufffe]", "");
 	}
 
