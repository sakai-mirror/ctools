Update based on SAK-13736

=copy= SAK-13736/msgcntr.css,msgcntr/messageforums-app/src/webapp/css/msgcntr.css

=svnm= https://source.sakaiproject.org/svn/msgcntr/branches/SAK-13736/messageforums-app/src/webapp/images/@47427 https://source.sakaiproject.org/svn/msgcntr/branches/SAK-13736/messageforums-app/src/webapp/images/@47426 msgcntr/messageforums-app/src/webapp/images/

#JSF fix
=svnm= https://source.sakaiproject.org/svn//jsf/trunk/widgets/src/META-INF/@42476 jsf/widgets/src/META-INF/

#fix LazyInitializationException when create new thread in Forums.
=svnm= https://source.sakaiproject.org/svn/msgcntr/trunk@45224 msgcntr/

#Updates, keeping up-to-date on CT-589!

=svnm= https://source.sakaiproject.org/svn/msgcntr/branches/SAK-13736/@47579 msgcntr/

=svnm= https://source.sakaiproject.org/svn/msgcntr/branches/SAK-13736/@47733 msgcntr/

=svnm= https://source.sakaiproject.org/svn/msgcntr/branches/SAK-13736/@48013 msgcntr/

=svnm= https://source.sakaiproject.org/svn/msgcntr/branches/SAK-13736/@48103 msgcntr/

=svnm= https://source.sakaiproject.org/svn/msgcntr/branches/SAK-13736/@48112 msgcntr/

=svnm= https://source.sakaiproject.org/svn/msgcntr/branches/SAK-13736/@48258 msgcntr/

=svnm= https://source.sakaiproject.org/svn/msgcntr/branches/SAK-13736/@48260 msgcntr/

=svnm= https://source.sakaiproject.org/svn/msgcntr/branches/SAK-13736/@48262 msgcntr/

=svnm= https://source.sakaiproject.org/svn/msgcntr/branches/SAK-13736/@48263 msgcntr/

=svnm= https://source.sakaiproject.org/svn/msgcntr/branches/SAK-13736/@48300 msgcntr/

=svnm= https://source.sakaiproject.org/svn/msgcntr/branches/SAK-13736/@48301 msgcntr/

=svnm= https://source.sakaiproject.org/svn/msgcntr/branches/SAK-13736/@48302 msgcntr/

=svnm= https://source.sakaiproject.org/svn/msgcntr/branches/SAK-13736/@48303 msgcntr/

=svnm= https://source.sakaiproject.org/svn/msgcntr/branches/SAK-13736/@48304 msgcntr/

=svnm= https://source.sakaiproject.org/svn/msgcntr/branches/SAK-13736/@48388 msgcntr/


--- /dev/null
+++ SAK-13736.tmp
@@ -0,0 +1 @@
+ 
Index: msgcntr/messageforums-api/src/bundle/org/sakaiproject/api/app/messagecenter/bundle/Messages.properties
===================================================================
--- msgcntr/messageforums-api/src/bundle/org/sakaiproject/api/app/messagecenter/bundle/Messages.properties	(revision 46869)
+++ msgcntr/messageforums-api/src/bundle/org/sakaiproject/api/app/messagecenter/bundle/Messages.properties	(working copy)
@@ -16,10 +16,12 @@
 cdfm_title=Title
 cdfm_empty_title_error=Title cannot be empty.
 cdfm_message=Message
+cdfm_message_insert=Insert original text
 cdfm_attachments=Attachment(s):
-cdfm_no_attachments=No Attachments Yet
+cdfm_no_attachments=No attachments have been made
 cdfm_remove=Remove
-cdfm_button_bar_add_attachment_redirect=Add Attachment
+cdfm_button_bar_add_attachment_redirect=Add attachments
+cdfm_button_bar_add_attachment_more_redirect=Add more attachments
 cdfm_none=None
 cdfm_invalidMessageTitleString = Validation Error: Value is required.
 cdfm_button_bar_post_message=Post Message
@@ -64,6 +66,7 @@
 stat_forum_authored = Forum Authored
 
 cdfm_labels=Labels
+cdfm_newflag=New!
 cdfm_yes=Yes
 cdfm_no=No
 cdfm_draft=DRAFT
@@ -85,7 +88,7 @@
 cdfm_thread=Thread
 cdfm_collapse_expand_all=Expand All/Collapse All
 cdfm_label=Label
-cdfm_other_actions = Other Actions
+cdfm_other_actions = Show/Hide Actions
 cdfm_display_options=Display Options
 cdfm_forum_settings=Forum Settings
 cdfm_topic_settings=Topic Settings
@@ -103,6 +106,9 @@
 cdfm_previous_thread=< Previous Thread
 cdfm_read_full_description=Read Full Description
 cdfm_hide_full_description=Hide Full Description
+cdfm_read_full_description_andatts=(and attachments)
+cdfm_no_topics=There are no topics posted in this forum. 
+cdfm_no_messages=There are no messages posted. 
 cdfm_access=Access
 cdfm_contributors=Contributor(s)
 cdfm_read_only_access=Read-only Access
@@ -112,19 +118,22 @@
 cdfm_info_required_sign=*
 cdfm_forum_title=Forum Title
 cdfm_forum_posting=Forum Posting
-cdfm_shortDescription=Short Description
+cdfm_shortDescription=Short Description (255 characters max)
 cdfm_fullDescription=Description
 cdfm_discussion_forum_settings=Forum Settings
 cdfm_settings_instruction=Required items marked with 
 cdfm_lock_forum=Lock Forum (Disable forum postings)
 cdfm_moderate_forum=Moderate Topics in Forum
 cdfm_moderate_forums=Moderate Topics in Forums
-cdfm_button_bar_save_setting=Save Settings
+cdfm_button_bar_save_setting=Save
 cdfm_button_bar_save_draft=Save Draft
 cdfm_button_bar_save_setting_add_topic=Save Settings & Add Topic
+cdfm_delete_forum_title=Delete Forum
 cdfm_delete_forum=You are about to delete all the topics and messages associated with the forum.  Are you sure you want to delete the following forum and its contents?
 cdfm_discussion_topic_settings=Topic Settings
 cdfm_topic_title=Topic Title
+cdfm_moderated=moderated
+cdfm_notmoderated=not moderated
 cdfm_topic_post_before_reading=Post Before Reading
 cdfm_topic_posting=Topic Posting
 cdfm_topic_annonymous_responses=Anonymous Responses
@@ -135,6 +144,7 @@
 cdfm_topic_response_visibility=Response Visibility
 cdfm_lock_topic=Lock Topic (Disable topic postings)
 cdfm_moderate_topic=Moderate Topic
+cdfm_delete_topic_title=Delete Topic
 cdfm_delete_topic=You are about to delete this topic and all of the messages associated with the topic.  Are you sure you want to delete the following topic and its contents?
 cdfm_short_desc_too_long=Short description cannot be longer than 255 characters.
 cdfm_last_revise_msg=Last Edited By 
@@ -175,8 +185,8 @@
 cdfm_alert=Alert: 
 cdfm_drafts=Drafts
 cdfm_msg_pending_queue=Pending Messages
-cdfm_msg_pending_label=PENDING
-cdfm_msg_denied_label=DENIED
+cdfm_msg_pending_label=Pending
+cdfm_msg_denied_label=Denied
 cdfm_msg_deleted_label=This message has been deleted
 cdfm_approved_alert=Message has been approved.
 cdfm_denied_alert=Message has been denied.
@@ -201,6 +211,7 @@
 cdfm_attsize = Size
 cdfm_atttype = Type
 cdfm_replyto = Replying To
+cdfm_replytoshowhide = Show/hide replying-to mesage
 cdfm_from = From
 cdfm_subject = Subject
 cdfm_grade_msg = Grade Forum Message
@@ -225,6 +236,7 @@
 cdfm_closeb = )
 cdfm_dash = -
 cdfm_forum_locked = This forum is locked
+cdfm_forum_noforums=No forums have been created.
 cdfm_revise_forum_msg = Edit Forum Message
 cdfm_topic_moderated_flag=; Moderated
 cdfm_add_comment = Add Comment to Denied Posting
@@ -237,9 +249,10 @@
 cdfm_no_gb_perm=You do not have permission to view or grade the selected gradebook item for this student.
 
 #Permissions 
-perm_level= Permission Level : 
+perm_level= gets this permission level: 
 perm_role=Role
-perm_role_label=Role :
+perm_role_label=This site role:
+perm_custom=which you can customize below:
 perm_new_forum=New Forum
 perm_new_topic=New Topic
 perm_new_response=New Response
@@ -457,8 +470,8 @@
 
 syn_mark_as_read=Mark all as read
 syn_site_heading=Site
-syn_private_heading=Messages
-syn_discussion_heading=Forums
+syn_private_heading=New Messages
+syn_discussion_heading=New in Forums
 syn_no_messages=None
 syn_no_sites=There are currently no sites to display at this location.
 syn_no_mc=There are currently no messages at this location.
Index: msgcntr/messageforums-app/src/java/org/sakaiproject/tool/messageforums/jsf/HideDivisionRenderer.java
===================================================================
--- msgcntr/messageforums-app/src/java/org/sakaiproject/tool/messageforums/jsf/HideDivisionRenderer.java	(revision 46869)
+++ msgcntr/messageforums-app/src/java/org/sakaiproject/tool/messageforums/jsf/HideDivisionRenderer.java	(working copy)
@@ -109,10 +109,10 @@
     String foldImage = foldDiv ? FOLD_IMG_HIDE : FOLD_IMG_SHOW;
     writer.write("<" + BARTAG + " class=\"" + BARSTYLE + "\">");
     writer.write("<table style=\"width: 100%;\" class=\"discTria\" cellpadding=\"0\" cellspacing=\"0\" summary=\"layout\">");
-    writer.write("<tr><td  class=\"discTria\">");
+    writer.write("<tr><td  class=\"discTria\" onclick=\"javascript:showHideDivBlock('" + id +
+        "', '" +  RESOURCE_PATH + "');\">" );
     writer.write("  <img id=\"" + id + "__img_hide_division_" + "\" alt=\"" +
-        title + "\"" + " onclick=\"javascript:showHideDivBlock('" + id +
-        "', '" +  RESOURCE_PATH + "');\"");
+        title + "\"");
     writer.write("    src=\""   + foldImage + "\" style=\"" + CURSOR + "\" />");
     writer.write("<h4>"  + title + "</h4>");
     writer.write("</td><td class=\"discTria\">&nbsp;</td>");
Index: msgcntr/messageforums-app/src/java/org/sakaiproject/tool/messageforums/jsf/HierDataTableRender.java
===================================================================
--- msgcntr/messageforums-app/src/java/org/sakaiproject/tool/messageforums/jsf/HierDataTableRender.java	(revision 46869)
+++ msgcntr/messageforums-app/src/java/org/sakaiproject/tool/messageforums/jsf/HierDataTableRender.java	(working copy)
@@ -300,7 +300,7 @@
 			//////
 			if(dmb.getDepth() > 0 && !noArrows.equals("true"))
 			{
-				//////writer.write("<div style=\"display:none\"  id=\"_id_" + new Integer(hideDivNo).toString() + "__hide_division_" + "\">");
+				//////writer.write("<div class=\"hideDiv\" style=\"display:none\"  id=\"_id_" + new Integer(hideDivNo).toString() + "__hide_division_" + "\">");
 				writer.write("<tr style=\"display:none\" id=\"_id_" + new Integer(hideDivNo).toString() + "__hide_division_" + "\">");
 			}
 			else if(dmb.getDepth() > 0)
Index: msgcntr/messageforums-app/src/webapp/images/collapse.gif
===================================================================
Cannot display: file marked as a binary type.
svn:mime-type = application/octet-stream
Index: msgcntr/messageforums-app/src/webapp/js/forum.js
===================================================================
--- msgcntr/messageforums-app/src/webapp/js/forum.js	(revision 46869)
+++ msgcntr/messageforums-app/src/webapp/js/forum.js	(working copy)
@@ -3,6 +3,9 @@
 {
   panelId = thisid;
 }
+
+
+/*
 function showHideDivBlock(hideDivisionNo, context)
 {
   var tmpdiv = hideDivisionNo + "__hide_division_";
@@ -29,10 +32,90 @@
     }
     if(panelId != null)
     {
-      setMainFrameHeight(panelId);
+      resizeFrame('grow');
     }
   }
 }
+*/
+
+
+function showHideDivBlock(hideDivisionNo, context)
+{
+	var tmpdiv = hideDivisionNo + "__hide_division_";
+	var tmpimg = hideDivisionNo + "__img_hide_division_";
+	var divisionNo = getTheElement(tmpdiv);
+	var imgNo = getTheElement(tmpimg);
+	// toggle a fade
+	jQuery.fn.fadeToggle = function(speed, easing, callback) {
+		return this.animate({opacity: 'toggle'}, 500, easing, callback);
+	};
+	if(divisionNo){
+		if ( $(divisionNo).is(':visible') ){
+			if (imgNo)
+			{
+				imgNo.src = context + "/images/right_arrow.gif";
+			}
+		}
+		else
+		{
+			if(imgNo)
+			{
+				imgNo.src = context + "/images/down_arrow.gif";
+			}
+		}
+		$(divisionNo).fadeToggle();
+		if(panelId != null)
+		{
+			resizeFrame('grow');
+		}
+	}
+}
+
+
+//this function needs jquery 1.1.2 or later - it resizes the parent iframe without bringing the scroll to the top
+	function resizeFrame(updown)
+	{
+		if (top.location != self.location) 	 {
+			var frame = parent.document.getElementById(window.name);
+		}
+			if( frame )
+		{
+			if(updown=='shrink')
+			{
+				var clientH = document.body.clientHeight - 30;
+			}
+			else
+			{
+				var clientH = document.body.clientHeight + 30;
+			}
+			$( frame ).height( clientH );
+		}
+		else
+		{
+			throw( "resizeFrame did not get the frame (using name=" + window.name + ")" );
+		}
+	}
+
+
+/*
+
+function showHideDivBlock(hideDivisionNo, context){
+
+  var tmpdiv = hideDivisionNo + "__hide_division_";
+  var tmpimg = hideDivisionNo + "__img_hide_division_";
+  var divisionNo = getTheElement(tmpdiv);
+  var imgNo = getTheElement(tmpimg);
+
+
+	if (divisionNo.style.display == "block") {
+		imgNo.src = context + "/images/right_arrow.gif";
+	}
+	else {
+		imgNo.src = context + "/images/down_arrow.gif";
+	}
+}
+
+*/
 function showHideDiv(hideDivisionNo, context)
 {
   var tmpdiv = hideDivisionNo + "__hide_division_";
@@ -86,7 +169,7 @@
     thiselm = document.layers[thisid];
   }
 
-  if(thiselm)   
+  if(thiselm)
   {
     if(thiselm == null)
     {
@@ -101,25 +184,38 @@
 
 function check(field)
  {
-    for (i = 0; i < field.length; i++) 
+    for (i = 0; i < field.length; i++)
     {
         field[i].checked = true;
     }
  }
 function unCheck(field)
 {
-    for (i = 0; i < field.length; i++) 
+    for (i = 0; i < field.length; i++)
     {
-        field[i].checked = false; 
+        field[i].checked = false;
     }
 }
 
 function toggleDisplay(obj) {
 	resize();
 	$("#" + obj).slideToggle("normal", resize);
-	return;    
+	return;
 }
 
+
+jQuery.fn.fadeToggle = function(speed, easing, callback) {
+   return this.animate({opacity: 'toggle'}, speed, easing, callback);
+
+}; 
+function toggleDisplayInline(obj) {
+//	resize();
+//		$("#" + obj).slideToggle("normal", resize);
+		$("#" + obj).fadeToggle();
+
+	return;
+}
+
 function toggleHide(obj){
 	if(obj.innerHTML.match(/hide/i)){
 		obj.innerHTML = obj.innerHTML.replace('Hide ', '');
@@ -127,6 +223,7 @@
 		obj.innerHTML = obj.innerHTML.replace(/(<.+>)([^<>]+)/i, "$1 Hide $2");
 	}
 }
+
 function getScrollDist(obj){
 	var curtop = 0;
 	if (obj.offsetParent) {
@@ -137,12 +234,12 @@
 	}
 	return curtop;
 }
-function selectDeselectCheckboxes(mainCheckboxId, myForm) {   
+function selectDeselectCheckboxes(mainCheckboxId, myForm) {
 	var el = getTheElement(mainCheckboxId);
-	var isChecked = el.checked;           
+	var isChecked = el.checked;
 	for ( i = 0; i < myForm.elements.length; i++ ) {
 		if (myForm.elements[i].type == 'checkbox' ) {
-			myForm.elements[i].checked  = isChecked;                                               
+			myForm.elements[i].checked  = isChecked;
 		}
 	}
 }
@@ -150,7 +247,7 @@
   mainCheckboxEl = getTheElement(checkboxId);
   if (mainCheckboxEl.checked = true) {
   	mainCheckboxEl.checked = false;
-  }                                                  
+  }
 }
 // if the containing frame is small, then offsetHeight is pretty good for all but ie/xp.
 // ie/xp reports clientHeight == offsetHeight, but has a good scrollHeight
@@ -166,8 +263,8 @@
 
 		var objToResize = (frame.style) ? frame.style : frame;
 
-		var height; 
-		
+		var height;
+
 		var scrollH = document.body.scrollHeight;
 		var offsetH = document.body.offsetHeight;
 		var clientH = document.body.clientHeight;
@@ -194,7 +291,7 @@
 		}
 
 		// here we fudge to get a little bigger
-		//gsilver: changing this from 50 to 10, and adding extra bottom padding to the portletBody		
+		//gsilver: changing this from 50 to 10, and adding extra bottom padding to the portletBody
 		var newHeight = height + 150;
 		//contributed patch from hedrick@rutgers.edu (for very long documents)
 		if (newHeight > 32760)
@@ -203,7 +300,7 @@
 		// no need to be smaller than...
 		//if (height < 200) height = 200;
 		objToResize.height=newHeight + "px";
-	
+
 		var s = " scrollH: " + scrollH + " offsetH: " + offsetH + " clientH: " + clientH + " innerDocScrollH: " + innerDocScrollH + " Read height: " + height + " Set height to: " + newHeight;
 
 	}
@@ -220,7 +317,7 @@
             }, 500);
          } else {
             $(self).remove();
-            $("#" + messageId).parents("tr:first").css("backgroundColor", "#ffD0DC");         
+            $("#" + messageId).parents("tr:first").css("backgroundColor", "#ffD0DC");
          }
       },
       error: function(){
Index: msgcntr/messageforums-app/src/webapp/jsp/main.jsp
===================================================================
--- msgcntr/messageforums-app/src/webapp/jsp/main.jsp	(revision 46869)
+++ msgcntr/messageforums-app/src/webapp/jsp/main.jsp	(working copy)
@@ -21,11 +21,13 @@
 <f:view>
   <sakai:view title="#{msgs.cdfm_message_forums}">
 <!--jsp/main.jsp-->
+
        <h:form id="msgForum">
-       		<script type="text/javascript" src="/library/js/jquery.js"></script>
+
+      		<script type="text/javascript" src="/library/js/jquery.js"></script>
        		<sakai:script contextBase="/sakai-messageforums-tool" path="/js/sak-10625.js"/>
 				<sakai:script contextBase="/sakai-messageforums-tool" path="/js/forum.js"/>
-				<%--gsilver:if layout="table" is needed,  need rendered attr here so that no empty tables  are put in the response - leaving undefined here so that it reverts to layout="list" --%> 
+				<%--//designNote:  if layout="table" is needed,  need rendered attr here so that no empty tables  are put in the response - leaving undefined here so that it reverts to layout="list" --%> 
 				<h:messages globalOnly="true" infoClass="success" errorClass="alertMessage" />  		
   
   		  <%-- include hide division here so that pvtArea can be used w/o div in isolated view --%>	
Index: msgcntr/messageforums-app/src/webapp/jsp/dfReviseForumSettingsAttach.jsp
===================================================================
--- msgcntr/messageforums-app/src/webapp/jsp/dfReviseForumSettingsAttach.jsp	(revision 46869)
+++ msgcntr/messageforums-app/src/webapp/jsp/dfReviseForumSettingsAttach.jsp	(working copy)
@@ -1,150 +1,174 @@
 <%@ page import="java.util.*, javax.faces.context.*, javax.faces.application.*,
-                 javax.faces.el.*, org.sakaiproject.tool.messageforums.*"%>
+	javax.faces.el.*, org.sakaiproject.tool.messageforums.*"%>
 <%@ taglib uri="http://java.sun.com/jsf/html" prefix="h" %>
 <%@ taglib uri="http://java.sun.com/jsf/core" prefix="f" %>
 <%@ taglib uri="http://sakaiproject.org/jsf/sakai" prefix="sakai" %>
 <%@ taglib uri="http://sakaiproject.org/jsf/messageforums" prefix="mf" %>
 <jsp:useBean id="msgs" class="org.sakaiproject.util.ResourceLoader" scope="session">
-   <jsp:setProperty name="msgs" property="baseName" value="org.sakaiproject.api.app.messagecenter.bundle.Messages"/>
+	<jsp:setProperty name="msgs" property="baseName" value="org.sakaiproject.api.app.messagecenter.bundle.Messages"/>
 </jsp:useBean>
 <f:view>
-  <sakai:view title="#{msgs.cdfm_discussion_forum_settings}">
-  <!-- Y:\msgcntr\messageforums-app\src\webapp\jsp\dfReviseForumSettingsAttach.jsp -->
+	<sakai:view title="#{msgs.cdfm_discussion_forum_settings}">
+		<!-- Y:\msgcntr\messageforums-app\src\webapp\jsp\dfReviseForumSettingsAttach.jsp -->
+		<h:form id="revise">
+			<style type="text/css">
+				@import url("/sakai-messageforums-tool/css/msgcntr.css");
+			</style>
+			<script type="text/javascript" src="/library/js/jquery.js"></script>
+			<sakai:script contextBase="/sakai-messageforums-tool" path="/js/sak-10625.js"/>
+			<sakai:tool_bar_message value="#{msgs.cdfm_discussion_forum_settings}" />
+			<div class="instruction">
+				<h:outputText id="instruction"  value="#{msgs.cdfm_settings_instruction}"/>
+				<h:outputText value="#{msgs.cdfm_info_required_sign}" styleClass="reqStarInline" />
+			</div>
+			<h:messages styleClass="messageAlert" id="errorMessages"  /> 
 
-
-    <h:form id="revise">
-           		<script type="text/javascript" src="/library/js/jquery.js"></script>
-       		<sakai:script contextBase="/sakai-messageforums-tool" path="/js/sak-10625.js"/>
-      <sakai:tool_bar_message value="#{msgs.cdfm_discussion_forum_settings}" />
-		<div class="instruction">
-		  <h:outputText id="instruction"  value="#{msgs.cdfm_settings_instruction}"/>
-		  <h:outputText value="#{msgs.cdfm_info_required_sign}" styleClass="reqStarInline" />
-		</div>
-		<h:messages styleClass="alertMessage" id="errorMessages"  /> 
-     
-				<h:panelGrid columns="3" styleClass="jsfFormTable" columnClasses="shorttext,">
-					<h:outputText id="req_star"  value="#{msgs.cdfm_info_required_sign}" styleClass="reqStar"/>	
-					<h:outputLabel id="outputLabel" for="forum_title"  value="#{msgs.cdfm_forum_title}"/>	
+			<h:panelGrid columns="1" styleClass="jsfFormTable" columnClasses="shorttext">
+				<h:panelGroup>	
+					<%-- //designNote: does this text input need a maxlength attribute ? --%>
+					<h:outputLabel id="outputLabel" for="forum_title" styleClass="block" style="padding-bottom:.3em;display:block;clear:both;float:none">
+						<h:outputText id="req_star"  value="#{msgs.cdfm_info_required_sign}" styleClass="reqStar"/>
+						<h:outputText  value="#{msgs.cdfm_forum_title}" />
+					</h:outputLabel>	
 					<h:inputText size="50" id="forum_title"  value="#{ForumTool.selectedForum.forum.title}"/>
+				</h:panelGroup>	
+			</h:panelGrid>
+			<h:panelGrid columns="1"  columnClasses="longtext">
+				<h:panelGroup>
 					<h:outputText value="" />
-					<h:outputLabel id="outputLabel1" for="forum_shortDescription"  value="#{msgs.cdfm_shortDescription}"/>	
+					<%-- //designNote: this label should alert that textarea has a 255 max chars limit --%>
+					<h:outputLabel id="outputLabel1" for="forum_shortDescription"  value="#{msgs.cdfm_shortDescription}" styleClass="block"/>	
 					<h:inputTextarea rows="3" cols="45" id="forum_shortDescription"  value="#{ForumTool.selectedForum.forum.shortDescription}"/>
 					<h:outputText value="" />
-      	</h:panelGrid>
-      		
+				</h:panelGroup>	
+			</h:panelGrid>
+			
+			<%--RTEditor area - if enabled--%>
 			<h:panelGroup rendered="#{! ForumTool.disableLongDesc}">
-			<h4><h:outputText id="outputLabel2" value="#{msgs.cdfm_fullDescription}"/></h4>	
-			<sakai:rich_text_area rows="10" columns="70" value="#{ForumTool.selectedForum.forum.extendedDescription}"/>
-	      	</h:panelGroup>
-	      	
-	      <h4>
-		        <h:outputText value="#{msgs.cdfm_att}"/>
-	      </h4>
+				<h4><h:outputText id="outputLabel2" value="#{msgs.cdfm_fullDescription}"/></h4>	
+				<sakai:rich_text_area rows="10" columns="70" value="#{ForumTool.selectedForum.forum.extendedDescription}"/>
+			</h:panelGroup>
+			
+			
+			<%--Attachment area  --%>
+			<h4>
+				<h:outputText value="#{msgs.cdfm_att}"/>
+			</h4>
+				<%--designNote: would be nice to make this an include, as well as a more comprehensive MIME type check  --%> 
+			<h:dataTable styleClass="attachPanel" id="attmsg"  value="#{ForumTool.attachments}" var="eachAttach"  cellpadding="0" cellspacing="0" columnClasses="attach,bogus,specialLink,bogus,bogus" rendered="#{!empty ForumTool.attachments}">
+				<h:column>
+					<f:facet name="header">   <h:outputText value=" "/>                                          
+					</f:facet>
+					<h:graphicImage url="/images/excel.gif" rendered="#{eachAttach.attachment.attachmentType == 'application/vnd.ms-excel'}" alt="" />
+					<h:graphicImage url="/images/html.gif" rendered="#{eachAttach.attachment.attachmentType == 'text/html'}" alt="" />
+					<h:graphicImage url="/images/pdf.gif" rendered="#{eachAttach.attachment.attachmentType == 'application/pdf'}" alt="" />
+					<h:graphicImage url="/images/ppt.gif" rendered="#{eachAttach.attachment.attachmentType == 'application/vnd.ms-powerpoint'}" alt="" />
+					<h:graphicImage url="/images/text.gif" rendered="#{eachAttach.attachment.attachmentType == 'text/plain'}" alt="" />
+					<h:graphicImage url="/images/word.gif" rendered="#{eachAttach.attachment.attachmentType == 'application/vnd.ms-word'}" alt="" />
+				</h:column>
+				<h:column>
+					<f:facet name="header">
+						<h:outputText value="#{msgs.cdfm_title}"/>
+					</f:facet>
+					<h:outputText value="#{eachAttach.attachment.attachmentName}"/>
+				</h:column>
+				<h:column>
+					<f:facet name="header">
+						<h:outputText value=" "/>
+					</f:facet>
+					<h:commandLink action="#{ForumTool.processDeleteAttachSetting}" 
+							immediate="true"
+							onfocus="document.forms[0].onsubmit();"
+							title="#{msgs.cdfm_remove}">
+						<h:outputText value="#{msgs.cdfm_remove}"/>
+						<f:param value="#{eachAttach.attachment.attachmentId}" name="dfmsg_current_attach"/>
+					</h:commandLink>
+				</h:column>
+				<h:column rendered="#{!empty ForumTool.attachments}">
+					<f:facet name="header">
+						<h:outputText value="#{msgs.cdfm_attsize}" />
+					</f:facet>
+					<h:outputText value="#{eachAttach.attachment.attachmentSize}"/>
+				</h:column>
+				<h:column rendered="#{!empty ForumTool.attachments}">
+					<f:facet name="header">
+						<h:outputText value="#{msgs.cdfm_atttype}" />
+					</f:facet>
+					<%--//designNote: do we really need this info if the lookup has worked? I Suppose till the MIME type check is more comprehensive, yes --%>
+					<h:outputText value="#{eachAttach.attachment.attachmentType}"/>
+				</h:column>
+			</h:dataTable>   
+					                                               
 			<div class="instruction">	        
-		      <h:outputText value="#{msgs.cdfm_no_attachments}" rendered="#{empty ForumTool.attachments}"/>
-	      </div>
-
-	        <sakai:button_bar>
-	        	  <sakai:button_bar_item action="#{ForumTool.processAddAttachmentRedirect}" 
-	        	                         value="#{msgs.cdfm_button_bar_add_attachment_redirect}" 
-	        	                         immediate="true" accesskey="a" />
-	        </sakai:button_bar>
-	        <%-- gsilver:moving the rendered attribute form the h:column to the dataTable - we do not want empty tables--%>
-				<h:dataTable styleClass="listHier lines nolines" id="attmsg" width="100%" value="#{ForumTool.attachments}" var="eachAttach"  cellpadding="0" cellspacing="0" columnClasses="attach,bogus,itemAction specialLink,bogus,bogus" rendered="#{!empty ForumTool.attachments}">
-				  <h:column rendered="#{!empty ForumTool.attachments}">
-						<f:facet name="header">
-						</f:facet>
-						
-							<h:graphicImage url="/images/excel.gif" rendered="#{eachAttach.attachment.attachmentType == 'application/vnd.ms-excel'}" alt="" />
-							<h:graphicImage url="/images/html.gif" rendered="#{eachAttach.attachment.attachmentType == 'text/html'}" alt="" />
-							<h:graphicImage url="/images/pdf.gif" rendered="#{eachAttach.attachment.attachmentType == 'application/pdf'}" alt="" />
-							<h:graphicImage url="/images/ppt.gif" rendered="#{eachAttach.attachment.attachmentType == 'application/vnd.ms-powerpoint'}" alt="" />
-							<h:graphicImage url="/images/text.gif" rendered="#{eachAttach.attachment.attachmentType == 'text/plain'}" alt="" />
-							<h:graphicImage url="/images/word.gif" rendered="#{eachAttach.attachment.attachmentType == 'application/msword'}" alt="" />
-						</h:column>
-						<h:column>
-						<f:facet name="header">
-							<h:outputText value="#{msgs.cdfm_title}"/>
-						</f:facet>
-						
-							<h:outputText value="#{eachAttach.attachment.attachmentName}"/>
-					</h:column>
-					<h:column>
-						<h:commandLink action="#{ForumTool.processDeleteAttachSetting}" 
-								immediate="true"
-								onfocus="document.forms[0].onsubmit();"
-								title="#{msgs.cdfm_remove}">
-							<h:outputText value="#{msgs.cdfm_remove}"/>
-								<f:param value="#{eachAttach.attachment.attachmentId}" name="dfmsg_current_attach"/>
-							</h:commandLink>
-				  </h:column>
-					<h:column rendered="#{!empty ForumTool.attachments}">
-						<f:facet name="header">
-							<h:outputText value="#{msgs.cdfm_attsize}" />
-						</f:facet>
-						<h:outputText value="#{eachAttach.attachment.attachmentSize}"/>
-					</h:column>
-					<h:column rendered="#{!empty ForumTool.attachments}">
-						<f:facet name="header">
-		  			  <h:outputText value="#{msgs.cdfm_atttype}" />
-						</f:facet>
-						<h:outputText value="#{eachAttach.attachment.attachmentType}"/>
-					</h:column>
-					</h:dataTable>   
-
-			<div class="discTria" style="padding: 0.5em; margin-top:0.8em;"><h4><h:outputText  value="#{msgs.cdfm_forum_posting}"/></h4></div>
-   	  <h:panelGrid columns="2" >
-   			<h:panelGroup>
-				  <h:outputLabel for="forum_locked"  value="#{msgs.cdfm_lock_forum}" styleClass="shorttext"/>	
+				<h:outputText value="#{msgs.cdfm_no_attachments}" rendered="#{empty ForumTool.attachments}"/>
+			</div>
+			<p class="act" style="padding:0 0 1em 0;">
+				<h:commandButton  action="#{ForumTool.processAddAttachmentRedirect}"
+					value="#{msgs.cdfm_button_bar_add_attachment_more_redirect}" 
+					immediate="true" 
+					style="font-size:96%"
+					rendered="#{!empty ForumTool.attachments}"/>
+				<h:commandButton  action="#{ForumTool.processAddAttachmentRedirect}"
+					value="#{msgs.cdfm_button_bar_add_attachment_redirect}" 
+					immediate="true" 
+					style="font-size:96%"
+					rendered="#{empty ForumTool.attachments}"
+					/>
+			</p>	
+					
+			<%--general posting  forum settings --%>
+			<h4 style="margin:0"><h:outputText  value="#{msgs.cdfm_forum_posting}"/></h4>
+			<h:panelGrid columns="2" styleClass="jsfFormTable" style="margin-top:0">
+				<h:panelGroup>
+					<h:outputText  value="#{msgs.cdfm_lock_forum}" />	
 				</h:panelGroup>
 				<h:panelGroup>
-					<h:selectOneRadio layout="pageDirection"  id="forum_locked"  value="#{ForumTool.selectedForum.locked}" styleClass="checkbox inlineForm">
-    					<f:selectItem itemValue="true" itemLabel="#{msgs.cdfm_yes}"/>
-    					<f:selectItem itemValue="false" itemLabel="#{msgs.cdfm_no}"/>
-  					</h:selectOneRadio>
+					<h:selectOneRadio layout="lineDirection"  id="forum_locked"  value="#{ForumTool.selectedForum.locked}"  styleClass="selectOneRadio">
+						<f:selectItem itemValue="true" itemLabel="#{msgs.cdfm_yes}"/>
+						<f:selectItem itemValue="false" itemLabel="#{msgs.cdfm_no}"/>
+					</h:selectOneRadio>
 				</h:panelGroup>
-   			<h:panelGroup styleClass="shorttext">
-				  <h:outputLabel for="moderated"  value="#{msgs.cdfm_moderate_forum}" styleClass="shorttext"/>	
+				<h:panelGroup styleClass="shorttext">
+					<h:outputText   value="#{msgs.cdfm_moderate_forum}" />	
 				</h:panelGroup>
 				<h:panelGroup>
-					<h:selectOneRadio layout="pageDirection"  id="moderated"  value="#{ForumTool.selectedForum.moderated}" styleClass="checkbox inlineForm"
-							onclick="javascript:disableOrEnableModeratePerm();">
-    					<f:selectItem itemValue="true" itemLabel="#{msgs.cdfm_yes}"/>
-    					<f:selectItem itemValue="false" itemLabel="#{msgs.cdfm_no}"/>
-  					</h:selectOneRadio>
+					<h:selectOneRadio layout="lineDirection"  id="moderated"  value="#{ForumTool.selectedForum.moderated}" 
+						onclick="javascript:disableOrEnableModeratePerm();"  styleClass="selectOneRadio">
+						<f:selectItem itemValue="true" itemLabel="#{msgs.cdfm_yes}"/>
+						<f:selectItem itemValue="false" itemLabel="#{msgs.cdfm_no}"/>
+					</h:selectOneRadio>
 				</h:panelGroup>
-
 			</h:panelGrid>
 
-	   <%@include file="/jsp/discussionForum/permissions/permissions_include.jsp"%>
-	      
-      <div class="act">
-          <h:commandButton action="#{ForumTool.processActionSaveForumSettings}" value="#{msgs.cdfm_button_bar_save_setting}"
-          								 rendered="#{ForumTool.selectedForum.forum.id != null && !ForumTool.selectedForum.markForDeletion}" accesskey="s"> 
-    	 	  	<f:param value="#{ForumTool.selectedForum.forum.id}" name="forumId"/>         
-          </h:commandButton>
-          <h:commandButton action="#{ForumTool.processActionSaveForumAsDraft}" value="#{msgs.cdfm_button_bar_save_draft}" accesskey="v"
-          								 rendered = "#{!ForumTool.selectedForum.markForDeletion}">
-	        	<f:param value="#{ForumTool.selectedForum.forum.id}" name="forumId"/>
-          </h:commandButton>  
-          <h:commandButton action="#{ForumTool.processActionSaveForumAndAddTopic}" value="#{msgs.cdfm_button_bar_save_setting_add_topic}" accesskey="t"
-          								 rendered = "#{!ForumTool.selectedForum.markForDeletion}">
-	        	<f:param value="#{ForumTool.selectedForum.forum.id}" name="forumId"/>
-          </h:commandButton>
-          <h:commandButton id="delete_confirm" action="#{ForumTool.processActionDeleteForumConfirm}" 
-                           value="#{msgs.cdfm_button_bar_delete}" rendered="#{!ForumTool.selectedForum.markForDeletion && ForumTool.displayForumDeleteOption}"
-                           accesskey="d">
-	        	<f:param value="#{ForumTool.selectedForum.forum.id}" name="forumId"/>
-          </h:commandButton>
-          
-          <h:commandButton id="delete" action="#{ForumTool.processActionDeleteForum}" 
-                           value="#{msgs.cdfm_button_bar_delete}" rendered="#{ForumTool.selectedForum.markForDeletion}"
-                           accesskey="d">
-	        	<f:param value="#{ForumTool.selectedForum.forum.id}" name="forumId"/>
-          </h:commandButton>
-          <h:commandButton  action="#{ForumTool.processActionHome}" value="#{msgs.cdfm_button_bar_cancel}" accesskey="x" />
-       </div>
-       
-	 </h:form>
-    </sakai:view>
+		   <%@include file="/jsp/discussionForum/permissions/permissions_include.jsp"%>
+			  
+			<div class="act">
+				<h:commandButton action="#{ForumTool.processActionSaveForumSettings}" value="#{msgs.cdfm_button_bar_save_setting}"
+						rendered="#{ForumTool.selectedForum.forum.id != null && !ForumTool.selectedForum.markForDeletion}" accesskey="s"> 
+					<f:param value="#{ForumTool.selectedForum.forum.id}" name="forumId"/>         
+				</h:commandButton>
+				<h:commandButton action="#{ForumTool.processActionSaveForumAndAddTopic}" value="#{msgs.cdfm_button_bar_save_setting_add_topic}" accesskey="t"
+						rendered = "#{!ForumTool.selectedForum.markForDeletion}">
+					<f:param value="#{ForumTool.selectedForum.forum.id}" name="forumId"/>
+				</h:commandButton>
+				<h:commandButton action="#{ForumTool.processActionSaveForumAsDraft}" value="#{msgs.cdfm_button_bar_save_draft}" accesskey="v"
+						rendered = "#{!ForumTool.selectedForum.markForDeletion}">
+					<f:param value="#{ForumTool.selectedForum.forum.id}" name="forumId"/>
+				</h:commandButton>  
+				<%-- // designNote: these next 2 actions  should be available in the list view instead of here --%>
+				<h:commandButton id="delete_confirm" action="#{ForumTool.processActionDeleteForumConfirm}" 
+						value="#{msgs.cdfm_button_bar_delete}" rendered="#{!ForumTool.selectedForum.markForDeletion && ForumTool.displayForumDeleteOption}"
+						accesskey="d">
+					<f:param value="#{ForumTool.selectedForum.forum.id}" name="forumId"/>
+				</h:commandButton>
+ 
+				<h:commandButton id="delete" action="#{ForumTool.processActionDeleteForum}" 
+						value="#{msgs.cdfm_button_bar_delete}" rendered="#{ForumTool.selectedForum.markForDeletion}"
+						accesskey="d">
+					<f:param value="#{ForumTool.selectedForum.forum.id}" name="forumId"/>
+				</h:commandButton>
+				<h:commandButton  action="#{ForumTool.processActionHome}" value="#{msgs.cdfm_button_bar_cancel}" accesskey="x" />
+			</div>
+		</h:form>
+	</sakai:view>
 </f:view>
Index: msgcntr/messageforums-app/src/webapp/jsp/pvtMsgReply.jsp
===================================================================
--- msgcntr/messageforums-app/src/webapp/jsp/pvtMsgReply.jsp	(revision 46869)
+++ msgcntr/messageforums-app/src/webapp/jsp/pvtMsgReply.jsp	(working copy)
@@ -10,17 +10,24 @@
     <h:form id="pvtMsgReply">
 		<script type="text/javascript" src="/library/js/jquery.js"></script>
                 <sakai:script contextBase="/sakai-messageforums-tool" path="/js/sak-10625.js"/>
-  			<div class="breadCrumb">
-			  <h3>
-				<h:panelGroup rendered="#{PrivateMessagesTool.messagesandForums}" >
-				  <h:commandLink action="#{PrivateMessagesTool.processActionHome}" value="#{msgs.cdfm_message_forums} / " title="#{msgs.cdfm_message_forums}"/>
-			    </h:panelGroup>
-  			    <h:commandLink action="#{PrivateMessagesTool.processActionPrivateMessages}" value="#{msgs.cdfm_message_pvtarea}" title=" #{msgs.cdfm_message_pvtarea}"/> /
+
+		<h:panelGroup>
+          	<f:verbatim><div class="breadCrumb"><h3></f:verbatim>
+				  <h:panelGroup rendered="#{PrivateMessagesTool.messagesandForums}" >
+				  	<h:commandLink action="#{PrivateMessagesTool.processActionHome}" value="#{msgs.cdfm_message_forums}" title="#{msgs.cdfm_message_forums}"/>
+				  	<f:verbatim><h:outputText value=" / " /></f:verbatim>
+				  </h:panelGroup>
+	  		      <h:commandLink action="#{PrivateMessagesTool.processActionPrivateMessages}" value="#{msgs.pvt_message_nav}" title=" #{msgs.cdfm_message_forums}"/>
+	              <f:verbatim><h:outputText value=" " /><h:outputText value=" / " /><h:outputText value=" " /></f:verbatim>
+				<h:commandLink action="#{PrivateMessagesTool.processDisplayForum}" value="#{PrivateMessagesTool.msgNavMode}" title=" #{PrivateMessagesTool.msgNavMode}"/><h:outputText value=" " /><h:outputText value=" / " /><h:outputText value=" " />
+				<h:commandLink action="#{PrivateMessagesTool.processDisplayMessages}" value="#{PrivateMessagesTool.detailMsg.msg.title}" title=" #{PrivateMessagesTool.detailMsg.msg.title}"/><h:outputText value=" " /><h:outputText value=" / " /><h:outputText value=" " />
 				<h:outputText value="#{msgs.pvt_reply}" />
-				</h3>
-			</div>
-	<%-- gsilver:commenting this header out as redundant--%>		
-      <%-- gsilver:<sakai:tool_bar_message value="#{msgs.pvt_reply}" />--%> 
+			<f:verbatim></h3></div></f:verbatim>
+	</h:panelGroup>	
+		
+		
+	<%--//designNote: gsilver:commenting this header out as redundant--%>		
+      <%-- <sakai:tool_bar_message value="#{msgs.pvt_reply}" />--%> 
 
 			<div class="instruction">
  			  <h:outputText value="#{msgs.cdfm_required}"/> <h:outputText value="#{msgs.pvt_star}" styleClass="reqStarInline"/>
@@ -49,15 +56,16 @@
          	</h:selectManyListbox>   
 				</h:panelGroup>
 				
-				<h:panelGroup styleClass="shorttext">
-  					<h:outputLabel for="sent_as" ><h:outputText value="#{msgs.pvt_send}" /></h:outputLabel>
-  				</h:panelGroup>
-  				<h:panelGroup>
-					<h:selectOneRadio id="sent_as" value="#{PrivateMessagesTool.composeSendAsPvtMsg}" layout="pageDirection"  style="margin:0" styleClass="checkbox">
-		    			  <f:selectItem itemValue="yes" itemLabel="#{msgs.pvt_send_as_private}"/>
-		    			  <f:selectItem itemValue="no" itemLabel="#{msgs.pvt_send_as_email}"/>
-    			    </h:selectOneRadio>
-				</h:panelGroup>
+			 <h:panelGroup styleClass="shorttext" rendered= "#{PrivateMessagesTool.dispSendEmailOut}">
+					<h:outputLabel><h:outputText value="#{msgs.pvt_send_cc}"/></h:outputLabel>
+			  </h:panelGroup>
+			   
+			  
+			  <h:panelGroup styleClass="checkbox" style="white-space: nowrap;" rendered= "#{PrivateMessagesTool.dispSendEmailOut}">
+			  <h:selectBooleanCheckbox value="#{PrivateMessagesTool.booleanEmailOut}" id="send_email_out" >
+			  </h:selectBooleanCheckbox>
+		   <h:outputLabel for="send_email_out"><h:outputText value="#{msgs.pvt_send_as_email}"/></h:outputLabel>
+			</h:panelGroup>			 
 				
 				<h:panelGroup  styleClass="shorttext">
 					<h:outputLabel for="viewlist" ><h:outputText value="#{msgs.pvt_label}"/></h:outputLabel>
@@ -159,61 +167,7 @@
 						</h:column>
 						</h:dataTable>   
 					 
- <%--********************* Reply *********************--%>	     	
-   
-		<br />
-
-		<h4 class="textPanelHeader">
-	  	<h:outputText value="#{msgs.pvt_replyto}"/>  
-	  </h4> 
-	  
-	  <h:panelGrid columns="2" styleClass="itemSummary">	    
-	    <h:outputText value="#{msgs.pvt_subject}" />
-	    <h:outputText value="#{PrivateMessagesTool.detailMsg.msg.title}" />
-	    
-	    <h:outputText value="#{msgs.pvt_to}" />
-	    <h:outputText value="#{PrivateMessagesTool.detailMsg.msg.recipientsAsText}" />
-	    
-	    <h:outputText value="#{msgs.pvt_authby}" style="white-space: nowrap;"/>
-	    <h:panelGroup>
-	      <h:outputText value="#{PrivateMessagesTool.detailMsg.msg.author}" />
-	      <h:outputText value=" #{msgs.pvt_openb}" />
-	      <h:outputText value="#{PrivateMessagesTool.detailMsg.msg.created}" >
-          <f:convertDateTime pattern="#{msgs.date_format}" />  
-        </h:outputText>
-        <h:outputText value=" #{msgs.pvt_closeb}" />
-	    </h:panelGroup>
-	    
-	    <h:outputText value="#{msgs.pvt_label}" />
-	    <h:outputText value="#{PrivateMessagesTool.detailMsg.msg.label}" />
-	    
-	    <h:outputText value="#{msgs.pvt_att}" rendered="#{!empty PrivateMessagesTool.detailMsg.attachList}"/>
-	    <h:panelGroup rendered="#{!empty PrivateMessagesTool.detailMsg.attachList}">
-	      <h:dataTable value="#{PrivateMessagesTool.detailMsg.attachList}" var="eachAttach"  styleClass="attachListJSF"  rendered="#{!empty PrivateMessagesTool.detailMsg.attachList}">
-		  		<h:column rendered="#{!empty PrivateMessagesTool.detailMsg.attachList}">
-					  <h:graphicImage url="/images/excel.gif" rendered="#{eachAttach.attachment.attachmentType == 'application/vnd.ms-excel'}" alt="" />
-					  <h:graphicImage url="/images/html.gif" rendered="#{eachAttach.attachment.attachmentType == 'text/html'}" alt="" />
-					  <h:graphicImage url="/images/pdf.gif" rendered="#{eachAttach.attachment.attachmentType == 'application/pdf'}" alt="" />
-					  <h:graphicImage url="/sakai-messageforums-tool/images/ppt.gif" rendered="#{eachAttach.attachment.attachmentType == 'application/vnd.ms-powerpoint'}" alt="" />
-					  <h:graphicImage url="/images/text.gif" rendered="#{eachAttach.attachment.attachmentType == 'text/plain'}" alt="" />
-					  <h:graphicImage url="/images/word.gif" rendered="#{eachAttach.attachment.attachmentType == 'application/msword'}" alt="" />
-					  
-<%--					  <h:outputLink value="#{eachAttach.attachmentUrl}" target="_blank">
-					  	<h:outputText value="#{eachAttach.attachmentName}"/>
-						</h:outputLink>--%>
-					  <h:outputLink value="#{eachAttach.url}" target="_blank">
-					  	<h:outputText value="#{eachAttach.attachment.attachmentName}"/>
-						</h:outputLink>
-						
-					</h:column>
-				</h:dataTable>   
-	    </h:panelGroup> 
-	    
-	    <h:outputText value="#{msgs.pvt_message}" />
-	    <mf:htmlShowArea value="#{PrivateMessagesTool.detailMsg.msg.body}" hideBorder="true" />
-	       
-	  </h:panelGrid>
-		
+ 
       <sakai:button_bar>
         <sakai:button_bar_item action="#{PrivateMessagesTool.processPvtMsgReplySend}" value="#{msgs.pvt_send}" accesskey="s" styleClass="active" />
         <%--<sakai:button_bar_item action="#{PrivateMessagesTool.processPvtMsgReplySaveDraft}" value="Save Draft" />--%>
Index: msgcntr/messageforums-app/src/webapp/jsp/discussionForum/message/dfPendingMessages.jsp
===================================================================
--- msgcntr/messageforums-app/src/webapp/jsp/discussionForum/message/dfPendingMessages.jsp	(revision 46869)
+++ msgcntr/messageforums-app/src/webapp/jsp/discussionForum/message/dfPendingMessages.jsp	(working copy)
@@ -3,91 +3,100 @@
 <%@ taglib uri="http://sakaiproject.org/jsf/sakai" prefix="sakai" %>
 <%@ taglib uri="http://sakaiproject.org/jsf/messageforums" prefix="mf" %>
 <jsp:useBean id="msgs" class="org.sakaiproject.util.ResourceLoader" scope="session">
-   <jsp:setProperty name="msgs" property="baseName" value="org.sakaiproject.api.app.messagecenter.bundle.Messages"/>
+	<jsp:setProperty name="msgs" property="baseName" value="org.sakaiproject.api.app.messagecenter.bundle.Messages"/>
 </jsp:useBean>
 
 <f:view>
-<sakai:view>
-	<h:form id="msgForum">
-	       		<script type="text/javascript" src="/library/js/jquery.js"></script>
-       		<sakai:script contextBase="/sakai-messageforums-tool" path="/js/sak-10625.js"/>
-		<sakai:script contextBase="/sakai-messageforums-tool" path="/js/forum.js"/>
+	<sakai:view>
+		<h:form id="msgForum" styleClass="specialLink">
+			<style type="text/css">
+				@import url("/sakai-messageforums-tool/css/msgcntr.css");
+			</style>
+			
+			<script type="text/javascript" src="/library/js/jquery.js"></script>
+			<sakai:script contextBase="/sakai-messageforums-tool" path="/js/sak-10625.js"/>
+			<sakai:script contextBase="/sakai-messageforums-tool" path="/js/forum.js"/>
 
-		<div class="breadCrumb specialLink">
 			<h3>
 				<h:commandLink action="#{ForumTool.processActionHome}" value="#{msgs.cdfm_message_forums}" title=" #{msgs.cdfm_message_forums}"
-			      		rendered="#{ForumTool.messagesandForums}" />
-			  <h:commandLink action="#{ForumTool.processActionHome}" value="#{msgs.cdfm_discussion_forums}" title=" #{msgs.cdfm_discussion_forums}"
-			      		rendered="#{ForumTool.forumsTool}" />
-      	<h:outputText value=" " /><h:outputText value=" / " /><h:outputText value=" " />
+					rendered="#{ForumTool.messagesandForums}" />
+				<h:commandLink action="#{ForumTool.processActionHome}" value="#{msgs.cdfm_discussion_forums}" title=" #{msgs.cdfm_discussion_forums}"
+					rendered="#{ForumTool.forumsTool}" />
+				<h:outputText value=" " /><h:outputText value=" / " /><h:outputText value=" " />
 				<h:outputText value="#{msgs.cdfm_msg_pending_queue_title}" />
 			</h3>
-		</div>
+			
+			<div class="instruction">
+				<p>	
+					<h:outputText value="#{msgs.cdfm_deny_with_comments_msg}" rendered="#{ForumTool.numPendingMessages > 0}" />
+					<h:outputText value="#{msgs.cdfm_no_pending_msgs}" rendered="#{ForumTool.numPendingMessages < 1}" />
+				</p>	
+			</div>
 
-		<div class="instruction">
-			<h:outputText value="#{msgs.cdfm_deny_with_comments_msg}" rendered="#{ForumTool.numPendingMessages > 0}" />
-	  	<h:outputText value="#{msgs.cdfm_no_pending_msgs}" rendered="#{ForumTool.numPendingMessages < 1}" />
-	  </div>
-	  
-	  <h:messages globalOnly="true" infoClass="success" errorClass="alertMessage" />
-	  
-		<h:dataTable id="pendingMsgs" value="#{ForumTool.pendingMessages}" width="100%" var="message" 
-									columnClasses="attach,bogus" styleClass="listHier" rendered="#{ForumTool.numPendingMessages >0 }">
-			<h:column>
-				<f:facet name="header">
-					<h:selectBooleanCheckbox title="#{msgs.cdfm_checkall}" id="mainCheckbox" onclick="javascript:selectDeselectCheckboxes(this.id, document.forms[0]);"/>
-				</f:facet>
+			<h:messages globalOnly="true" infoClass="success" errorClass="alertMessage" />
+
+			<h:dataTable id="pendingMsgs" value="#{ForumTool.pendingMessages}" width="100%" var="message" 
+				columnClasses="bogus,nopadd" styleClass="listHier specialLink" rendered="#{ForumTool.numPendingMessages >0 }" cellpadding="0" cellspacing="0">
+				<h:column>
+					<f:facet name="header">
+						<h:selectBooleanCheckbox title="#{msgs.cdfm_checkall}" id="mainCheckbox" onclick="javascript:selectDeselectCheckboxes(this.id, document.forms[0]);"/>
+					</f:facet>
 					<h:selectBooleanCheckbox value="#{message.selected}" id="childCheckbox" onclick="javascript:resetMainCheckbox('msgForum:pendingMsgs:mainCheckbox');"/>
-			</h:column>
-			
-			<h:column>
-				<f:facet name="header">
-					<h:panelGroup style="text-align: right; float:right;">
-						<h:commandLink id="denyMsgs" title="#{msgs.cdfm_button_bar_deny}" action="#{ForumTool.markCheckedAsDenied}">
-		  				<h:graphicImage value="/../../library/image/silk/cross.png" alt="#{msgs.cdfm_button_bar_deny}" />
-		  				<h:outputText value=" #{msgs.cdfm_button_bar_deny} " />
-		  			</h:commandLink>
-						<h:commandLink id="approveMsgs" title="#{msgs.cdfm_button_bar_approve}" action="#{ForumTool.markCheckedAsApproved}" style="padding-left: 1.0em; padding-right: 1.0em;">
-		  				<h:graphicImage value="/../../library/image/silk/tick.png" alt="#{msgs.cdfm_button_bar_approve}" />
-		  				<h:outputText value=" #{msgs.cdfm_button_bar_approve}" />
-		  		</h:commandLink>
-					</h:panelGroup>
-				</f:facet>
-				
-				<f:verbatim><div class="hierItemBlock"><h4 class="specialLink textPanelHeader"><div class="unreadMsg"></f:verbatim>
-				<h:commandLink action="#{ForumTool.processActionDisplayForum}"  value="#{message.message.topic.openForum.title}" title=" #{message.message.topic.openForum.title}">
-		        <f:param value="#{message.message.topic.openForum.id}" name="forumId"/>
-	      </h:commandLink>
+				</h:column>
+				<h:column>
+					<f:facet name="header">
+						<h:panelGroup   styleClass="messageActions">
+							<h:commandLink id="denyMsgs" title="#{msgs.cdfm_button_bar_deny}" action="#{ForumTool.markCheckedAsDenied}">
+								<h:graphicImage value="/../../library/image/silk/cross.png" alt="#{msgs.cdfm_button_bar_deny}" />
+								<h:outputText value=" #{msgs.cdfm_button_bar_deny} " />
+							</h:commandLink>
+							<h:commandLink id="approveMsgs" title="#{msgs.cdfm_button_bar_approve}" action="#{ForumTool.markCheckedAsApproved}" style="padding-left: 1.0em; padding-right: 1.0em;">
+								<h:graphicImage value="/../../library/image/silk/tick.png" alt="#{msgs.cdfm_button_bar_approve}" />
+								<h:outputText value=" #{msgs.cdfm_button_bar_approve}" />
+							</h:commandLink>
+						</h:panelGroup>
+					</f:facet>
+<%--					<f:verbatim><div class="title"></f:verbatim>
+
+						<h:commandLink action="#{ForumTool.processActionDisplayForum}"  value="#{message.message.topic.openForum.title}" title=" #{message.message.topic.openForum.title}" styleClass="title">
+							<f:param value="#{message.message.topic.openForum.id}" name="forumId"/>
+						</h:commandLink>
+						<h:outputText value=" / " styleClass="title"/>
+						<h:commandLink action="#{ForumTool.processActionDisplayTopic}" id="topic_title" value="#{message.message.topic.title}" title=" #{message.message.topic.title}" styleClass="title">
+							<f:param value="#{message.message.topic.id}" name="topicId"/>
+							<f:param value="#{message.message.topic.openForum.id}" name="forumId"/>
+						</h:commandLink>
+--%>						
+						<f:verbatim></div><div class="pendingApproval" style="padding-left:.5em;width:98%;"></f:verbatim> 
+					<h:commandLink action="#{ForumTool.processActionDisplayMessage}" title="#{message.message.title}" styleClass="title">
+						<h:outputText value="#{message.message.title}" />
+						<f:param value="#{message.message.id}" name="messageId"/>
+						<f:param value="#{message.message.topic.id}" name="topicId"/>
+						<f:param value="#{ForumTool.selectedForum.forum.id}" name="forumId"/>
+					</h:commandLink>
+					<h:outputText value=" #{msgs.cdfm_dash} " styleClass="textPanelFooter"/>
+					<h:outputText value="#{message.message.author}" styleClass="textPanelFooter"/>
+					<h:outputText value=" #{msgs.cdfm_openb}" styleClass="textPanelFooter"/>
+					<h:outputText value="#{message.message.created}" styleClass="textPanelFooter">
+						<f:convertDateTime pattern="#{msgs.date_format}" />
+					</h:outputText>
+					<h:outputText value="#{msgs.cdfm_closeb}"/>
+					<%--designNote: need to i18N --%>
+					<h:outputText value=" - in  "/>
+					<h:commandLink action="#{ForumTool.processActionDisplayForum}"  value="#{message.message.topic.openForum.title}" title=" #{message.message.topic.openForum.title}">
+						<f:param value="#{message.message.topic.openForum.id}" name="forumId"/>
+					</h:commandLink>
 					<h:outputText value=" / " />
-			  <h:commandLink action="#{ForumTool.processActionDisplayTopic}" id="topic_title" value="#{message.message.topic.title}" title=" #{message.message.topic.title}">
-					      <f:param value="#{message.message.topic.id}" name="topicId"/>
-					      <f:param value="#{message.message.topic.openForum.id}" name="forumId"/>
-				      </h:commandLink>
-				<f:verbatim></div><div style="padding-top: 1.0em"></f:verbatim>
-				
-				<h:commandLink action="#{ForumTool.processActionDisplayMessage}" title="#{message.message.title}">
-					<h:outputText value="#{message.message.title}" />
-					<f:param value="#{message.message.id}" name="messageId"/>
-		      <f:param value="#{message.message.topic.id}" name="topicId"/>
-		      <f:param value="#{ForumTool.selectedForum.forum.id}" name="forumId"/>
-				</h:commandLink>
-				<h:outputText value=" #{msgs.cdfm_dash} " />
-				<h:outputText value="#{message.message.author}" />
-				<h:outputText value=" #{msgs.cdfm_openb}" />
-				<h:outputText value="#{message.message.created}">
-			  	<f:convertDateTime pattern="#{msgs.date_format}" />
-			  </h:outputText>
-				<h:outputText value="#{msgs.cdfm_closeb}" />
-				<f:verbatim></div></h4><div></f:verbatim>
-					<h:outputText value="#{message.message.body}" escape="false" />
-				<f:verbatim></div></div></f:verbatim>
-				
-			</h:column>
-			
-		</h:dataTable>
-			  
-			  
-		
-	</h:form>
-</sakai:view>
+					<h:commandLink action="#{ForumTool.processActionDisplayTopic}" id="topic_title" value="#{message.message.topic.title}" title=" #{message.message.topic.title}">
+						<f:param value="#{message.message.topic.id}" name="topicId"/>
+						<f:param value="#{message.message.topic.openForum.id}" name="forumId"/>
+					</h:commandLink>
+					<%--designNote:  sort of useless to check for message.message.body as it always seems to exist *if only with a line break*--%>
+					<h:outputText value="#{message.message.body}" escape="false"  rendered= "#{message.message.body}" styleClass="textPanel" style="display:block"/>
+					<%--designNote: how about attachments? --%>
+					<f:verbatim></div></f:verbatim>
+				</h:column>
+			</h:dataTable>
+		</h:form>
+	</sakai:view>
 </f:view>
Index: msgcntr/messageforums-app/src/webapp/jsp/discussionForum/message/dfViewMessage.jsp
===================================================================
--- msgcntr/messageforums-app/src/webapp/jsp/discussionForum/message/dfViewMessage.jsp	(revision 46869)
+++ msgcntr/messageforums-app/src/webapp/jsp/discussionForum/message/dfViewMessage.jsp	(working copy)
@@ -7,227 +7,215 @@
 </jsp:useBean>
 
 <f:view>
-<sakai:view>
-	<h:form id="msgForum">
-	       		<script type="text/javascript" src="/library/js/jquery.js"></script>
-       		<sakai:script contextBase="/sakai-messageforums-tool" path="/js/sak-10625.js"/>
-<!--jsp/discussionForum/message/dfViewMessage.jsp-->
-		
-		  <h:panelGrid columns="2" summary="layout" width="100%" styleClass="navPanel">
-		    <h:panelGroup styleClass="breadCrumb">
-				<f:verbatim><h3></f:verbatim>
-			      <h:commandLink action="#{ForumTool.processActionHome}" value="#{msgs.cdfm_message_forums}" title=" #{msgs.cdfm_message_forums}"
-			      		rendered="#{ForumTool.messagesandForums}" />
-			      <h:commandLink action="#{ForumTool.processActionHome}" value="#{msgs.cdfm_discussion_forums}" title=" #{msgs.cdfm_discussion_forums}"
-			      		rendered="#{ForumTool.forumsTool}" />
-				<f:verbatim><h:outputText value=" " /><h:outputText value=" / " /><h:outputText value=" " /></f:verbatim>
-				<h:commandLink action="#{ForumTool.processActionDisplayForum}" value="#{ForumTool.selectedForum.forum.title}" 
-                         title=" #{ForumTool.selectedForum.forum.title}" rendered="#{ForumTool.showForumLinksInNav}" >
-			      <f:param value="#{ForumTool.selectedForum.forum.id}" name="forumId"/>
-				</h:commandLink>
-				<h:outputText value="#{ForumTool.selectedForum.forum.title}" rendered="#{!ForumTool.showForumLinksInNav}"/>
-				<f:verbatim><h:outputText value=" " /><h:outputText value=" / " /><h:outputText value=" " /></f:verbatim>
-				<h:commandLink action="#{ForumTool.processActionDisplayTopic}" value="#{ForumTool.selectedTopic.topic.title}" 
-                         title=" #{ForumTool.selectedForum.forum.title}">
-				    <f:param value="#{ForumTool.selectedForum.forum.id}" name="forumId"/>
-				    <f:param value="#{ForumTool.selectedTopic.topic.id}" name="topicId"/>
-				</h:commandLink>
-			  	<f:verbatim><h:outputText value=" " /><h:outputText value=" / " /><h:outputText value=" " /></f:verbatim>
-			  	<h:commandLink action="#{ForumTool.processActionDisplayThread}" value="#{ForumTool.selectedThreadHead.message.title}" 
-                         title=" #{ForumTool.selectedThreadHead.message.title}">
-				    <f:param value="#{ForumTool.selectedForum.forum.id}" name="forumId"/>
-				    <f:param value="#{ForumTool.selectedTopic.topic.id}" name="topicId"/>
-				    <f:param value="#{ForumTool.selectedThreadHead.message.id}" name="messageId"/>
-				</h:commandLink>
-				<f:verbatim></h3></f:verbatim>
-			 </h:panelGroup>
-			 <h:panelGroup styleClass="itemNav">
-				   <h:outputText   value="#{msgs.cdfm_previous_thread}"  rendered="#{!ForumTool.selectedThreadHead.hasPreThread}" />
-					 <h:commandLink action="#{ForumTool.processActionDisplayThread}" value="#{msgs.cdfm_previous_thread}"  rendered="#{ForumTool.selectedThreadHead.hasPreThread}">
-						 <f:param value="#{ForumTool.selectedThreadHead.preThreadId}" name="messageId"/>
-						 <f:param value="#{ForumTool.selectedTopic.topic.id}" name="topicId"/>
-						 <f:param value="#{ForumTool.selectedForum.forum.id}" name="forumId"/>
-					 </h:commandLink>
-					 <f:verbatim><h:outputText  id="blankSpace1" value=" |  " /></f:verbatim>				
-					 <h:outputText   value="#{msgs.cdfm_next_thread}" rendered="#{!ForumTool.selectedThreadHead.hasNextThread}" />
-					 <h:commandLink action="#{ForumTool.processActionDisplayThread}" value="#{msgs.cdfm_next_thread}" rendered="#{ForumTool.selectedThreadHead.hasNextThread}">
+	<sakai:view>
+		<h:form id="msgForum" styleClass="specialLink">
+			<style type="text/css">
+				@import url("/sakai-messageforums-tool/css/msgcntr.css");
+			</style>
+			<script type="text/javascript" src="/library/js/jquery.js"></script>
+			<sakai:script contextBase="/sakai-messageforums-tool" path="/js/sak-10625.js"/>
+			<!--jsp/discussionForum/message/dfViewMessage.jsp-->
+			<%--breadcrumb and thread nav grid--%>
+			<h:panelGrid columns="2" summary="layout" width="100%" styleClass="navPanel">
+				<h:panelGroup>
+					<f:verbatim><h3></f:verbatim>
+						<h:commandLink action="#{ForumTool.processActionHome}" value="#{msgs.cdfm_message_forums}" title=" #{msgs.cdfm_message_forums}"
+							rendered="#{ForumTool.messagesandForums}" />
+						<h:commandLink action="#{ForumTool.processActionHome}" value="#{msgs.cdfm_discussion_forums}" title=" #{msgs.cdfm_discussion_forums}"
+							rendered="#{ForumTool.forumsTool}" />
+						<f:verbatim><h:outputText value=" " /><h:outputText value=" / " /><h:outputText value=" " /></f:verbatim>
+						<h:commandLink action="#{ForumTool.processActionDisplayForum}" value="#{ForumTool.selectedForum.forum.title}" 
+								title=" #{ForumTool.selectedForum.forum.title}" rendered="#{ForumTool.showForumLinksInNav}" >
+							<f:param value="#{ForumTool.selectedForum.forum.id}" name="forumId"/>
+						</h:commandLink>
+						<h:outputText value="#{ForumTool.selectedForum.forum.title}" rendered="#{!ForumTool.showForumLinksInNav}"/>
+						<f:verbatim><h:outputText value=" " /><h:outputText value=" / " /><h:outputText value=" " /></f:verbatim>
+						<h:commandLink action="#{ForumTool.processActionDisplayTopic}" value="#{ForumTool.selectedTopic.topic.title}" 
+								title=" #{ForumTool.selectedForum.forum.title}">
+								<f:param value="#{ForumTool.selectedForum.forum.id}" name="forumId"/>
+								<f:param value="#{ForumTool.selectedTopic.topic.id}" name="topicId"/>
+						</h:commandLink>
+						<f:verbatim><h:outputText value=" " /><h:outputText value=" / " /><h:outputText value=" " /></f:verbatim>
+						<h:commandLink action="#{ForumTool.processActionDisplayThread}" value="#{ForumTool.selectedThreadHead.message.title}" 
+								title=" #{ForumTool.selectedThreadHead.message.title}">
+							<f:param value="#{ForumTool.selectedForum.forum.id}" name="forumId"/>
+							<f:param value="#{ForumTool.selectedTopic.topic.id}" name="topicId"/>
+							<f:param value="#{ForumTool.selectedThreadHead.message.id}" name="messageId"/>
+						</h:commandLink>
+					<f:verbatim></h3></f:verbatim>
+				</h:panelGroup>
+				<h:panelGroup styleClass="itemNav">
+					<h:outputText   value="#{msgs.cdfm_previous_thread}"  rendered="#{!ForumTool.selectedThreadHead.hasPreThread}" />
+					<h:commandLink action="#{ForumTool.processActionDisplayThread}" value="#{msgs.cdfm_previous_thread}"  rendered="#{ForumTool.selectedThreadHead.hasPreThread}">
+						<f:param value="#{ForumTool.selectedThreadHead.preThreadId}" name="messageId"/>
+						<f:param value="#{ForumTool.selectedTopic.topic.id}" name="topicId"/>
+						<f:param value="#{ForumTool.selectedForum.forum.id}" name="forumId"/>
+					</h:commandLink>
+					<f:verbatim><h:outputText  id="blankSpace1" value=" |  " /></f:verbatim>				
+					<h:outputText   value="#{msgs.cdfm_next_thread}" rendered="#{!ForumTool.selectedThreadHead.hasNextThread}" />
+					<h:commandLink action="#{ForumTool.processActionDisplayThread}" value="#{msgs.cdfm_next_thread}" rendered="#{ForumTool.selectedThreadHead.hasNextThread}">
 						<f:param value="#{ForumTool.selectedThreadHead.nextThreadId}" name="messageId"/>
 						<f:param value="#{ForumTool.selectedTopic.topic.id}" name="topicId"/>
 						<f:param value="#{ForumTool.selectedForum.forum.id}" name="forumId"/>
-					 </h:commandLink>
-			 </h:panelGroup>
-		  </h:panelGrid>
+					</h:commandLink>
+				 </h:panelGroup>
+			</h:panelGrid>
+			<%-- topic short description and long description --%>
+			<div class="topicBloc" style="width:80%;padding:0 .5em;margin:0;">
+				<p class="textPanel">
+					<h:outputText value="#{ForumTool.selectedTopic.topic.shortDescription}" />
+				</p>
+				<%-- link to open and close long desc. --%>
+				<p>
+					<h:commandLink immediate="true" 
+							action="#{ForumTool.processDfComposeToggle}" 
+							onmousedown="document.forms[0].onsubmit();"
+							rendered="#{ForumTool.selectedTopic.hasExtendedDesciption}" 
+							title="#{msgs.cdfm_read_full_description}"
+							styleClass="show">
+						<f:param value="dfViewMessage" name="redirectToProcessAction"/>
+						<f:param value="true" name="composeExpand"/>
+						<h:graphicImage url="/images/collapse.gif" />
+						<h:outputText value="#{msgs.cdfm_read_full_description}" />
+					</h:commandLink>
+					<h:commandLink immediate="true" 
+							action="#{ForumTool.processDfComposeToggle}" 
+							onmousedown="document.forms[0].onsubmit();"
+							rendered="#{ForumTool.selectedTopic.readFullDesciption}"
+							title="#{msgs.cdfm_hide_full_description}"
+							styleClass="hide">
+						<f:param value="dfViewMessage" name="redirectToProcessAction"/>
+						<h:graphicImage url="/images/expand.gif"/>
+						<h:outputText value="#{msgs.cdfm_hide_full_description}" />
+					</h:commandLink>
+				</p>
+				<mf:htmlShowArea value="#{ForumTool.selectedTopic.topic.extendedDescription}" 
+					rendered="#{ForumTool.selectedTopic.readFullDesciption}" 
+					hideBorder="true"/>
+			</div>
+			<h:messages globalOnly="true" infoClass="success" errorClass="alertMessage" />
 
-		<p class="textPanel">
-		  <h:outputText value="#{ForumTool.selectedTopic.topic.shortDescription}" />
-		  </p>
-		<p class="textPanelFooter">
-			<h:commandLink immediate="true" 
-		                   action="#{ForumTool.processDfComposeToggle}" 
-				           onmousedown="document.forms[0].onsubmit();"
-			               rendered="#{ForumTool.selectedTopic.hasExtendedDesciption}" 
-			               value="#{msgs.cdfm_read_full_description}"
-			               title="#{msgs.cdfm_read_full_description}">
-			  <f:param value="dfViewMessage" name="redirectToProcessAction"/>
-			  <f:param value="true" name="composeExpand"/>
-		  </h:commandLink>
-		  <h:commandLink immediate="true" 
-				  action="#{ForumTool.processDfComposeToggle}" 
-				  onmousedown="document.forms[0].onsubmit();"
-					value="#{msgs.cdfm_hide_full_description}" 
-					rendered="#{ForumTool.selectedTopic.readFullDesciption}"
-					title="#{msgs.cdfm_hide_full_description}">
-				<f:param value="dfViewMessage" name="redirectToProcessAction"/>
-		  </h:commandLink>					
-		  </p>
-		   
-		  <mf:htmlShowArea value="#{ForumTool.selectedTopic.topic.extendedDescription}" 
-		                   rendered="#{ForumTool.selectedTopic.readFullDesciption}" 
-		                   hideBorder="false" />
-	
-	  <h:messages globalOnly="true" infoClass="success" errorClass="alertMessage" />
-	
-		<sakai:tool_bar rendered="#{!ForumTool.deleteMsg && !ForumTool.selectedMessage.message.deleted}">
-			<h:panelGrid columns="2" width="100%" summary="layout">
-				<h:panelGroup styleClass="specialLink">
+
+			<h:panelGrid columns="2" 
+					width="100%" 
+					summary="layout" 
+					columnClasses="specialLink, specialLink otherOtherActions"
+					cellpadding="0" cellspacing="0"
+					rendered="#{!ForumTool.deleteMsg && !ForumTool.selectedMessage.message.deleted}" 
+					styleClass="messageActions"
+					style="margin:1em 0 0 0">
+				<h:panelGroup  style="display:block">
 					<h:commandLink title="#{msgs.cdfm_button_bar_reply_to_msg}" action="#{ForumTool.processDfMsgReplyMsg}" 
-		  				rendered="#{ForumTool.selectedTopic.isNewResponseToResponse && ForumTool.selectedMessage.msgApproved && !ForumTool.selectedTopic.locked}">
-		  				<h:graphicImage value="/../../library/image/silk/email_go.png" alt="#{msgs.cdfm_button_bar_reply_to_msg}" rendered="#{ForumTool.selectedTopic.isNewResponseToResponse}" />
-		  				<h:outputText value=" #{msgs.cdfm_button_bar_reply_to_msg}" />
-		  			</h:commandLink>
-      			
-		      		<h:commandLink title="#{msgs.cdfm_button_bar_reply_to_thread}" action="#{ForumTool.processDfMsgReplyThread}" 
-			  			rendered="#{ForumTool.selectedTopic.isNewResponse && ForumTool.selectedThreadHead.msgApproved && !ForumTool.selectedTopic.locked}">
-		  				<h:graphicImage value="/../../library/image/silk/folder_go.png" alt="#{msgs.cdfm_button_bar_reply_to_thread}" />
-		  				<h:outputText value=" #{msgs.cdfm_button_bar_reply_to_thread}" />
-		  			</h:commandLink>
-		  		
-			  		<h:commandLink title="#{msgs.cdfm_button_bar_delete_msg}" action="#{ForumTool.processDfMsgDeleteConfirm}" rendered="#{ForumTool.selectedMessage.userCanDelete}" >
-		  				<h:graphicImage value="/../../library/image/silk/email_delete.png" alt="#{msgs.cdfm_button_bar_delete_msg}" />
-		  				<h:outputText value=" #{msgs.cdfm_button_bar_delete_msg}" />
-		  			</h:commandLink>
-		  		
-			  		<h:commandLink title="#{msgs.cdfm_button_bar_revise}" action="#{ForumTool.processDfMsgRvs}" 
-			  			rendered="#{ForumTool.selectedMessage.revise}">
-			  			<h:graphicImage value="/../../library/image/silk/email_edit.png" alt="#{msgs.cdfm_button_bar_revise}" />
-		  				<h:outputText value=" #{msgs.cdfm_button_bar_revise}" />
-		  			</h:commandLink>
-		  		
-			  		<h:commandLink title="#{msgs.cdfm_button_bar_grade}" action="#{ForumTool.processDfMsgGrd}" 
-			  			rendered="#{ForumTool.selectedTopic.isPostToGradebook && ForumTool.gradebookExist}">
-			  			<h:graphicImage value="/../../library/image/silk/award_star_gold_1.png" alt="#{msgs.cdfm_button_bar_grade}" />
-		  				<h:outputText value=" #{msgs.cdfm_button_bar_grade}" />
-		  			</h:commandLink>
-			  	</h:panelGroup>
-			  	<h:panelGroup styleClass="specialLink" style="text-align:right;float:right;">
-			  		<h:commandLink title="#{msgs.cdfm_button_bar_deny}" action="#{ForumTool.processDfMsgDeny}" 
-		  							rendered="#{ForumTool.allowedToDenyMsg}">
-			  			<h:graphicImage value="/../../library/image/silk/cross.png" alt="#{msgs.cdfm_button_bar_deny}" />
-			  			<h:outputText value=" #{msgs.cdfm_button_bar_deny}" />
-			  		</h:commandLink>
-		  			<h:commandLink title="#{msgs.cdfm_button_bar_add_comment}" action="#{ForumTool.processDfMsgAddComment}" 
-		  				rendered="#{ForumTool.allowedToApproveMsg && ForumTool.selectedMessage.msgDenied}">
-			  			<h:graphicImage value="/../../library/image/silk/comment.png" alt="#{msgs.cdfm_button_bar_add_comment}" />
-			  			<h:outputText value=" #{msgs.cdfm_button_bar_add_comment}" />
-			  		</h:commandLink>
-		  		
-		  			<h:commandLink title="#{msgs.cdfm_button_bar_approve}" action="#{ForumTool.processDfMsgApprove}" 
-		  				rendered="#{ForumTool.allowedToApproveMsg}">
-		  				<h:graphicImage value="/../../library/image/silk/tick.png" alt="#{msgs.cdfm_button_bar_approve}" />
-			  			<h:outputText value=" #{msgs.cdfm_button_bar_approve}" />
-			  		</h:commandLink>
-			  	</h:panelGroup>
-		  	</h:panelGrid>
-  		</sakai:tool_bar>
+							rendered="#{ForumTool.selectedTopic.isNewResponseToResponse && ForumTool.selectedMessage.msgApproved && !ForumTool.selectedTopic.locked}">
+						<h:graphicImage value="/../../library/image/silk/email_go.png" alt="#{msgs.cdfm_button_bar_reply_to_msg}" rendered="#{ForumTool.selectedTopic.isNewResponseToResponse}" />
+						<h:outputText value=" #{msgs.cdfm_button_bar_reply_to_msg}" />
+					</h:commandLink>
+					
+					<h:commandLink title="#{msgs.cdfm_button_bar_reply_to_thread}" action="#{ForumTool.processDfMsgReplyThread}" 
+							rendered="#{ForumTool.selectedTopic.isNewResponse && ForumTool.selectedThreadHead.msgApproved && !ForumTool.selectedTopic.locked}">
+						<h:graphicImage value="/../../library/image/silk/folder_go.png" alt="#{msgs.cdfm_button_bar_reply_to_thread}" />
+						<h:outputText value=" #{msgs.cdfm_button_bar_reply_to_thread}" />
+					</h:commandLink>
+					
+					<h:commandLink title="#{msgs.cdfm_button_bar_delete_msg}" action="#{ForumTool.processDfMsgDeleteConfirm}" rendered="#{ForumTool.selectedMessage.userCanDelete}" >
+						<h:graphicImage value="/../../library/image/silk/email_delete.png" alt="#{msgs.cdfm_button_bar_delete_msg}" />
+						<h:outputText value=" #{msgs.cdfm_button_bar_delete_msg}" />
+					</h:commandLink>
+					
+					<h:commandLink title="#{msgs.cdfm_button_bar_revise}" action="#{ForumTool.processDfMsgRvs}" 
+							rendered="#{ForumTool.selectedMessage.revise}">
+						<h:graphicImage value="/../../library/image/silk/email_edit.png" alt="#{msgs.cdfm_button_bar_revise}" />
+						<h:outputText value=" #{msgs.cdfm_button_bar_revise}" />
+					</h:commandLink>
+					
+					<h:commandLink title="#{msgs.cdfm_button_bar_grade}" action="#{ForumTool.processDfMsgGrd}" 
+							rendered="#{ForumTool.selectedTopic.isPostToGradebook && ForumTool.gradebookExist}">
+						<h:graphicImage value="/../../library/image/silk/award_star_gold_1.png" alt="#{msgs.cdfm_button_bar_grade}" />
+						<h:outputText value=" #{msgs.cdfm_button_bar_grade}" />
+					</h:commandLink>
+				</h:panelGroup>
+				<h:panelGroup  style="display:block;white-space:nowrap;">
+					<h:commandLink title="#{msgs.cdfm_button_bar_deny}" action="#{ForumTool.processDfMsgDeny}" 
+							rendered="#{ForumTool.allowedToDenyMsg}">
+						<h:graphicImage value="/../../library/image/silk/cross.png" alt="#{msgs.cdfm_button_bar_deny}" />
+						<h:outputText value=" #{msgs.cdfm_button_bar_deny}" />
+					</h:commandLink>
+					<h:commandLink title="#{msgs.cdfm_button_bar_add_comment}" action="#{ForumTool.processDfMsgAddComment}" 
+							rendered="#{ForumTool.allowedToApproveMsg && ForumTool.selectedMessage.msgDenied}">
+						<h:graphicImage value="/../../library/image/silk/comment.png" alt="#{msgs.cdfm_button_bar_add_comment}" />
+						<h:outputText value=" #{msgs.cdfm_button_bar_add_comment}" />
+					</h:commandLink>
+					<h:commandLink title="#{msgs.cdfm_button_bar_approve}" action="#{ForumTool.processDfMsgApprove}" 
+							rendered="#{ForumTool.allowedToApproveMsg}">
+						<h:graphicImage value="/../../library/image/silk/tick.png" alt="#{msgs.cdfm_button_bar_approve}" />
+						<h:outputText value=" #{msgs.cdfm_button_bar_approve}" />
+					</h:commandLink>
+				</h:panelGroup>	
+			</h:panelGrid>
 
-	<f:verbatim><div class="hierItemBlock" style="padding-bottom:0"></f:verbatim>
-	<f:verbatim><h4 class="textPanelHeader" style="margin-bottom:0"></f:verbatim>
-	
-    <h:panelGrid columns="3" styleClass="itemSummary" style="width: 100%;">
-    	<h:outputText value="#{msgs.cdfm_subject}"/>
-
-		<%-- Display if message deleted. need to wrap text since inactive class styles children tags only --%>
-    	<h:panelGroup styleClass="inactive" rendered="#{ForumTool.selectedMessage.message.deleted}">
-			<f:verbatim><span></f:verbatim>
-				<h:outputText value="#{msgs.cdfm_msg_deleted_label}" />
-			<f:verbatim></span></f:verbatim>
- 		</h:panelGroup>
- 		
-  		<h:panelGroup rendered="#{!ForumTool.selectedMessage.message.deleted}" >
-    		<h:outputText value="#{ForumTool.selectedMessage.message.title}" />
-    	</h:panelGroup>
-    	<h:panelGroup styleClass="msgNav">
-    		<h:commandLink action="#{ForumTool.processDisplayPreviousMsg}" rendered="#{ForumTool.selectedMessage.hasPre}" 
-                       title=" #{msgs.cdfm_prev_msg}">
-			      <h:outputText value="#{msgs.cdfm_prev_msg}" />
- 			    </h:commandLink>
-			    <h:outputText value="#{msgs.cdfm_prev_msg}"  rendered="#{!ForumTool.selectedMessage.hasPre}" />
-			    <f:verbatim><h:outputText value=" | " /></f:verbatim>
-			    <h:commandLink action="#{ForumTool.processDfDisplayNextMsg}" rendered="#{ForumTool.selectedMessage.hasNext}" 
-			                   title=" #{msgs.cdfm_next_msg}">
-	 		      <h:outputText value="#{msgs.cdfm_next_msg}" />
-			    </h:commandLink>
-			    <h:outputText value="#{msgs.cdfm_next_msg}" rendered="#{!ForumTool.selectedMessage.hasNext}" />
-    	</h:panelGroup>
-    	
-    	<h:outputText value="#{msgs.cdfm_authoredby}" rendered="#{!ForumTool.selectedMessage.message.deleted}" />
-    	<h:panelGroup rendered="#{!ForumTool.selectedMessage.message.deleted}" >
-	    	<h:outputText value="#{ForumTool.selectedMessage.message.author}" />
-	    	<h:outputText value=" #{msgs.cdfm_openb} " />
-	      	<h:outputText value="#{ForumTool.selectedMessage.message.created}" >
-          		<f:convertDateTime pattern="#{msgs.date_format}" />  
-        	</h:outputText>
-        	<h:outputText value=" #{msgs.cdfm_closeb}" />
-	    </h:panelGroup>
-		<h:outputText value="" />
-      
-      <h:outputText value="#{msgs.cdfm_att}" rendered="#{!empty ForumTool.selectedMessage.attachList}" />
-      <h:panelGroup rendered="#{!empty ForumTool.selectedMessage.attachList}">
-      	<h:dataTable value="#{ForumTool.selectedMessage.attachList}" var="eachAttach"  styleClass="attachListJSF"  rendered="#{!empty ForumTool.selectedMessage.attachList}">
-			  		<h:column rendered="#{!empty ForumTool.selectedMessage.message.attachments}">
-				      <h:graphicImage url="/images/excel.gif" rendered="#{eachAttach.attachment.attachmentType == 'application/vnd.ms-excel'}" alt="" />
-						  <h:graphicImage url="/images/html.gif" rendered="#{eachAttach.attachment.attachmentType == 'text/html'}" alt="" />
-							<h:graphicImage url="/images/pdf.gif" rendered="#{eachAttach.attachment.attachmentType == 'application/pdf'}" alt="" />
-							<h:graphicImage url="/sakai-messageforums-tool/images/ppt.gif" rendered="#{eachAttach.attachment.attachmentType == 'application/vnd.ms-powerpoint'}" alt="" />
-							<h:graphicImage url="/images/text.gif" rendered="#{eachAttach.attachment.attachmentType == 'text/plain'}" alt="" />
-							<h:graphicImage url="/images/word.gif" rendered="#{eachAttach.attachment.attachmentType == 'application/msword'}" alt="" />
-								  
-<%--							<h:outputLink value="#{eachAttach.attachmentUrl}" target="_blank">
-							 	<h:outputText value="#{eachAttach.attachmentName}"/>
-							  </h:outputLink>--%>
-							<h:outputLink value="#{eachAttach.url}" target="_blank">
-							 	<h:outputText value="#{eachAttach.attachment.attachmentName}"/>
-						  </h:outputLink>
-							  
-					  </h:column>
-
-					</h:dataTable>
-      <h:outputText value="" rendered="#{!empty ForumTool.selectedMessage.attachList}" />
-      </h:panelGroup>
-    </h:panelGrid>
+			<f:verbatim><div class="singleMessage">
+			</f:verbatim>
+				<%--title, metadata and navigation --%>
+				<h:panelGrid columns="2"  style="width: 100%;" border="0">
+					<h:outputText rendered="#{ForumTool.selectedMessage.message.deleted}"  value="#{msgs.cdfm_msg_deleted_label}" styleClass="instruction"/>
+					<h:panelGroup rendered="#{!ForumTool.selectedMessage.message.deleted}" style="display:block">
+						<h:outputText rendered="#{ ForumTool.selectedMessage.msgDenied}" value="#{msgs.cdfm_msg_denied_label}" styleClass="messageDenied"/>
+						<h:outputText 	rendered="#{ForumTool.allowedToApproveMsg && ForumTool.allowedToDenyMsg}" value="#{msgs.cdfm_msg_pending_label}" styleClass="messagePending"/>
+						<h:outputText value="#{ForumTool.selectedMessage.message.title}"  styleClass="title" />
+						<h:outputText value="<br />" escape="false" />
+						<h:outputText value="#{ForumTool.selectedMessage.message.author}" styleClass="textPanelFooter" style="padding-left:.5em"/>
+						<h:outputText value=" #{msgs.cdfm_openb} "  styleClass="textPanelFooter" />
+						<h:outputText value="#{ForumTool.selectedMessage.message.created}"  styleClass="textPanelFooter" >
+							<f:convertDateTime pattern="#{msgs.date_format}" />  
+						</h:outputText>
+						<h:outputText value=" #{msgs.cdfm_closeb}"  styleClass="textPanelFooter" />
+					</h:panelGroup>                                                                                            
+					<%--navigation cell --%>
+					<h:panelGroup styleClass="itemNav">
+						<h:commandLink action="#{ForumTool.processDisplayPreviousMsg}" rendered="#{ForumTool.selectedMessage.hasPre}" 
+								title=" #{msgs.cdfm_prev_msg}">
+							<h:outputText value="#{msgs.cdfm_prev_msg}" />
+						</h:commandLink>
+						<h:outputText value="#{msgs.cdfm_prev_msg}"  rendered="#{!ForumTool.selectedMessage.hasPre}" />
+						<f:verbatim><h:outputText value=" | " /></f:verbatim>
+						<h:commandLink action="#{ForumTool.processDfDisplayNextMsg}" rendered="#{ForumTool.selectedMessage.hasNext}" 
+								title=" #{msgs.cdfm_next_msg}">
+							<h:outputText value="#{msgs.cdfm_next_msg}" />
+						</h:commandLink>
+						<h:outputText value="#{msgs.cdfm_next_msg}" rendered="#{!ForumTool.selectedMessage.hasNext}" />
+					</h:panelGroup>
+				</h:panelGrid>
+				<f:verbatim><div class="textPanel"></f:verbatim>
+					<h:outputText escape="false" value="#{ForumTool.selectedMessage.message.body}" 
+							rendered="#{!ForumTool.selectedMessage.message.deleted}" />
+				<f:verbatim></div></f:verbatim>
+				<h:dataTable value="#{ForumTool.selectedMessage.attachList}" var="eachAttach"  cellpadding="3" cellspacing="0" columnClasses="attach,bogus" summary="layout"  style="font-size:.9em;width:auto;margin-left:1em" border="0">
+					<h:column rendered="#{!empty ForumTool.selectedMessage.message.attachments}">
+						<h:graphicImage url="/images/attachment.gif" />
+						<%-- <h:outputLink value="#{eachAttach.attachmentUrl}" target="_blank">
+							<h:outputText value="#{eachAttach.attachmentName}"/>
+						</h:outputLink>--%>
+						<h:outputText value=" "/>
+						<h:outputLink value="#{eachAttach.url}" target="_blank">
+							<h:outputText value="#{eachAttach.attachment.attachmentName}"/>
+						</h:outputLink>
+					</h:column>
+				</h:dataTable>
+			<f:verbatim></div></f:verbatim>
 		
-		<%-- <hr class="itemSeparator" /> --%>
-		<f:verbatim></h4></f:verbatim>
-    	<f:verbatim><div style="width:100%;height:150px;overflow:auto;"></f:verbatim>
-			<h:outputText escape="false" value="#{ForumTool.selectedMessage.message.body}" 
-						rendered="#{!ForumTool.selectedMessage.message.deleted}" />
-		<f:verbatim></div></f:verbatim>
-			
-	<f:verbatim></div></f:verbatim>
+			<h:panelGroup rendered="#{ForumTool.deleteMsg && ForumTool.errorSynch}">
+				<h:outputText styleClass="alertMessage" 
+				value="#{msgs.cdfm_msg_del_has_reply}" />
+			</h:panelGroup>
+		
+			<%-- If deleting, tells where to go back to --%>	
+			<h:inputHidden value="#{ForumTool.fromPage}" />
+		
+			<sakai:button_bar rendered="#{ForumTool.deleteMsg}" > 
+				<sakai:button_bar_item action="#{ForumTool.processDfMsgDeleteConfirmYes}" value="#{msgs.cdfm_button_bar_delete}" accesskey="x" />
+				<sakai:button_bar_item action="#{ForumTool.processDfMsgDeleteCancel}" value="#{msgs.cdfm_button_bar_cancel}" accesskey="c" />
+			</sakai:button_bar>
 
-	<h:panelGroup rendered="#{ForumTool.deleteMsg && ForumTool.errorSynch}">
-		<h:outputText styleClass="alertMessage" 
-		value="#{msgs.cdfm_msg_del_has_reply}" />
-	</h:panelGroup>
-	
-	<%-- If deleting, tells where to go back to --%>	
-	<h:inputHidden value="#{ForumTool.fromPage}" />
-	
-    <sakai:button_bar rendered="#{ForumTool.deleteMsg}" > 
-      <sakai:button_bar_item action="#{ForumTool.processDfMsgDeleteConfirmYes}" value="#{msgs.cdfm_button_bar_delete}" accesskey="x" />
-      <sakai:button_bar_item action="#{ForumTool.processDfMsgDeleteCancel}" value="#{msgs.cdfm_button_bar_cancel}" accesskey="c" />
-    </sakai:button_bar>
-
- 	</h:form>
-</sakai:view>
+		</h:form>
+	</sakai:view>
 </f:view>
Index: msgcntr/messageforums-app/src/webapp/jsp/discussionForum/message/printFriendly.jsp
===================================================================
--- msgcntr/messageforums-app/src/webapp/jsp/discussionForum/message/printFriendly.jsp	(revision 46869)
+++ msgcntr/messageforums-app/src/webapp/jsp/discussionForum/message/printFriendly.jsp	(working copy)
@@ -3,61 +3,57 @@
 <%@ taglib uri="http://sakaiproject.org/jsf/sakai" prefix="sakai" %>
 <%@ taglib uri="http://sakaiproject.org/jsf/messageforums" prefix="mf" %>
 <jsp:useBean id="msgs" class="org.sakaiproject.util.ResourceLoader" scope="session">
-   <jsp:setProperty name="msgs" property="baseName" value="org.sakaiproject.api.app.messagecenter.bundle.Messages"/>
+	<jsp:setProperty name="msgs" property="baseName" value="org.sakaiproject.api.app.messagecenter.bundle.Messages"/>
 </jsp:useBean>
 
 <f:view>
-<sakai:view>
-	<h:form id="msgForum">
-<!--jsp/discussionForum/message/printFriendly.jsp-->
-		
-			<div>
+	<sakai:view>
+		<h:form id="msgForum">
+			<style type="text/css">
+			@import url("/sakai-messageforums-tool/css/msgcntr.css");
+			</style>
+			
+			<!--jsp/discussionForum/message/printFriendly.jsp-->
+			
+			<div class="navIntraTool">
 				<a id="printIcon" href="" onClick="javascript:window.print();">
 					<h:graphicImage url="/../../library/image/silk/printer.png" alt="#{msgs.print_friendly}" title="#{msgs.print_friendly}" />
 					<h:outputText value="#{msgs.send_to_printer}" />
 				</a>
-				<h:outputText value=" " /><h:outputText value="|" /><h:outputText value=" " />
 				<a value="" href="" onClick="window.close();" >
 					<h:outputText value="#{msgs.close_window}" />
 				</a>
 			</div>
-		
-			    <h:panelGroup>
-					<f:verbatim><div class="breadCrumb specialLink"><h3></f:verbatim>
-			      <h:outputText value="#{msgs.cdfm_discussion_forums}" />
-      			  <f:verbatim><h:outputText value=" " /><h:outputText value=" / " /><h:outputText value=" " /></f:verbatim>
-				  <h:outputText value="#{ForumTool.selectedForum.forum.title}" />
-				  <f:verbatim><h:outputText value=" " /><h:outputText value=" / " /><h:outputText value=" " /></f:verbatim>
-				  	  <h:outputText value="#{ForumTool.selectedTopic.topic.title}" />
-				  <f:verbatim></h3></div></f:verbatim>
-				 </h:panelGroup>
-		
-	
-		<%--rjlowe: Expanded View to show the message bodies, threaded --%>
-		<mf:hierDataTable id="expandedThreadedMessages" value="#{ForumTool.pFMessages}" var="message" 
-   	 		noarrows="true" styleClass="listHier" cellpadding="0" cellspacing="0" width="100%" columnClasses="bogus">
-			<h:column id="_msg_subject">
-				<f:verbatim><div class="hierItemBlock"></f:verbatim>
-
-				<f:verbatim><h4 class="textPanelHeader specialLink" style="width:100%"></f:verbatim>
-                                                  
-                       <h:outputText value="#{message.message.title}" />		          	
-		          	<h:outputText value=" - #{message.message.author}"/>
-   
-                    <h:outputText value="#{message.message.created}">
-			   	         <f:convertDateTime pattern="#{msgs.date_format_paren}" />
-           			</h:outputText>
-
-                    <f:verbatim></h4></f:verbatim>
-
-	  			<mf:htmlShowArea value="#{message.message.body}" hideBorder="true" />
-
-				<f:verbatim></div></f:verbatim>
-			</h:column>
-		</mf:hierDataTable>
+			<div class="printBlock">
+				<h2>
+					<h:outputText value="#{msgs.cdfm_discussion_forums}" />
+					<f:verbatim><h:outputText value=" " /><h:outputText value=" / " /><h:outputText value=" " /></f:verbatim>
+					<h:outputText value="#{ForumTool.selectedForum.forum.title}" />
+					<f:verbatim><h:outputText value=" " /><h:outputText value=" / " /><h:outputText value=" " /></f:verbatim>
+					<h:outputText value="#{ForumTool.selectedTopic.topic.title}" />
+				</h2>
 				
-		<h:inputHidden id="mainOrForumOrTopic" value="dfAllMessages" />
-		
-	</h:form>
-</sakai:view>
+			
+				<%--rjlowe: Expanded View to show the message bodies, threaded --%>
+				<mf:hierDataTable id="expandedThreadedMessages" value="#{ForumTool.pFMessages}" var="message" 
+						noarrows="true" styleClass="listHier printTable" cellpadding="0" cellspacing="0" width="100%" columnClasses="bogus">
+					<h:column id="_msg_subject">
+					<%-- message has been submitted and has bene denied  approval by moderator--%>
+					<h:outputText value="#{msgs.cdfm_msg_denied_label}"  styleClass="messageDenied"  rendered="#{message.msgDenied}" />
+					<%-- message has been submitted and is pending approval by moderator--%> 
+					<h:outputText value="#{msgs.cdfm_msg_pending_label}" styleClass="messagePending" rendered="#{message.msgPending}" />
+					<h:outputText value="#{message.message.title}"  styleClass="title"/>		          	
+						<h:outputText value=" - #{message.message.author}"/>
+						<h:outputText value="#{message.message.created}">
+							<f:convertDateTime pattern="#{msgs.date_format_paren}" />
+						</h:outputText>
+						<mf:htmlShowArea value="#{message.message.body}" hideBorder="false" />
+					
+						</h:column>
+				</mf:hierDataTable>
+			</div>
+			<h:inputHidden id="mainOrForumOrTopic" value="dfAllMessages" />
+			
+		</h:form>
+	</sakai:view>
 </f:view>
\ No newline at end of file
Index: msgcntr/messageforums-app/src/webapp/jsp/discussionForum/message/dfAllMessages.jsp
===================================================================
--- msgcntr/messageforums-app/src/webapp/jsp/discussionForum/message/dfAllMessages.jsp	(revision 46869)
+++ msgcntr/messageforums-app/src/webapp/jsp/discussionForum/message/dfAllMessages.jsp	(working copy)
@@ -3,216 +3,254 @@
 <%@ taglib uri="http://sakaiproject.org/jsf/sakai" prefix="sakai" %>
 <%@ taglib uri="http://sakaiproject.org/jsf/messageforums" prefix="mf" %>
 <jsp:useBean id="msgs" class="org.sakaiproject.util.ResourceLoader" scope="session">
-   <jsp:setProperty name="msgs" property="baseName" value="org.sakaiproject.api.app.messagecenter.bundle.Messages"/>
+	<jsp:setProperty name="msgs" property="baseName" value="org.sakaiproject.api.app.messagecenter.bundle.Messages"/>
 </jsp:useBean>
 
 <f:view>
-<sakai:view>
-<script language="JavaScript">
-	// open print preview in another browser window so can size approx what actual
-	// print out will look like
-	function printFriendly(url) {
-		window.open(url,'mywindow','width=960,height=1100'); 		
-	}
-</script>
-	<h:form id="msgForum">
-<!--jsp/discussionForum/message/dfAllMessages.jsp-->
-  		<script type="text/javascript" src="/library/js/jquery.js"></script>
-  		<sakai:script contextBase="/sakai-messageforums-tool" path="/js/sak-10625.js"/>
-		<sakai:script contextBase="/sakai-messageforums-tool" path="/js/forum.js"/>
-		
-		<sakai:tool_bar separator="#{msgs.cdfm_toolbar_separator}">
+	<sakai:view>
+		<script type="text/javascript">
+			// open print preview in another browser window so can size approx what actual
+			// print out will look like
+			function printFriendly(url) {
+			newwindow=window.open(url,'mywindow','width=960,height=1100,scrollbars=yes,resizable=yes');
+			if (window.focus) {newwindow.focus()}
+			}
+		</script>
+			<style type="text/css">
+				@import url("/sakai-messageforums-tool/css/msgcntr.css");
+			</style>
+		<h:form id="msgForum"   rendered="#{!ForumTool.selectedTopic.topic.draft || ForumTool.selectedTopic.topic.createdBy == ForumTool.userId}">
+			<!--jsp/discussionForum/message/dfAllMessages.jsp-->
+	
+			<script type="text/javascript" src="/library/js/jquery.js"></script>
+			<sakai:script contextBase="/sakai-messageforums-tool" path="/js/sak-10625.js"/>
+			<sakai:script contextBase="/sakai-messageforums-tool" path="/js/forum.js"/>
+	
+			<sakai:tool_bar separator="#{msgs.cdfm_toolbar_separator}">
+				<%--
 				<sakai:tool_bar_item value="#{msgs.cdfm_container_title_thread}" action="#{ForumTool.processAddMessage}" id="df_compose_message_dfAllMessages"
-		  			rendered="#{ForumTool.selectedTopic.isNewResponse && !ForumTool.selectedTopic.locked}" />
-      			
-      	<sakai:tool_bar_item value="#{msgs.cdfm_flat_view}" action="#{ForumTool.processActionDisplayFlatView}" />
-      			
-        <sakai:tool_bar_item action="#{ForumTool.processActionTopicSettings}" id="topic_setting" value="#{msgs.cdfm_topic_settings}" 
-							rendered="#{ForumTool.selectedTopic.changeSettings}" />
-					
+					rendered="#{ForumTool.selectedTopic.isNewResponse && !ForumTool.selectedTopic.locked}" />
+						--%>
+					<sakai:tool_bar_item value="#{msgs.cdfm_flat_view}" action="#{ForumTool.processActionDisplayFlatView}" />
+				<%--<sakai:tool_bar_item action="#{ForumTool.processActionTopicSettings}" id="topic_setting" value="#{msgs.cdfm_topic_settings}" 
+					rendered="#{ForumTool.selectedTopic.changeSettings}" /> --%>
 				<h:outputLink id="print" value="javascript:printFriendly('#{ForumTool.printFriendlyUrl}');">
 					<h:graphicImage url="/../../library/image/silk/printer.png" alt="#{msgs.print_friendly}" title="#{msgs.print_friendly}" />
 				</h:outputLink>
- 		</sakai:tool_bar>
- 			
-		
-			  <h:panelGrid columns="2" summary="layout" width="100%" styleClass="navPanel specialLink">
-			    <h:panelGroup>
-					<f:verbatim><div class="breadCrumb specialLink"><h3></f:verbatim>
-			      <h:commandLink action="#{ForumTool.processActionHome}" value="#{msgs.cdfm_message_forums}" title=" #{msgs.cdfm_message_forums}"
-			      		rendered="#{ForumTool.messagesandForums}" />
-			      <h:commandLink action="#{ForumTool.processActionHome}" value="#{msgs.cdfm_discussion_forums}" title=" #{msgs.cdfm_discussion_forums}"
-			      		rendered="#{ForumTool.forumsTool}" />
-      			  <f:verbatim><h:outputText value=" " /><h:outputText value=" / " /><h:outputText value=" " /></f:verbatim>
-					  <h:commandLink action="#{ForumTool.processActionDisplayForum}" value="#{ForumTool.selectedForum.forum.title}" title=" #{ForumTool.selectedForum.forum.title}" rendered="#{ForumTool.showForumLinksInNav}">
-						  <f:param value="#{ForumTool.selectedForum.forum.id}" name="forumId"/>
-					  </h:commandLink>
-					  <h:outputText value="#{ForumTool.selectedForum.forum.title}" rendered="#{!ForumTool.showForumLinksInNav}"/>
-					  <f:verbatim><h:outputText value=" " /><h:outputText value=" / " /><h:outputText value=" " /></f:verbatim>
-					  <h:outputText value="#{ForumTool.selectedTopic.topic.title}" />
-					  <f:verbatim></h3></div></f:verbatim>
-				 </h:panelGroup>
-				 <h:panelGroup styleClass="itemNav">
-				   <h:outputText   value="#{msgs.cdfm_previous_topic}"  rendered="#{!ForumTool.selectedTopic.hasPreviousTopic}" />
-					 <h:commandLink action="#{ForumTool.processActionDisplayPreviousTopic}" value="#{msgs.cdfm_previous_topic}"  rendered="#{ForumTool.selectedTopic.hasPreviousTopic}" 
-					                title=" #{msgs.cdfm_previous_topic}">
-						 <f:param value="#{ForumTool.selectedTopic.previousTopicId}" name="previousTopicId"/>
-						 <f:param value="#{ForumTool.selectedForum.forum.id}" name="forumId"/>
-					 </h:commandLink>
-					 <f:verbatim><h:outputText  id="blankSpace1" value=" |  " /></f:verbatim>				
-					 <h:outputText   value="#{msgs.cdfm_next_topic}" rendered="#{!ForumTool.selectedTopic.hasNextTopic}" />
-					 <h:commandLink action="#{ForumTool.processActionDisplayNextTopic}" value="#{msgs.cdfm_next_topic}" rendered="#{ForumTool.selectedTopic.hasNextTopic}" 
-					                title=" #{msgs.cdfm_next_topic}">
+			</sakai:tool_bar>
+			<h:panelGrid columns="2" summary="layout" 	width="100%" styleClass="specialLink">
+				<h:panelGroup>
+					<f:verbatim><div class="specialLink"><h3></f:verbatim>
+						<h:commandLink action="#{ForumTool.processActionHome}" value="#{msgs.cdfm_message_forums}" title=" #{msgs.cdfm_message_forums}"
+							rendered="#{ForumTool.messagesandForums}" />
+						<h:commandLink action="#{ForumTool.processActionHome}" value="#{msgs.cdfm_discussion_forums}" title=" #{msgs.cdfm_discussion_forums}"
+							rendered="#{ForumTool.forumsTool}" />
+						<f:verbatim><h:outputText value=" " /><h:outputText value=" / " /><h:outputText value=" " /></f:verbatim>
+						<h:commandLink action="#{ForumTool.processActionDisplayForum}" value="#{ForumTool.selectedForum.forum.title}" title=" #{ForumTool.selectedForum.forum.title}" rendered="#{ForumTool.showForumLinksInNav}">
+							<f:param value="#{ForumTool.selectedForum.forum.id}" name="forumId"/>
+						</h:commandLink>
+						<h:outputText value="#{ForumTool.selectedForum.forum.title}" rendered="#{!ForumTool.showForumLinksInNav}"/>
+						<f:verbatim><h:outputText value=" " /><h:outputText value=" / " /><h:outputText value=" " /></f:verbatim>
+						<h:outputText value="#{ForumTool.selectedTopic.topic.title}" />
+						<%--//designNote: up arrow should go here - get decent image and put title into link. --%>
+						<h:commandLink action="#{ForumTool.processActionDisplayForum}"  title="Go up one level" rendered="#{ForumTool.showForumLinksInNav}" style="margin-left:.3em">
+							<h:graphicImage url="/images/silk/arrow_turn_up.gif" style="vertical-align:top;padding:0;margin-top:-2px"/>	
+							<f:param value="#{ForumTool.selectedForum.forum.id}" name="forumId"/>
+						</h:commandLink>
+					<f:verbatim></h3></div></f:verbatim>
+				</h:panelGroup>
+				<h:panelGroup styleClass="itemNav">
+					<h:outputText   value="#{msgs.cdfm_previous_topic}"  rendered="#{!ForumTool.selectedTopic.hasPreviousTopic}" />
+					<h:commandLink action="#{ForumTool.processActionDisplayPreviousTopic}" value="#{msgs.cdfm_previous_topic}"  rendered="#{ForumTool.selectedTopic.hasPreviousTopic}"
+							title=" #{msgs.cdfm_previous_topic}">
+						<f:param value="#{ForumTool.selectedTopic.previousTopicId}" name="previousTopicId"/>
+						<f:param value="#{ForumTool.selectedForum.forum.id}" name="forumId"/>
+					</h:commandLink>
+					<f:verbatim><h:outputText  id="blankSpace1" value=" |  " /></f:verbatim>
+					<h:outputText   value="#{msgs.cdfm_next_topic}" rendered="#{!ForumTool.selectedTopic.hasNextTopic}" />
+					<h:commandLink action="#{ForumTool.processActionDisplayNextTopic}" value="#{msgs.cdfm_next_topic}" rendered="#{ForumTool.selectedTopic.hasNextTopic}" 
+							title=" #{msgs.cdfm_next_topic}">
 						<f:param value="#{ForumTool.selectedTopic.nextTopicId}" name="nextTopicId"/>
 						<f:param value="#{ForumTool.selectedForum.forum.id}" name="forumId"/>
-					 </h:commandLink>
-				 </h:panelGroup>
-			  </h:panelGrid>
-			<h:outputText escape="false" value="<p class='textPanel'>" rendered="#{ForumTool.selectedTopic.topic.shortDescription} != ''}" />
-				<h:outputText   value="#{ForumTool.selectedTopic.topic.shortDescription}" rendered="#{ForumTool.selectedTopic.topic.shortDescription} != ''}" />
-			<h:outputText escape="false" value="</p>" rendered="#{ForumTool.selectedTopic.topic.shortDescription} != ''}" />
-				<p class="textPanelFooter specialLink">
-		
-						<%--gsilver: would be good if the returned url from this would include a named internal anchor as the target so that the expando/collapso would go to the top of the viewport and avoid having to scroll and find --%>
-					  <h:outputLink id="forum_extended_show" value="#" title="#{msgs.cdfm_read_full_description}" styleClass="show" 
-					  		rendered="#{ForumTool.selectedTopic.topic.extendedDescription != '' && ForumTool.selectedTopic.topic.extendedDescription != null}"
-					  		onclick="resize();$(this).next('.hide').toggle(); $('div.toggle').slideToggle(resize);$(this).toggle();">
-					  		<h:outputText value="#{msgs.cdfm_read_full_description}" />
-					  </h:outputLink>
-					  
-					  <h:outputLink id="forum_extended_hide" value="#" title="#{msgs.cdfm_hide_full_description}" style="display:none" styleClass="hide" 
-					  		rendered="#{ForumTool.selectedTopic.topic.extendedDescription != '' && ForumTool.selectedTopic.topic.extendedDescription != null}"
-					  		onclick="resize();$(this).prev('.show').toggle(); $('div.toggle').slideToggle(resize);$(this).toggle();">
-					  		<h:outputText value="#{msgs.cdfm_hide_full_description}" />
-					  </h:outputLink>
-				    
-				</p>
-				<br />
-				<f:verbatim><div class="toggle" style="display:none"></f:verbatim>
-					<mf:htmlShowArea  id="forum_fullDescription" hideBorder="false"	 value="#{ForumTool.selectedTopic.topic.extendedDescription}"/> 
-			    <f:verbatim></div></f:verbatim>
-				<%--<%@include file="dfViewSearchBar.jsp"%> --%>
-     <%-- gsilver:need a rendered attribute here that will toggle the display of the table (if messages) or a textblock (class="instruction") if there are no messages--%> 				
-   		
-		<%-- gsilver:this table outputs a row for each indented message that starts with e <script /> element - not allowed as the child of <tbody />
-			Also the threading seems off. Finnaly - the threading indent shoud be done with a 1em padding per indent instead of by use of &nbsp;--%>
-		<mf:hierDataTable styleClass="hierItemBlockWrapper listHier lines nolines" id="messagesInHierDataTable" value="#{ForumTool.messages}" var="message" expanded="#{ForumTool.expanded}"
-		                  columnClasses="attach,bogus,bogus,bogus" cellspacing="0" cellpadding="0">
-			<h:column id="_toggle">
-				<f:facet name="header">
-					<h:commandLink action="#{ForumTool.processActionToggleExpanded}" immediate="true" title="#{msgs.cdfm_collapse_expand_all}">
-						<h:graphicImage value="/images/expand.gif" rendered="#{ForumTool.expanded == 'true'}" />
-						<h:graphicImage value="/images/collapse.gif" rendered="#{ForumTool.expanded != 'true'}" />
 					</h:commandLink>
-				</f:facet>
-			</h:column>
-			
-			<h:column id="_msg_subject">
-				<f:facet name="header">
-					<h:outputText value="#{msgs.cdfm_thread}" />
-				</f:facet>
-				<h:outputText escape="false" value="<a id=\"#{message.message.id}\" name=\"#{message.message.id}\"></a>" />
-				
-				<%-- Display deleted message linked if any child messages (not deleted) --%>
-				<h:panelGroup styleClass="inactive" rendered="#{message.deleted && message.depth == 0 && message.childCount > 0}" >
-					<h:commandLink action="#{ForumTool.processActionDisplayThread}" immediate="true" title="#{msgs.cdfm_msg_deleted_label}" >
-						<h:outputText value="#{msgs.cdfm_msg_deleted_label}" />
-
-       	    			<f:param value="#{message.message.id}" name="messageId"/>
-   	    		    	<f:param value="#{ForumTool.selectedTopic.topic.id}" name="topicId"/>
-    			    	<f:param value="#{ForumTool.selectedTopic.topic.baseForum.id}" name="forumId"/>
-					</h:commandLink>
 				</h:panelGroup>
-				
-				<h:panelGroup rendered="#{!message.deleted}">
-					<h:outputText value="#{msgs.cdfm_msg_pending_label} " styleClass="highlight" rendered="#{message.msgPending}" />
-					<h:outputText value="#{msgs.cdfm_msg_denied_label} " rendered="#{message.msgDenied}" />
-				
-					<%-- Rendered to view current thread only --%>
-					<h:commandLink action="#{ForumTool.processActionDisplayThread}" immediate="true" title="#{message.message.title}"
-						rendered="#{message.depth == 0}">
-				   		<h:outputText escape="false" value="#{message.message.title}" rendered="#{message.read && message.childUnread == 0 }" />
-    	        		<h:outputText styleClass="unreadMsg" value="#{message.message.title}" rendered="#{!message.read || message.childUnread > 0}"/>
+			</h:panelGrid>
+		
+			<h:panelGrid columns="1" summary="layout" width="100%"  styleClass="topicBloc topicBlocLone specialLink"  cellspacing="0" cellpadding="0">
+				<h:panelGroup>
+					<h:outputText styleClass="highlight title" id="draft" value="#{msgs.cdfm_draft}" rendered="#{ForumTool.selectedTopic.topic.draft == 'true'}"/>
+					<h:outputText id="draft_space" value="  - " rendered="#{ForumTool.selectedTopic.topic.draft == 'true'}" styleClass="title"/>
+					<h:graphicImage url="/images/silk/lock.png" alt="#{msgs.cdfm_forum_locked}" rendered="#{ForumTool.selectedForum.forum.locked == 'true' || ForumTool.selectedTopic.topic.locked == 'true'}" style="margin-right:.5em"/>
+					<h:outputText value="#{ForumTool.selectedTopic.topic.title}" styleClass="title"/>
+					  <%--//designNote: for paralellism to other views, need to add read/unread count here as well as Moderated attribute--%>  
+					  <h:outputText value=" #{msgs.cdfm_openb}" styleClass="textPanelFooter"/> 
+					  <h:outputText value="123 messages - 5 unread" styleClass="textPanelFooter todo" />
+					  <h:outputText id="topic_moderated" value="  #{msgs.cdfm_topic_moderated_flag}"  styleClass="textPanelFooter" rendered="#{ForumTool.selectedTopic.topic.moderated == 'true'}" />
 
-	       	    		<f:param value="#{message.message.id}" name="messageId"/>
-    	    	    	<f:param value="#{ForumTool.selectedTopic.topic.id}" name="topicId"/>
-   	    		    	<f:param value="#{ForumTool.selectedTopic.topic.baseForum.id}" name="forumId"/>
-	    	      	</h:commandLink>
+					  <h:outputText value="#{msgs.cdfm_closeb}" styleClass="textPanelFooter"/>
+					  <h:outputText value=" "  styleClass="actionLinks"/>
+					  <%--//designNote: for paralellism to other views, need to move the "Post new thread" link below, but it is a sakai:toolbar item above...same for Topic Settings --%>
+					  <sakai:tool_bar_item value="#{msgs.cdfm_container_title_thread}" action="#{ForumTool.processAddMessage}" id="df_compose_message_dfAllMessages"
+					  	rendered="#{ForumTool.selectedTopic.isNewResponse && !ForumTool.selectedTopic.locked}" />
+					<h:outputText  value=" | " rendered="#{ForumTool.selectedTopic.changeSettings && !ForumTool.selectedForum.forum.locked == 'true' && !ForumTool.selectedTopic.topic.locked == 'true'}" />
+					<sakai:tool_bar_item action="#{ForumTool.processActionTopicSettings}" id="topic_setting" value="#{msgs.cdfm_topic_settings}" 
+					rendered="#{ForumTool.selectedTopic.changeSettings}" /> 
+					<h:outputText   value="#{ForumTool.selectedTopic.topic.shortDescription}" rendered="#{ForumTool.selectedTopic.topic.shortDescription} != ''}"  styleClass="shortDescription" />
+					<h:outputLink id="forum_extended_show" value="#" title="#{msgs.cdfm_read_full_description}" styleClass="show" 
+							rendered="#{ForumTool.selectedTopic.topic.extendedDescription != '' && ForumTool.selectedTopic.topic.extendedDescription != null}"
+							onclick="resize();$(this).next('.hide').toggle(); $('div.toggle').slideToggle(resize);$(this).toggle();">
+						<h:graphicImage url="/images/collapse.gif" /><h:outputText value="#{msgs.cdfm_read_full_description}" />
+						<h:outputText value=" #{msgs.cdfm_read_full_description_andatts}"   rendered="#{!empty ForumTool.selectedTopic.attachList}" />
+					</h:outputLink>
+					<h:outputLink id="forum_extended_hide" value="#" title="#{msgs.cdfm_hide_full_description}" style="display:none" styleClass="hide" 
+							rendered="#{ForumTool.selectedTopic.topic.extendedDescription != '' && ForumTool.selectedTopic.topic.extendedDescription != null}"
+							onclick="resize();$(this).prev('.show').toggle(); $('div.toggle').slideToggle(resize);$(this).toggle();">
+						<h:graphicImage url="/images/expand.gif" /><h:outputText value="#{msgs.cdfm_hide_full_description}" />
+						<h:outputText value=" #{msgs.cdfm_read_full_description_andatts}"   rendered="#{!empty ForumTool.selectedTopic.attachList}" />
+					</h:outputLink>
+					<f:verbatim><div class="toggle" style="display:none;padding-left:1em"></f:verbatim>
+						<mf:htmlShowArea  id="forum_fullDescription" hideBorder="true"	 value="#{ForumTool.selectedTopic.topic.extendedDescription}"/> 
+						<h:dataTable styleClass="listHier" value="#{ForumTool.selectedTopic.attachList}" var="eachAttach" rendered="#{!empty ForumTool.selectedTopic.attachList}" cellpadding="3" cellspacing="0" columnClasses="attach,bogus" summary="layout" style="font-size:.9em;width:auto;margin-left:1em">
+							  <h:column>
+							  <%--//designNote: need to tie in the attachment type to actual  MIME type mapping tables instead of the below (which is prevalent everywhere) or at the very least provide a mechanism for defaults. --%> 
+								<h:graphicImage url="/images/attachment.gif" />
+								</h:column>
+								<h:column>
+								<h:outputLink value="#{eachAttach.url}" target="_blank">
+									<h:outputText value="#{eachAttach.attachment.attachmentName}" />
+								</h:outputLink>				  
+							</h:column>
+					  </h:dataTable>
+					<f:verbatim></div></f:verbatim>
 				</h:panelGroup>
-
-
-				<%-- Rendered to view current message only --%>
-				<h:panelGroup styleClass="inactive" rendered="#{message.deleted && (message.depth != 0 || message.childCount == 0)}" >
-					<f:verbatim><span></f:verbatim>
-						<h:outputText value="#{msgs.cdfm_msg_deleted_label}" />
-					<f:verbatim></span></f:verbatim>
-				</h:panelGroup>
-
-				<h:panelGroup rendered="#{!message.deleted}">	          	
-					<h:commandLink action="#{ForumTool.processActionDisplayMessage}" immediate="true" title=" #{message.message.title}"
-						rendered="#{message.depth != 0}" >
-					   	<h:outputText value="#{message.message.title}" rendered="#{message.read}" />
-    	    	    	<h:outputText styleClass="unreadMsg" value="#{message.message.title}" rendered="#{!message.read}"/>
-
-    	   	    		<f:param value="#{message.message.id}" name="messageId"/>
-       		    		<f:param value="#{ForumTool.selectedTopic.topic.id}" name="topicId"/>
-        		    	<f:param value="#{ForumTool.selectedTopic.topic.baseForum.id}" name="forumId"/>
-	          		</h:commandLink>
-
-		          	<h:outputText value="  " />
-				
-					<h:graphicImage value="/../../library/image/silk/email.png" rendered="#{!message.read}" style="cursor:pointer"
+			</h:panelGrid>	
+			<%--<%@include file="dfViewSearchBar.jsp"%> --%>
+			<%--//designNote: need a rendered attribute here that will toggle the display of the table (if messages) or a textblock (class="instruction") if there are no messages--%> 				
+			<h:outputText value="#{msgs.cdfm_no_messages}" rendered="#{empty ForumTool.selectedTopic.messages}"  styleClass="messageInformation" style=""/>
+			<mf:hierDataTable styleClass=" listHier  specialLink allMessages" id="messagesInHierDataTable" rendered="#{!empty ForumTool.selectedTopic.messages}"  value="#{ForumTool.messages}" var="message" expanded="#{ForumTool.expanded}"
+					columnClasses="attach,messageTitle,bogus,bogus" cellspacing="0" cellpadding="0" style="border:none">
+				<h:column id="_toggle">
+					<f:facet name="header">
+						<h:commandLink action="#{ForumTool.processActionToggleExpanded}" immediate="true" title="#{msgs.cdfm_collapse_expand_all}">
+							<h:graphicImage value="/images/collapse-expand.gif" style="vertical-align:middle" rendered="#{ForumTool.expanded == 'true'}" />
+							<h:graphicImage value="/images/expand-collapse.gif" style="vertical-align:middle" rendered="#{ForumTool.expanded != 'true'}" />
+						</h:commandLink>
+					</f:facet>
+				</h:column>
+				<h:column id="_msg_subject">
+					<f:facet name="header">
+						<h:outputText value="#{msgs.cdfm_thread}" />
+					</f:facet>
+					<h:outputText escape="false" value="<a id=\"#{message.message.id}\" name=\"#{message.message.id}\"></a>" />
+					<%-- display deleted message linked if any child messages (not deleted)
+						displays the message "this message has been deleted" if the message has been, um deleted, leaves reply children in place --%>
+					<h:panelGroup styleClass="inactive firstChild" rendered="#{message.deleted && message.depth == 0 && message.childCount > 0}">
+						<h:commandLink action="#{ForumTool.processActionDisplayThread}" immediate="true" title="#{msgs.cdfm_msg_deleted_label}" >
+							<h:outputText value="#{msgs.cdfm_msg_deleted_label}" />
+							<f:param value="#{message.message.id}" name="messageId"/>
+							<f:param value="#{ForumTool.selectedTopic.topic.id}" name="topicId"/>
+							<f:param value="#{ForumTool.selectedTopic.topic.baseForum.id}" name="forumId"/>
+						</h:commandLink>
+					</h:panelGroup>
+	
+					<h:panelGroup rendered="#{!message.deleted}" styleClass="firstChild">
+					<h:outputText styleClass="messageNew" value=" #{msgs.cdfm_newflag}" rendered="#{!message.read || message.childUnread > 0}"/>	
+					<%-- message has been submitted and is pending approval by moderator --%>
+						<h:outputText value="#{msgs.cdfm_msg_pending_label}" styleClass="messagePending" rendered="#{message.msgPending}" />
+						<%-- message has been submitted and has bene denied  approval by moderator --%>
+						<h:outputText value="#{msgs.cdfm_msg_denied_label}"  styleClass="messageDenied"  rendered="#{message.msgDenied}" />
+						<%-- Rendered to view current thread only --%>
+							<%--//designNote:  not sure what this controls - seems to affect all threads except the deleted, pending and denied--%>
+						<h:commandLink action="#{ForumTool.processActionDisplayThread}" immediate="true" title="#{message.message.title}"
+								rendered="#{message.depth == 0}">
+								<h:outputText escape="false" value="#{message.message.title}" rendered="#{message.read && message.childUnread == 0 }" />
+							
+								<h:outputText styleClass="unreadMsg" value="#{message.message.title}" rendered="#{!message.read || message.childUnread > 0}"/>
+							<f:param value="#{message.message.id}" name="messageId"/>
+							<f:param value="#{ForumTool.selectedTopic.topic.id}" name="topicId"/>
+							<f:param value="#{ForumTool.selectedTopic.topic.baseForum.id}" name="forumId"/>
+						</h:commandLink>
+					</h:panelGroup>
+	
+					<%-- Rendered to view current message only --%>
+					<%-- shows the message "This message has been deleted" if the message has been deleted --%>
+					<h:panelGroup styleClass="inactive firstChild" rendered="#{message.deleted && (message.depth != 0 || message.childCount == 0)}" >
+						<f:verbatim><span> </f:verbatim>
+							<h:outputText value="#{msgs.cdfm_msg_deleted_label}" />
+						<f:verbatim></span></f:verbatim>
+					</h:panelGroup>
+	
+					<%-- render the message that has not been deleted, what else? --%>
+					<h:panelGroup rendered="#{!message.deleted}">	          	
+						<h:commandLink action="#{ForumTool.processActionDisplayMessage}" immediate="true" title=" #{message.message.title}"
+								rendered="#{message.depth != 0}" >
+							<h:outputText value="#{message.message.title}" rendered="#{message.read}" />
+							<h:outputText styleClass="unreadMsg" value="#{message.message.title}" rendered="#{!message.read}"/>
+							<f:param value="#{message.message.id}" name="messageId"/>
+							<f:param value="#{ForumTool.selectedTopic.topic.id}" name="topicId"/>
+							<f:param value="#{ForumTool.selectedTopic.topic.baseForum.id}" name="forumId"/>
+						</h:commandLink>
+						<%-- //designNote: icon to mark as read, does it belong here? Is it the right icon? Is this functionality desired?--%>
+						<h:outputText value="  " />
+						<h:graphicImage value="/images/12-em-check.png" rendered="#{!message.read}" style="cursor:pointer"
 							alt="#{msgs.cdfm_mark_as_read}" title="#{msgs.cdfm_mark_as_read}"
-   							onclick="doAjax(#{message.message.id}, #{ForumTool.selectedTopic.topic.id}, this);"
-			   	       		onmouseover="this.src=this.src.replace(/email\.png/, 'email_open.png');"
-			   	       		onmouseout="this.src=this.src.replace(/email_open\.png/, 'email.png');" />
-				</h:panelGroup>
-               	
-   	       		<h:outputText escape="false" value="<br />&nbsp;" rendered="#{message.depth == 0}" />
-    	   		<h:outputText escape="false" styleClass="textPanelFooter" rendered="#{message.depth == 0 && message.childCount > 0 && message.read}"
-           	   			value="#{msgs.cdfm_openb} #{message.childCount + 1} #{msgs.cdfm_lowercase_msg} - #{message.childUnread} #{msgs.cdfm_unread} #{msgs.cdfm_closeb}" />
-           	   	<h:outputText escape="false" styleClass="textPanelFooter" rendered="#{message.depth == 0 && message.childCount > 0 && !message.read}"
-           	   			value="#{msgs.cdfm_openb} #{message.childCount + 1} #{msgs.cdfm_lowercase_msg} - #{message.childUnread +1} #{msgs.cdfm_unread} #{msgs.cdfm_closeb}" />		
-			</h:column>
-
-			<h:column>
-				<f:facet name="header">
-					<h:outputText value="#{msgs.cdfm_authoredby}" />
-				</f:facet>
-				<h:panelGroup rendered="#{!message.deleted}" >
-				 	<h:outputText value="#{message.message.author}" rendered="#{message.read && message.childUnread == 0}"/>
-    	        	<h:outputText styleClass="unreadMsg" value="#{message.message.author}" rendered="#{!message.read || message.childUnread > 0}"/>
-				</h:panelGroup>
-			</h:column>
-
-			<h:column>
-				<f:facet name="header">
-					<h:outputText value="#{msgs.cdfm_date}" />
-				</f:facet>
-				<h:panelGroup rendered="#{!message.deleted}" >
-				 	<h:outputText value="#{message.message.created}" rendered="#{message.read && message.childUnread == 0}">
-					 	<f:convertDateTime pattern="#{msgs.date_format}" />
-					</h:outputText>
-    	        	<h:outputText styleClass="unreadMsg" value="#{message.message.created}" rendered="#{!message.read || message.childUnread > 0}">
-					 	<f:convertDateTime pattern="#{msgs.date_format}" />
-				    </h:outputText>    	        	
-				</h:panelGroup>
-			</h:column>
-		</mf:hierDataTable>
-		
-		<h:inputHidden id="mainOrForumOrTopic" value="dfAllMessages" />
-		<%
-  String thisId = request.getParameter("panel");
-  if (thisId == null) 
-  {
-    thisId = "Main" + org.sakaiproject.tool.cover.ToolManager.getCurrentPlacement().getId();
-  }
-%>
+							onclick="doAjax(#{message.message.id}, #{ForumTool.selectedTopic.topic.id}, this);"/>
+					</h:panelGroup>
+					<%--  thread metadata (count) --%>
+					<%-- designNote: debug block --%>
+					<%--
+					<h:outputText value=" md: #{message.depth}" /> 
+					<h:outputText value=" cc: #{message.childCount }" />
+					<h:outputText value=" cu: #{message.childUnread }" />
+					<h:outputText value= " mr: #{message.read}" />
+					--%>
+					<h:outputText escape="false" styleClass="textPanelFooter" rendered="#{message.depth == 0 && message.childCount ==0}"  value="#{msgs.cdfm_openb} #{message.childCount + 1} #{msgs.cdfm_lowercase_msg} - #{message.childUnread} #{msgs.cdfm_unread} #{msgs.cdfm_closeb}" />
+					<h:outputText escape="false" styleClass="textPanelFooter" rendered="#{message.depth == 0 && message.childCount ==1}"  value="#{msgs.cdfm_openb} #{message.childCount + 1} #{msgs.cdfm_lowercase_msgs} - #{message.childUnread} #{msgs.cdfm_unread} #{msgs.cdfm_closeb}" />
+					<h:outputText  escape="false" styleClass="textPanelFooter" rendered="#{message.depth == 0 && message.childCount > 1}" value=" #{msgs.cdfm_openb} #{message.childCount + 1} #{msgs.cdfm_lowercase_msgs} - #{message.childUnread} #{msgs.cdfm_unread} #{msgs.cdfm_closeb}" />
+				</h:column>
+				<%-- author column --%>
+				<h:column>
+					<f:facet name="header">
+						<h:outputText value="#{msgs.cdfm_authoredby}" />
+					</f:facet>
+					<h:panelGroup rendered="#{!message.deleted}" >
+						<h:outputText value="#{message.message.author}"/>
+						<%--<h:outputText styleClass="unreadMsg" value="#{message.message.author}" rendered="#{!message.read || message.childUnread > 0}"/>--%>
+					</h:panelGroup>
+				</h:column>
+				<%-- date column --%>
+				<h:column>
+					<f:facet name="header">
+						<h:outputText value="#{msgs.cdfm_date}" />
+					</f:facet>
+					<h:panelGroup rendered="#{!message.deleted}" >
+						<h:outputText value="#{message.message.created}">
+							<f:convertDateTime pattern="#{msgs.date_format}" />
+						</h:outputText>
+						<%--
+						<h:outputText styleClass="unreadMsg" value="#{message.message.created}" rendered="#{!message.read || message.childUnread > 0}">
+							<f:convertDateTime pattern="#{msgs.date_format}" />
+						</h:outputText>
+						--%>
+					</h:panelGroup>
+				</h:column>
+			</mf:hierDataTable>
+	
+			<h:inputHidden id="mainOrForumOrTopic" value="dfAllMessages" />
+			<%
+			String thisId = request.getParameter("panel");
+			if (thisId == null) 
+			{
+			thisId = "Main" + org.sakaiproject.tool.cover.ToolManager.getCurrentPlacement().getId();
+			}
+			%>
 			<script type="text/javascript">
 			function resize(){
-  				mySetMainFrameHeight('<%= org.sakaiproject.util.Web.escapeJavascript(thisId)%>');
-  			}
+			mySetMainFrameHeight('<%= org.sakaiproject.util.Web.escapeJavascript(thisId)%>');
+			}
 			</script> 
-	</h:form>
-</sakai:view>
+		</h:form>
+	   <h:outputText value="#{msgs.cdfm_insufficient_privileges_view_topic}" rendered="#{ForumTool.selectedTopic.topic.draft && ForumTool.selectedTopic.topic.createdBy != ForumTool.userId}" />
+		
+	</sakai:view>
 </f:view>
Index: msgcntr/messageforums-app/src/webapp/jsp/discussionForum/message/dfFlatView.jsp
===================================================================
--- msgcntr/messageforums-app/src/webapp/jsp/discussionForum/message/dfFlatView.jsp	(revision 46869)
+++ msgcntr/messageforums-app/src/webapp/jsp/discussionForum/message/dfFlatView.jsp	(working copy)
@@ -12,11 +12,16 @@
 	// open print preview in another browser window so can size approx what actual
 	// print out will look like
 	function printFriendly(url) {
-		window.open(url,'mywindow','width=960,height=1100'); 		
-	}
+		newwindow=window.open(url,'mywindow','width=960,height=1100,scrollbars=yes,resizable=yes');
+		if (window.focus) {newwindow.focus()}
+}
 </script>
-	<h:form id="msgForum">
-<!--jsp/discussionForum/message/dfAllMessages.jsp-->
+	<h:form id="msgForum" styleClass="specialLink">
+		<style type="text/css">
+			@import url("/sakai-messageforums-tool/css/msgcntr.css");
+		</style>
+
+	<!--jsp/discussionForum/message/dfFlatView.jsp-->
   		<script type="text/javascript" src="/library/js/jquery.js"></script>
   		<sakai:script contextBase="/sakai-messageforums-tool" path="/js/sak-10625.js"/>
 		<sakai:script contextBase="/sakai-messageforums-tool" path="/js/forum.js"/>
@@ -26,9 +31,6 @@
 		  			rendered="#{ForumTool.selectedTopic.isNewResponse && !ForumTool.selectedTopic.locked}" />
 		  			
 		  		<h:commandLink action="#{ForumTool.processActionMarkAllAsRead}" rendered="#{ForumTool.selectedTopic.isMarkAsRead}"> 
-      				<h:graphicImage value="/../../library/image/silk/email.png" alt="#{msgs.msg_is_unread}" 
-				   	    onmouseover="this.src=this.src.replace(/email\.png/, 'email_open.png');"
-   	        			onmouseout="this.src=this.src.replace(/email_open\.png/, 'email.png');" />
    	        		<h:outputText value=" #{msgs.cdfm_mark_all_as_read}" />
                 </h:commandLink>
                 <%--
@@ -45,7 +47,6 @@
 					<h:graphicImage url="/../../library/image/silk/printer.png" alt="#{msgs.print_friendly}" title="#{msgs.print_friendly}" />
 				</h:outputLink>
  		</sakai:tool_bar>
-
 			<h:panelGrid columns="2" summary="layout" width="100%" styleClass="navPanel specialLink">
 			    <h:panelGroup>
 					<f:verbatim><div class="breadCrumb specialLink"><h3></f:verbatim>
@@ -79,8 +80,9 @@
 			</h:panelGrid>
 	
 		<%--rjlowe: Expanded View to show the message bodies, threaded --%>
+		<h:outputText   value="#{msgs.cdfm_no_messages}" rendered="#{empty ForumTool.messages}"   styleClass="messageInformation" />
 		<mf:hierDataTable id="expandedThreadedMessages" value="#{ForumTool.messages}" var="message" 
-   	 		noarrows="true" styleClass="listHier" cellpadding="0" cellspacing="0" width="100%" columnClasses="bogus">
+   	 		noarrows="true" styleClass="listHier messagesThreaded" cellpadding="0" cellspacing="0" width="100%" columnClasses="bogus">
 			<h:column id="_msg_subject">
 				<%@include file="dfViewThreadBodyInclude.jsp" %>
 			</h:column>
Index: msgcntr/messageforums-app/src/webapp/jsp/discussionForum/message/dfMsgAddComment.jsp
===================================================================
--- msgcntr/messageforums-app/src/webapp/jsp/discussionForum/message/dfMsgAddComment.jsp	(revision 46869)
+++ msgcntr/messageforums-app/src/webapp/jsp/discussionForum/message/dfMsgAddComment.jsp	(working copy)
@@ -2,88 +2,57 @@
 <%@ taglib uri="http://java.sun.com/jsf/core" prefix="f"%>
 <%@ taglib uri="http://sakaiproject.org/jsf/sakai" prefix="sakai"%>
 <%@ taglib uri="http://sakaiproject.org/jsf/messageforums" prefix="mf"%>
-<jsp:useBean id="msgs" class="org.sakaiproject.util.ResourceLoader"
-	scope="session">
-	<jsp:setProperty name="msgs" property="baseName"
-		value="org.sakaiproject.api.app.messagecenter.bundle.Messages" />
+<jsp:useBean id="msgs" class="org.sakaiproject.util.ResourceLoader" scope="session">
+	<jsp:setProperty name="msgs" property="baseName" value="org.sakaiproject.api.app.messagecenter.bundle.Messages" />
 </jsp:useBean>
 <f:view>
 
-	<sakai:view title="#{msgs.cdfm_add_comment}">
-	       		<script type="text/javascript" src="/library/js/jquery.js"></script>
-       		<sakai:script contextBase="/sakai-messageforums-tool" path="/js/sak-10625.js"/>
-		<h:form id="dfMsgAddComment">
+<sakai:view title="#{msgs.cdfm_add_comment}">
+	<script type="text/javascript" src="/library/js/jquery.js"></script>
+	<sakai:script contextBase="/sakai-messageforums-tool" path="/js/sak-10625.js"/>
+	<h:form id="dfMsgAddComment">
+			<style type="text/css">
+				@import url("/sakai-messageforums-tool/css/msgcntr.css");
+			</style>
 
-			<h3><h:outputText value="#{msgs.cdfm_add_comment}" /></h3>
-			<h4>
-				<h:outputText value="#{ForumTool.selectedForum.forum.title}" />
-				<h:outputText value=" #{msgs.cdfm_dash} " /> 
-				<h:outputText	value="#{ForumTool.selectedTopic.topic.title}" />
-			</h4>
-			
-			<h:messages globalOnly="true" infoClass="success" errorClass="alertMessage" />
-			  
-		  <div class="instruction">
-  	    <h:outputText value="#{msgs.cdfm_required}"/> <h:outputText value="#{msgs.pvt_star}" styleClass="reqStarInline" />
-		  </div>
-		
-		<f:verbatim><div class="hierItemBlock" style="padding-bottom:0"></f:verbatim>
-		<f:verbatim><h4 class="textPanelHeader" style="margin-bottom:0"></f:verbatim>
-			<h:panelGrid styleClass="itemSummary" columns="2" summary="layout">
-				<h:outputText value="#{msgs.cdfm_subject}" />
-				<h:outputText value="#{ForumTool.selectedMessage.message.title}" />
-
-				<h:outputText value="#{msgs.cdfm_authoredby}" />
-				<h:outputText	value="#{ForumTool.selectedMessage.message.author} #{msgs.cdfm_openb} #{ForumTool.selectedMessage.message.created} #{msgs.cdfm_closeb}" />
-
-				<h:panelGroup styleClass="header"	rendered="#{!empty ForumTool.selectedMessage.message.attachments}">
-					<h:outputText value="#{msgs.cdfm_att}" />
-				</h:panelGroup>
-				<h:panelGroup	rendered="#{!empty ForumTool.selectedMessage.attachList}">
-					<%-- Attachments --%>
-					<h:dataTable value="#{ForumTool.selectedMessage.attachList}"	var="eachAttach">
-						<h:column	rendered="#{!empty ForumTool.selectedMessage.message.attachments}">
-							<h:graphicImage url="/images/excel.gif"
-								rendered="#{eachAttach.attachment.attachmentType == 'application/vnd.ms-excel'}"
-								alt="" />
-							<h:graphicImage url="/images/html.gif"
-								rendered="#{eachAttach.attachment.attachmentType == 'text/html'}"	alt="" />
-							<h:graphicImage url="/images/pdf.gif"
-								rendered="#{eachAttach.attachment.attachmentType == 'application/pdf'}"	alt="" />
-							<h:graphicImage url="/sakai-messageforums-tool/images/ppt.gif"
-								rendered="#{eachAttach.attachment.attachmentType == 'application/vnd.ms-powerpoint'}"	alt="" />
-							<h:graphicImage url="/images/text.gif"
-								rendered="#{eachAttach.attachment.attachmentType == 'text/plain'}"	alt="" />
-							<h:graphicImage url="/images/word.gif"
-								rendered="#{eachAttach.attachment.attachmentType == 'application/msword'}"	alt="" />
-
-							<h:outputLink value="#{eachAttach.url}" target="_new_window">
-								<h:outputText value="#{eachAttach.attachment.attachmentName}" />
-							</h:outputLink>
-
-						</h:column>
-					</h:dataTable>
-				</h:panelGroup>
-			</h:panelGrid>
-		  
-			<f:verbatim></h4></f:verbatim>
-    		<f:verbatim><div style="width:100%;height:150px;overflow:auto;"></f:verbatim>
+		<h3><h:outputText value="#{msgs.cdfm_add_comment}" /></h3>
+		<h4>
+			<h:outputText value="#{ForumTool.selectedForum.forum.title}" />
+			<h:outputText value=" #{msgs.cdfm_dash} " /> 
+			<h:outputText	value="#{ForumTool.selectedTopic.topic.title}" />
+		</h4>
+	
+		<h:messages globalOnly="true" infoClass="success" errorClass="alertMessage" />
+	
+		<div class="singleMessage">
+			<h:outputText value="#{ForumTool.selectedMessage.message.title}"  styleClass="title"/>
+			<h:outputText	value="#{ForumTool.selectedMessage.message.author} #{msgs.cdfm_openb} #{ForumTool.selectedMessage.message.created} #{msgs.cdfm_closeb}" styleClass="textPanelFooter"/>
+			<%-- Attachments --%>
+			<h:dataTable value="#{ForumTool.selectedMessage.attachList}"	var="eachAttach"  cellpadding="3" cellspacing="0" columnClasses="attach,bogus" summary="layout"  style="font-size:.9em;width:auto;margin-left:1em" border="0"  rendered="#{!empty ForumTool.selectedMessage.attachList}">
+				<h:column	rendered="#{!empty ForumTool.selectedMessage.message.attachments}">
+					<h:graphicImage url="/images/attachment.gif"/>
+					<h:outputLink value="#{eachAttach.url}" target="_new_window">
+						<h:outputText value="#{eachAttach.attachment.attachmentName}" />
+					</h:outputLink>
+				</h:column>
+			</h:dataTable>
+			<f:verbatim><div style="width:100%;"></f:verbatim>
 				<h:outputText escape="false" value="#{ForumTool.selectedMessage.message.body}" />
 			<f:verbatim></div></f:verbatim>
-			
-		<f:verbatim></div></f:verbatim>
-		  
-			<div style="padding-top: 1.0em;">
-		  		<h:outputText value="#{msgs.cdfm_info_required_sign} " styleClass="reqStarInline"/><h:outputText value="#{msgs.cdfm_add_comment_label} " />	
-		  </div>
-		  
-		  <h:inputTextarea value="#{ForumTool.moderatorComments}" rows="5" cols="50" />	  
-		  
-		  <sakai:button_bar> 
-      	<sakai:button_bar_item action="#{ForumTool.processAddCommentToDeniedMsg}" value="#{msgs.cdfm_button_bar_add_comment}" accesskey="a"/>
-      	<sakai:button_bar_item action="#{ForumTool.processCancelAddComment}" value="#{msgs.cdfm_button_bar_cancel}" accesskey="c"/>
-    	</sakai:button_bar>
-
+		</div>	
+		<div class="instruction">
+			<h:outputText value="#{msgs.cdfm_required}"/> <h:outputText value="#{msgs.pvt_star}" styleClass="reqStarInline" />
+		</div>
+	
+		<div class="longtext">
+			<label for="dfMsgAddComment:commentsBox" class="block"><h:outputText value="#{msgs.cdfm_info_required_sign} " styleClass="reqStarInline"/><h:outputText value="#{msgs.cdfm_add_comment_label} " /></label>	
+			<h:inputTextarea value="#{ForumTool.moderatorComments}" rows="5" cols="50"  id="commentsBox"/>
+		</div>	
+		<sakai:button_bar> 
+		<sakai:button_bar_item action="#{ForumTool.processAddCommentToDeniedMsg}" value="#{msgs.cdfm_button_bar_add_comment}" accesskey="s" styleClass="active"/>
+			<sakai:button_bar_item action="#{ForumTool.processCancelAddComment}" value="#{msgs.cdfm_button_bar_cancel}" accesskey="x"/>
+		</sakai:button_bar>
+		
 		</h:form>
 	</sakai:view>
 </f:view>
Index: msgcntr/messageforums-app/src/webapp/jsp/discussionForum/message/dfViewThread.jsp
===================================================================
--- msgcntr/messageforums-app/src/webapp/jsp/discussionForum/message/dfViewThread.jsp	(revision 46869)
+++ msgcntr/messageforums-app/src/webapp/jsp/discussionForum/message/dfViewThread.jsp	(working copy)
@@ -12,13 +12,18 @@
 	// open print preview in another browser window so can size approx what actual
 	// print out will look like
 	function printFriendly(url) {
-		window.open(url,'mywindow','width=960,height=1100'); 		
+	newwindow=window.open(url,'mywindow','width=960,height=1100');
+	if (window.focus) {newwindow.focus()}
 	}
 </script>
 	<h:form id="msgForum">
-<!--jsp/discussionForum/message/dfAllMessages.jsp-->
-       		<script type="text/javascript" src="/library/js/jquery.js"></script>
-       		<sakai:script contextBase="/sakai-messageforums-tool" path="/js/sak-10625.js"/>
+		<style type="text/css">
+			@import url("/sakai-messageforums-tool/css/msgcntr.css");
+		</style>
+
+		<!--jsp/discussionForum/message/dfViewThread.jsp-->
+		<script type="text/javascript" src="/library/js/jquery.js"></script>
+		<sakai:script contextBase="/sakai-messageforums-tool" path="/js/sak-10625.js"/>
 		<sakai:script contextBase="/sakai-messageforums-tool" path="/js/forum.js"/>
 		
 		<sakai:tool_bar separator="#{msgs.cdfm_toolbar_separator}">
@@ -26,9 +31,6 @@
 		  			rendered="#{ForumTool.selectedTopic.isNewResponse && ForumTool.selectedThreadHead.msgApproved && !ForumTool.selectedTopic.locked}" />
 		  		
 		  		<h:commandLink action="#{ForumTool.processActionMarkAllThreadAsRead}" rendered="#{ForumTool.selectedTopic.isMarkAsRead}"> 
-      				<h:graphicImage value="/../../library/image/silk/email.png" alt="#{msgs.msg_is_unread}" 
-				   	    onmouseover="this.src=this.src.replace(/email\.png/, 'email_open.png');"
-   	        			onmouseout="this.src=this.src.replace(/email_open\.png/, 'email.png');" />
    	        		<h:outputText value=" #{msgs.cdfm_mark_all_as_read}" />
                 </h:commandLink>
                 <%--
@@ -40,9 +42,9 @@
 					<h:graphicImage url="/../../library/image/silk/printer.png" alt="#{msgs.print_friendly}" title="#{msgs.print_friendly}" />
 				</h:outputLink>
  		</sakai:tool_bar>
-			<h:panelGrid columns="2" summary="layout" width="100%" styleClass="navPanel specialLink">
+			<h:panelGrid columns="2" summary="layout" width="100%" styleClass="specialLink">
 			    <h:panelGroup>
-					<f:verbatim><div class="breadCrumb specialLink"><h3></f:verbatim>
+					<f:verbatim><div class="specialLink"><h3></f:verbatim>
 			      <h:commandLink action="#{ForumTool.processActionHome}" value="#{msgs.cdfm_message_forums}" title=" #{msgs.cdfm_message_forums}"
 			      		rendered="#{ForumTool.messagesandForums}" />
 			      <h:commandLink action="#{ForumTool.processActionHome}" value="#{msgs.cdfm_discussion_forums}" title=" #{msgs.cdfm_discussion_forums}"
@@ -83,7 +85,7 @@
 		
 		<%--rjlowe: Expanded View to show the message bodies, but not threaded --%>
 		<h:dataTable id="expandedMessages" value="#{ForumTool.selectedThread}" var="message" rendered="#{!ForumTool.threaded}"
-   	 		styleClass="listHier" cellpadding="0" cellspacing="0" width="100%" columnClasses="bogus">
+   	 		styleClass="listHier messagesFlat specialLink" cellpadding="0" cellspacing="0" width="100%" columnClasses="bogus">
 			<h:column>
 				<%@include file="dfViewThreadBodyInclude.jsp" %>
 			</h:column>
@@ -91,14 +93,14 @@
 		
 		<%--rjlowe: Expanded View to show the message bodies, threaded --%>
 		<mf:hierDataTable id="expandedThreadedMessages" value="#{ForumTool.selectedThread}" var="message" rendered="#{ForumTool.threaded}"
-   	 		noarrows="true" styleClass="listHier" cellpadding="0" cellspacing="0" width="100%" columnClasses="bogus">
+   	 		noarrows="true" styleClass="listHier messagesThreaded specialLink" cellpadding="0" cellspacing="0" width="100%" columnClasses="bogus">
 			<h:column id="_msg_subject">
 				<%@include file="dfViewThreadBodyInclude.jsp" %>
 			</h:column>
 		</mf:hierDataTable>
 				
 		<h:inputHidden id="mainOrForumOrTopic" value="dfViewThread" />
-
+		<%--//designNote:  need a message if no messages (as in when there are no unread ones)  --%>
 	<%
 	  	String thisId = request.getParameter("panel");
   		if (thisId == null) 
Index: msgcntr/messageforums-app/src/webapp/jsp/discussionForum/message/dfViewThreadBodyInclude.jsp
===================================================================
--- msgcntr/messageforums-app/src/webapp/jsp/discussionForum/message/dfViewThreadBodyInclude.jsp	(revision 46869)
+++ msgcntr/messageforums-app/src/webapp/jsp/discussionForum/message/dfViewThreadBodyInclude.jsp	(working copy)
@@ -1,143 +1,127 @@
 <%-- Display single message in threaded view. (included for each message). --%>
-
+<%-- designNote: what does read/unread mean in this context since I am seeing the whole message?--%>
 <h:outputText escape="false" value="<a id=\"#{message.message.id}\" name=\"#{message.message.id}\"></a>" />
 	<f:verbatim><div class="hierItemBlock"></f:verbatim>
-	<f:verbatim><h4 class="textPanelHeader"></f:verbatim>
-	<f:verbatim><div class="specialLink" style="width:65%;float:left;text-align:left"></f:verbatim>
-
-	<h:panelGroup styleClass="inactive" rendered="#{message.deleted}" >
-		<f:verbatim><span></f:verbatim>
-			<h:outputText value="#{msgs.cdfm_msg_deleted_label}" />
-		<f:verbatim></span></f:verbatim>
-	</h:panelGroup>
-
-	<h:panelGroup rendered="#{!message.deleted}">
-		<h:outputText value="#{msgs.cdfm_msg_pending_label} " styleClass="highlight" rendered="#{message.msgPending}" />
-		<h:outputText value="#{msgs.cdfm_msg_denied_label} " rendered="#{message.msgDenied}" />
-
-		<h:commandLink action="#{ForumTool.processActionDisplayMessage}"immediate="true" title=" #{message.message.title}">
-			<h:outputText value="#{message.message.title}" rendered="#{message.read}" />
-			<h:outputText styleClass="unreadMsg" value="#{message.message.title}" rendered="#{!message.read}" />
-
-			<f:param value="#{message.message.id}" name="messageId" />
-			<f:param value="#{ForumTool.selectedTopic.topic.id}" name="topicId" />
-			<f:param value="#{ForumTool.selectedTopic.topic.baseForum.id}" name="forumId" />
-		</h:commandLink>
-
-		<h:outputText value=" - #{message.message.author}" rendered="#{message.read}" />
-		<h:outputText styleClass="unreadMsg" value=" - #{message.message.author}" rendered="#{!message.read }" />
-
-		<h:outputText value="#{message.message.created}" rendered="#{message.read}">
-			<f:convertDateTime pattern="#{msgs.date_format_paren}" />
-		</h:outputText>
-		<h:outputText styleClass="unreadMsg" value="#{message.message.created}" rendered="#{!message.read}">
-			<f:convertDateTime pattern="#{msgs.date_format_paren}" />
-		</h:outputText>
-
-		<h:graphicImage value="/../../library/image/silk/email.png" 
-			alt="#{msgs.cdfm_mark_as_read}" 
-			title="#{msgs.cdfm_mark_as_read}" 
-			rendered="#{!message.read}"
-			style="cursor:pointer"
-			onclick="doAjax(#{message.message.id}, #{ForumTool.selectedTopic.topic.id}, this);"
-			onmouseover="this.src=this.src.replace(/email\.png/, 'email_open.png');"
-			onmouseout="this.src=this.src.replace(/email_open\.png/, 'email.png');" />
-	
-		<h:outputText value="<br />" escape="false" rendered="#{!empty message.attachList}" />
-		<h:panelGroup rendered="#{!empty message.attachList}">
-			<h:dataTable value="#{message.attachList}" var="eachAttach" styleClass="attachListJSF" rendered="#{!empty message.attachList}">
-				<h:column rendered="#{!empty message.message.attachments}">
-					<h:graphicImage url="/images/excel.gif" rendered="#{eachAttach.attachment.attachmentType == 'application/vnd.ms-excel'}" alt="" />
-					<h:graphicImage url="/images/html.gif" rendered="#{eachAttach.attachment.attachmentType == 'text/html'}" alt="" />
-					<h:graphicImage url="/images/pdf.gif" rendered="#{eachAttach.attachment.attachmentType == 'application/pdf'}" alt="" />
-					<h:graphicImage url="/sakai-messageforums-tool/images/ppt.gif" rendered="#{eachAttach.attachment.attachmentType == 'application/vnd.ms-powerpoint'}" alt="" />
-					<h:graphicImage url="/images/text.gif" 	rendered="#{eachAttach.attachment.attachmentType == 'text/plain'}" alt="" />
-					<h:graphicImage url="/images/word.gif" rendered="#{eachAttach.attachment.attachmentType == 'application/msword'}" alt="" />
-					<h:outputLink value="#{eachAttach.url}" target="_blank">
-						<h:outputText value="#{eachAttach.attachment.attachmentName}" />
+			<%-- a deleted message --%>
+			<h:panelGroup styleClass="inactive" rendered="#{message.deleted}" >
+				<f:verbatim><span></f:verbatim>
+					<h:outputText value="#{msgs.cdfm_msg_deleted_label}" />
+				<f:verbatim></span></f:verbatim>
+			</h:panelGroup>
+			<%-- non deleted messages --%>
+			<h:panelGroup rendered="#{!message.deleted}">
+				<h:outputText styleClass="messageNew" value=" #{msgs.cdfm_newflag}" rendered="#{!message.read}"/>
+				<%--pending  message flag --%>
+				<h:outputText value="#{msgs.cdfm_msg_pending_label}" rendered="#{message.msgPending}" styleClass="messagePending"/>
+				<%--denied  message flag --%>
+				<h:outputText value="#{msgs.cdfm_msg_denied_label}" rendered="#{message.msgDenied}" styleClass="messageDenied" />
+				<%--message subject line --%>
+				<h:commandLink action="#{ForumTool.processActionDisplayMessage}" immediate="true" title=" #{message.message.title}" styleClass="title">
+					<h:outputText value="#{message.message.title}" rendered="#{message.read}" />
+					<h:outputText styleClass="unreadMsg" value="#{message.message.title}" rendered="#{!message.read}" />
+					<f:param value="#{message.message.id}" name="messageId" />
+					<f:param value="#{ForumTool.selectedTopic.topic.id}" name="topicId" />
+					<f:param value="#{ForumTool.selectedTopic.topic.baseForum.id}" name="forumId" />
+				</h:commandLink>
+				<h:outputText value="<br />" escape="false" />
+				<%--author --%>
+				<h:outputText value="  #{message.message.author}" rendered="#{message.read}" styleClass="textPanelFooter"/>
+				<h:outputText  value="  #{message.message.author}" rendered="#{!message.read }" styleClass="unreadMsg textPanelFooter"/>
+				<%--date --%>
+				<h:outputText value="#{message.message.created}" rendered="#{message.read}" styleClass="textPanelFooter">
+					<f:convertDateTime pattern="#{msgs.date_format_paren}" />
+				</h:outputText>
+				<h:outputText  value="#{message.message.created}" rendered="#{!message.read}" styleClass="unreadMsg textPanelFooter">
+					<f:convertDateTime pattern="#{msgs.date_format_paren}" />
+				</h:outputText>
+				<%-- mark as read link --%>
+				<h:graphicImage value="/images/12-em-check.png"
+					alt="#{msgs.cdfm_mark_as_read}" 
+					title="#{msgs.cdfm_mark_as_read}" 
+					rendered="#{!message.read}"
+					style="cursor:pointer;margin-left:1em"
+					onclick="doAjax(#{message.message.id}, #{ForumTool.selectedTopic.topic.id}, this);"/>
+			</h:panelGroup>
+		<%-- reply and other actions panel --%>
+			<%-- If message actually deleted, don't display links --%>
+			<h:panelGroup rendered="#{!message.deleted}" styleClass="itemToolBar">
+				<%-- Reply link --%>
+				<h:panelGroup rendered="#{ForumTool.selectedTopic.isNewResponseToResponse && message.msgApproved && !ForumTool.selectedTopic.locked}">
+					<h:commandLink action="#{ForumTool.processDfMsgReplyMsgFromEntire}" title="#{msgs.cdfm_reply}"> 
+						<h:graphicImage value="/../../library/image/silk/email_go.png" alt="#{msgs.cdfm_button_bar_reply_to_msg}" />
+						<h:outputText value="#{msgs.cdfm_reply}" />
+						<f:param value="#{message.message.id}" name="messageId" />
+						<f:param value="#{ForumTool.selectedTopic.topic.id}" name="topicId" />
+						<f:param value="#{ForumTool.selectedForum.forum.id}" name="forumId" />
+					</h:commandLink>
+				</h:panelGroup>
+				<%-- (Hide) Other Actions links --%>
+				<h:panelGroup rendered="#{(ForumTool.selectedTopic.isPostToGradebook && ForumTool.gradebookExist) || ForumTool.selectedTopic.isModeratedAndHasPerm || message.revise 
+						|| message.userCanDelete}">
+						<h:outputText value=" #{msgs.cdfm_toolbar_separator} " rendered="#{ForumTool.selectedTopic.isNewResponseToResponse && message.msgApproved && !ForumTool.selectedTopic.locked}" />
+						<h:outputLink value="#" onclick="toggleDisplayInline('#{message.message.id}_advanced_box'); return false;">
+						<h:graphicImage value="/../../library/image/silk/cog.png" alt="#{msgs.cdfm_other_actions}" />
+						<h:outputText value="#{msgs.cdfm_other_actions}" />
 					</h:outputLink>
-				</h:column>
-			</h:dataTable>
-		</h:panelGroup>
-	
-		<f:verbatim></div></f:verbatim>
-		<f:verbatim><div style="width:30%;float:right;text-align:right"	class="specialLink"></f:verbatim>
-	</h:panelGroup>
-	
-	<%-- If message actually deleted, don't display links --%>
-	<h:panelGroup rendered="#{!message.deleted}" >
-
-		<%-- Reply link --%>
-		<h:panelGroup rendered="#{ForumTool.selectedTopic.isNewResponseToResponse && message.msgApproved && !ForumTool.selectedTopic.locked}">
-			<h:commandLink action="#{ForumTool.processDfMsgReplyMsgFromEntire}" title="#{msgs.cdfm_reply}"> 
-				<h:graphicImage value="/../../library/image/silk/email_go.png" alt="#{msgs.cdfm_button_bar_reply_to_msg}" />
-				<h:outputText value="#{msgs.cdfm_reply}" />
-
-				<f:param value="#{message.message.id}" name="messageId" />
-				<f:param value="#{ForumTool.selectedTopic.topic.id}" name="topicId" />
-				<f:param value="#{ForumTool.selectedForum.forum.id}" name="forumId" />
-			</h:commandLink>
-		</h:panelGroup>
-
-		<%-- (Hide) Other Actions links --%>
-		<h:panelGroup rendered="#{(ForumTool.selectedTopic.isPostToGradebook && ForumTool.gradebookExist) || ForumTool.selectedTopic.isModeratedAndHasPerm || message.revise 
-									|| message.userCanDelete}">
-			<h:outputText value=" #{msgs.cdfm_toolbar_separator} " rendered="#{ForumTool.selectedTopic.isNewResponseToResponse && message.msgApproved}" />
-			<h:outputLink value="#" onclick="toggleDisplay('#{message.message.id}_advanced_box'); toggleHide(this); return false;">
-				<h:graphicImage value="/../../library/image/silk/cog.png" alt="#{msgs.cdfm_other_actions}" />
-				<h:outputText value="#{msgs.cdfm_other_actions}" />
-			</h:outputLink>
-		</h:panelGroup>
-	</h:panelGroup>
-	
-	<h:outputText escape="false" value="<div id=\"#{message.message.id}_advanced_box\" style=\"display:none\">" />
-
-	<h:panelGroup rendered="#{ForumTool.selectedTopic.isPostToGradebook && ForumTool.gradebookExist}">
-		<h:commandLink action="#{ForumTool.processDfMsgGrdFromThread}" value="#{msgs.cdfm_button_bar_grade}">
-			<f:param value="#{message.message.id}" name="messageId" />
-			<f:param value="#{ForumTool.selectedTopic.topic.id}" name="topicId" />
-			<f:param value="#{ForumTool.selectedForum.forum.id}" name="forumId" />
-		</h:commandLink>
-		<h:outputText value=" #{msgs.cdfm_toolbar_separator} " />
-	</h:panelGroup>
-
-	<%-- Revise other action --%>
-	<h:panelGroup rendered="#{message.revise}">
-		<h:commandLink action="#{ForumTool.processDfMsgRvsFromThread}" value="#{msgs.cdfm_button_bar_revise}">
-			<f:param value="#{message.message.id}" name="messageId" />
-			<f:param value="#{ForumTool.selectedTopic.topic.id}" name="topicId" />
-			<f:param value="#{ForumTool.selectedTopic.topic.baseForum.id}" name="forumId" />
-		</h:commandLink>
-		<h:outputText value=" #{msgs.cdfm_toolbar_separator} " />
-	</h:panelGroup>
-
-	<%-- Delete other action --%>
-	<h:panelGroup rendered="#{message.userCanDelete}" >
-		<h:commandLink action="#{ForumTool.processDfMsgDeleteConfirm}" value="#{msgs.cdfm_button_bar_delete}">
-			<f:param value="#{message.message.id}" name="messageId" />
-			<f:param value="#{ForumTool.selectedTopic.topic.id}" name="topicId" />
-			<f:param value="#{ForumTool.selectedTopic.topic.baseForum.id}" name="forumId" />
-			<f:param value="dfViewThread" name="fromPage" />
-		</h:commandLink>
-		<h:outputText value=" #{msgs.cdfm_toolbar_separator} " rendered="#{ForumTool.selectedTopic.isModeratedAndHasPerm}" />
-	</h:panelGroup>
-
-	<%-- Moderate other action --%>
-	<h:panelGroup rendered="#{ForumTool.selectedTopic.isModeratedAndHasPerm}">
-		<h:commandLink action="#{ForumTool.processActionDisplayMessage}" immediate="true" title=" #{msgs.cdfm_moderate}">
-			<h:outputText value="#{msgs.cdfm_moderate}" />
-			<f:param value="#{message.message.id}" name="messageId" />
-			<f:param value="#{ForumTool.selectedTopic.topic.id}" name="topicId" />
-			<f:param value="#{ForumTool.selectedTopic.topic.baseForum.id}" name="forumId" />
-		</h:commandLink>
-	</h:panelGroup>
-
-	<h:outputText escape="false" value="</div>" />
-	<f:verbatim></div></f:verbatim>
-
-	<f:verbatim><div style="clear:both;height:.1em;width:100%;"></div></f:verbatim>
-	<f:verbatim></h4></f:verbatim>
-
+				</h:panelGroup>
+				<%--//designNote: panel holds other actions, display toggled above (do some testing - do they show up when they should not? Do I get a 
+						"moderate" link when it is not a moderated context, or when the message is mine?) --%>
+				<h:outputText escape="false" value="<span id=\"#{message.message.id}_advanced_box\" class=\"otherActions\" style=\"display:none\">" />
+					<%-- link to grade --%>
+					<h:panelGroup rendered="#{ForumTool.selectedTopic.isPostToGradebook && ForumTool.gradebookExist}">
+						<h:commandLink action="#{ForumTool.processDfMsgGrdFromThread}" value="#{msgs.cdfm_button_bar_grade}">
+							<f:param value="#{message.message.id}" name="messageId" />
+							<f:param value="#{ForumTool.selectedTopic.topic.id}" name="topicId" />
+							<f:param value="#{ForumTool.selectedForum.forum.id}" name="forumId" />
+						</h:commandLink>
+						<h:outputText value=" #{msgs.cdfm_toolbar_separator} " />
+					</h:panelGroup>
+					<%-- Revise other action --%>
+					<h:panelGroup rendered="#{message.revise}">
+						<h:commandLink action="#{ForumTool.processDfMsgRvsFromThread}" value="#{msgs.cdfm_button_bar_revise}">
+							<f:param value="#{message.message.id}" name="messageId" />
+							<f:param value="#{ForumTool.selectedTopic.topic.id}" name="topicId" />
+							<f:param value="#{ForumTool.selectedTopic.topic.baseForum.id}" name="forumId" />
+						</h:commandLink>
+						<h:outputText value=" #{msgs.cdfm_toolbar_separator} " />
+					</h:panelGroup>
+					<%-- Delete other action --%>
+					<h:panelGroup rendered="#{message.userCanDelete}" >
+						<h:commandLink action="#{ForumTool.processDfMsgDeleteConfirm}" value="#{msgs.cdfm_button_bar_delete}">
+							<f:param value="#{message.message.id}" name="messageId" />
+							<f:param value="#{ForumTool.selectedTopic.topic.id}" name="topicId" />
+							<f:param value="#{ForumTool.selectedTopic.topic.baseForum.id}" name="forumId" />
+							<f:param value="dfViewThread" name="fromPage" />
+						</h:commandLink>
+						<h:outputText value=" #{msgs.cdfm_toolbar_separator} " rendered="#{ForumTool.selectedTopic.isModeratedAndHasPerm}" />
+					</h:panelGroup>
+					<%-- Moderate other action --%>
+					<h:panelGroup rendered="#{ForumTool.selectedTopic.isModeratedAndHasPerm}">
+						<h:commandLink action="#{ForumTool.processActionDisplayMessage}" immediate="true" title=" #{msgs.cdfm_moderate}">
+							<h:outputText value="#{msgs.cdfm_moderate}" />
+							<f:param value="#{message.message.id}" name="messageId" />
+							<f:param value="#{ForumTool.selectedTopic.topic.id}" name="topicId" />
+							<f:param value="#{ForumTool.selectedTopic.topic.baseForum.id}" name="forumId" />
+						</h:commandLink>
+					</h:panelGroup>
+			</h:panelGroup>
+			<!-- close the div with class of specialLink -->
+			<f:verbatim></span></f:verbatim>
+		<%-- a float clearer --%>
+		<f:verbatim><div style="clear:both;height:1px;width:100%;" class="titleBarBorder"></div></f:verbatim>
+	<%-- the message body--%>
 	<mf:htmlShowArea value="#{message.message.body}" hideBorder="true" rendered="#{!message.deleted}" />
-
-	<f:verbatim></div></f:verbatim>
\ No newline at end of file
+	<%-- attach list --%>	
+	<h:panelGroup rendered="#{!empty message.attachList && !message.deleted}">
+		<h:dataTable value="#{message.attachList}" var="eachAttach" styleClass="attachListJSF" rendered="#{!empty message.attachList}" style="font-size:.9em;width:auto;margin-left:1em">
+			<h:column rendered="#{!empty message.message.attachments}">
+				<h:graphicImage url="/images/attachment.gif"  />
+				<h:outputLink value="#{eachAttach.url}" target="_blank">
+					<h:outputText value=" " />
+					<h:outputText value="#{eachAttach.attachment.attachmentName}" />
+				</h:outputLink>
+			</h:column>
+		</h:dataTable>
+	</h:panelGroup>
+	<%-- close the div with class of hierItemBlock --%>
+<f:verbatim></div></f:verbatim>
\ No newline at end of file
Index: msgcntr/messageforums-app/src/webapp/jsp/discussionForum/message/printFriendlyThread.jsp
===================================================================
--- msgcntr/messageforums-app/src/webapp/jsp/discussionForum/message/printFriendlyThread.jsp	(revision 46869)
+++ msgcntr/messageforums-app/src/webapp/jsp/discussionForum/message/printFriendlyThread.jsp	(working copy)
@@ -9,76 +9,58 @@
 <f:view>
 <sakai:view>
 	<h:form id="msgForum">
+		<style type="text/css">
+			@import url("/sakai-messageforums-tool/css/msgcntr.css");
+		</style>
+
 <!--jsp/discussionForum/message/printFriendlyThread.jsp-->
 		
-			<div>
+			<div class="navIntraTool">
 				<a id="printIcon" href="" onClick="javascript:window.print();">
 					<h:graphicImage url="/../../library/image/silk/printer.png" alt="#{msgs.print_friendly}" title="#{msgs.print_friendly}" />
 					<h:outputText value="#{msgs.send_to_printer}" />
 				</a>
-				<h:outputText value=" " /><h:outputText value="|" /><h:outputText value=" " />
 				<a value="" href="" onClick="window.close();" >
 					<h:outputText value="#{msgs.close_window}" />
 				</a>
 			</div>
-		
-			    <h:panelGroup>
-					<f:verbatim><div class="breadCrumb specialLink"><h3></f:verbatim>
-			      <h:outputText value="#{msgs.cdfm_discussion_forums}" />
-      			  <f:verbatim><h:outputText value=" " /><h:outputText value=" / " /><h:outputText value=" " /></f:verbatim>
-				  <h:outputText value="#{ForumTool.selectedForum.forum.title}" />
-				  <f:verbatim><h:outputText value=" " /><h:outputText value=" / " /><h:outputText value=" " /></f:verbatim>
-				  	  <h:outputText value="#{ForumTool.selectedTopic.topic.title}" />
-			  	  <f:verbatim><h:outputText value=" " /><h:outputText value=" / " /><h:outputText value=" " /></f:verbatim>
-				  	  <h:outputText value="#{ForumTool.selectedThreadHead.message.title}" />
-				  <f:verbatim></h3></div></f:verbatim>
-				 </h:panelGroup>
-		
+			<div class="printBlock">
+				<h2>
+					<h:outputText value="#{msgs.cdfm_discussion_forums}" />
+					<h:outputText value=" " /><h:outputText value=" / " /><h:outputText value=" " />
+					<h:outputText value="#{ForumTool.selectedForum.forum.title}" />
+					<h:outputText value=" " /><h:outputText value=" / " /><h:outputText value=" " />
+					<h:outputText value="#{ForumTool.selectedTopic.topic.title}" />
+					<h:outputText value=" " /><h:outputText value=" / " /><h:outputText value=" " />
+					<h:outputText value="#{ForumTool.selectedThreadHead.message.title}" />
+				</h2>	
 	
-		<%--rjlowe: Expanded View to show the message bodies, but not threaded --%>
-		<h:dataTable id="expandedMessages" value="#{ForumTool.PFSelectedThread}" var="message" rendered="#{!ForumTool.threaded}"
-   	 		styleClass="listHier" cellpadding="0" cellspacing="0" width="100%" columnClasses="bogus">
-			<h:column>
-				<f:verbatim><div class="hierItemBlock"></f:verbatim>
-
-					<f:verbatim><h4 class="textPanelHeader specialLink" style="width:100%"></f:verbatim>
-                                                  
-                        <h:outputText value="#{message.message.title}" />		          	
-			          	<h:outputText value=" - #{message.message.author}"/>
-   
-                        <h:outputText value="#{message.message.created}">
-  				   	         <f:convertDateTime pattern="#{msgs.date_format_paren}" />
-            			</h:outputText>
-
-                     <f:verbatim></h4></f:verbatim>
-
-		  			<mf:htmlShowArea value="#{message.message.body}" hideBorder="true" />
-				<f:verbatim></div></f:verbatim>
-			</h:column>
-		</h:dataTable>
-		
-		<%--rjlowe: Expanded View to show the message bodies, threaded --%>
-		<mf:hierDataTable id="expandedThreadedMessages" value="#{ForumTool.PFSelectedThread}" var="message" rendered="#{ForumTool.threaded}"
-   	 		noarrows="true" styleClass="listHier" cellpadding="0" cellspacing="0" width="100%" columnClasses="bogus">
-			<h:column id="_msg_subject">
-				<f:verbatim><div class="hierItemBlock"></f:verbatim>
-
-					<f:verbatim><h4 class="textPanelHeader specialLink" style="width:100%"></f:verbatim>
-                                                  
-                        <h:outputText value="#{message.message.title}" />		          	
-			          	<h:outputText value=" - #{message.message.author}"/>
-   
-                        <h:outputText value="#{message.message.created}">
-  				   	         <f:convertDateTime pattern="#{msgs.date_format_paren}" />
-            			</h:outputText>
-
-                     <f:verbatim></h4></f:verbatim>
-
-		  			<mf:htmlShowArea value="#{message.message.body}" hideBorder="true" />
-				<f:verbatim></div></f:verbatim>
-			</h:column>
-		</mf:hierDataTable>
-	
-	</h:form>
-</sakai:view>
+				<%--rjlowe: Expanded View to show the message bodies, but not threaded --%>
+				<h:dataTable id="expandedMessages" value="#{ForumTool.PFSelectedThread}" var="message" rendered="#{!ForumTool.threaded}"
+				styleClass="listHier printTable" cellpadding="0" cellspacing="0" width="100%" columnClasses="bogus">
+					<h:column>
+						<h:outputText value="#{message.message.title}" styleClass="title" />		          	
+						<h:outputText value=" - #{message.message.author}"/>
+						<h:outputText value="#{message.message.created}">
+							<f:convertDateTime pattern="#{msgs.date_format_paren}" />
+						</h:outputText>
+						<mf:htmlShowArea value="#{message.message.body}" hideBorder="false" />
+					</h:column>
+				</h:dataTable>
+					
+				<%--rjlowe: Expanded View to show the message bodies, threaded --%>
+				<mf:hierDataTable id="expandedThreadedMessages" value="#{ForumTool.PFSelectedThread}" var="message" rendered="#{ForumTool.threaded}"
+						noarrows="true" styleClass="listHier printTable" cellpadding="0" cellspacing="0" width="100%" columnClasses="bogus">
+					<h:column id="_msg_subject">
+						<h:outputText value="#{message.message.title}" styleClass="title"/>		          	
+						<h:outputText value=" - #{message.message.author}"/>
+						<h:outputText value="#{message.message.created}">
+							<f:convertDateTime pattern="#{msgs.date_format_paren}" />
+						</h:outputText>
+						<mf:htmlShowArea value="#{message.message.body}" hideBorder="false" />
+					</h:column>
+				</mf:hierDataTable>
+			</div>	
+		</h:form>
+	</sakai:view>
 </f:view>
\ No newline at end of file
Index: msgcntr/messageforums-app/src/webapp/jsp/discussionForum/message/dfMsgGrade.jsp
===================================================================
--- msgcntr/messageforums-app/src/webapp/jsp/discussionForum/message/dfMsgGrade.jsp	(revision 46869)
+++ msgcntr/messageforums-app/src/webapp/jsp/discussionForum/message/dfMsgGrade.jsp	(working copy)
@@ -3,131 +3,98 @@
 <%@ taglib uri="http://sakaiproject.org/jsf/sakai" prefix="sakai" %>
 <%@ taglib uri="http://sakaiproject.org/jsf/messageforums" prefix="mf" %>
 <jsp:useBean id="msgs" class="org.sakaiproject.util.ResourceLoader" scope="session">
-   <jsp:setProperty name="msgs" property="baseName" value="org.sakaiproject.api.app.messagecenter.bundle.Messages"/>
+	<jsp:setProperty name="msgs" property="baseName" value="org.sakaiproject.api.app.messagecenter.bundle.Messages"/>
 </jsp:useBean>
 
 <f:view>
-<sakai:view>
-       		<script type="text/javascript" src="/library/js/jquery.js"></script>
-       		<sakai:script contextBase="/sakai-messageforums-tool" path="/js/sak-10625.js"/>
-  <h:form id="msgForum">
-<!--jsp\discussionForum\message\dfMsgGrade.jsp-->
-
-      <h3><h:outputText value="#{msgs.cdfm_grade_msg}" /></h3>
+	<sakai:view>
+		<script type="text/javascript" src="/library/js/jquery.js"></script>
+		<sakai:script contextBase="/sakai-messageforums-tool" path="/js/sak-10625.js"/>
+		<h:form id="msgForum">
+			<style type="text/css">
+			@import url("/sakai-messageforums-tool/css/msgcntr.css");
+			</style>
+			<!--jsp\discussionForum\message\dfMsgGrade.jsp-->
+			<h3><h:outputText value="#{msgs.cdfm_grade_msg}" /></h3>
 			<h4>
 				<h:outputText value="#{ForumTool.selectedForum.forum.title}" />
 				<h:outputText value=" #{msgs.cdfm_dash} " /> 
 				<h:outputText	value="#{ForumTool.selectedTopic.topic.title}" />
 			</h4>
-			
 			<h:messages globalOnly="true" infoClass="success" errorClass="alertMessage" />
-			  
-		  <div class="instruction">
-  	    <h:outputText value="#{msgs.cdfm_required}"rendered="#{ForumTool.allowedToGradeItem}"/> 
-  	    <h:outputText value="#{msgs.pvt_star}" styleClass="reqStarInline" rendered="#{ForumTool.allowedToGradeItem}" />
-		  </div>
-   
-    <h:panelGrid styleClass="jsfFormTable" columns="2">
-    	<h:panelGroup styleClass="shorttext required">
-				<h:outputText value="#{msgs.cdfm_info_required_sign}" styleClass="reqStar" rendered="#{ForumTool.allowedToGradeItem}"/> 
-        <h:outputLabel for="assignment" value="#{msgs.cdfm_assignments}"/>
-      </h:panelGroup>
-      <h:panelGroup styleClass="shorttext">
-        <h:selectOneMenu id="assignment" value="#{ForumTool.selectedAssign}" valueChangeListener="#{ForumTool.processGradeAssignChange}"
-              onchange="document.forms[0].submit();">
-           <f:selectItems value="#{ForumTool.assignments}" />
-         </h:selectOneMenu>
-         <h:outputFormat value=" #{msgs.cdfm_points_possible}" rendered="#{!ForumTool.selGBItemRestricted && ForumTool.gbItemPointsPossible != null}">
-						<f:param value="#{ForumTool.gbItemPointsPossible}"/>
-					</h:outputFormat>
-      </h:panelGroup>
-      
-      <h:outputText value="" rendered="#{ForumTool.selGBItemRestricted && !ForumTool.noItemSelected}" />
-      <h:outputText value="#{msgs.cdfm_no_gb_perm}" rendered="#{ForumTool.selGBItemRestricted && !ForumTool.noItemSelected}" 
-      		styleClass="alertMessage"/>
-     
-      <h:panelGroup styleClass="shorttext required" rendered="#{!ForumTool.selGBItemRestricted}">
-				<h:outputText value="#{msgs.cdfm_info_required_sign}" styleClass="reqStar" rendered="#{ForumTool.allowedToGradeItem}"/>  
-        <h:outputLabel for="dfMsgGradeGradePoint" value="#{msgs.cdfm_grade_points}"/>
-      </h:panelGroup>
-      
-      <h:panelGroup styleClass="shorttext" rendered="#{!ForumTool.selGBItemRestricted}">
-	    	<h:panelGroup rendered="#{ForumTool.allowedToGradeItem}">
-	    		<h:inputText value="#{ForumTool.gradePoint}" id="dfMsgGradeGradePoint" size="5" rendered="#{ForumTool.allowedToGradeItem}" />
-	    		<h:message for="dfMsgGradeGradePoint" styleClass="alertMessage" />
-	      </h:panelGroup>
-	      
-	      <h:panelGroup rendered="#{!ForumTool.allowedToGradeItem}" >
-	        <h:outputText value="#{ForumTool.gradePoint}" rendered="#{ForumTool.gradePoint != null}" />
-	        <h:outputText value="#{msgs.cdfm_null_points}" rendered="#{ForumTool.gradePoint == null}" />
-				</h:panelGroup>
-      </h:panelGroup>
 
-       <h:outputLabel styleClass="shorttext required" for="comments" value="#{msgs.cdfm_comments}" 
-       		style="display:block" rendered="#{!ForumTool.selGBItemRestricted}"/>
-       <h:inputTextarea id="comments" value="#{ForumTool.gradeComment}" rows="5" cols="50"
-       		rendered="#{!ForumTool.selGBItemRestricted}" readonly="#{!ForumTool.allowedToGradeItem}"/>
+			<div class="singleMessage">
+				<h:outputText value="#{ForumTool.selectedMessage.message.title}" styleClass="title"/>
+				<h:outputText value="#{ForumTool.selectedMessage.message.author}" />
+				<h:outputText value=" #{msgs.cdfm_openb} " />
+				<h:outputText value="#{ForumTool.selectedMessage.message.created}" >
+					<f:convertDateTime pattern="#{msgs.date_format}" />  
+				</h:outputText>
+				<h:outputText value=" #{msgs.cdfm_closeb}" />
+				<%-- Attachments --%>
+				<h:dataTable value="#{ForumTool.selectedMessage.attachList}"	var="eachAttach" rendered="#{!empty ForumTool.selectedMessage.attachList}">
+					<h:column	rendered="#{!empty ForumTool.selectedMessage.message.attachments}">
+						<h:graphicImage url="/images/attachment.gif" />
+						<h:outputLink value="#{eachAttach.url}" target="_new_window">
+							<h:outputText value="#{eachAttach.attachment.attachmentName}" />
+						</h:outputLink>
+					</h:column>
+				</h:dataTable>
+				<h:outputText escape="false" value="#{ForumTool.selectedMessage.message.body}"  style="display:block;margin-top:2em" styleClass="textPanel"/>
+			</div>	
 
-    </h:panelGrid>
 
-    <sakai:button_bar>
-      <sakai:button_bar_item action="#{ForumTool.processDfGradeSubmit}" value="#{msgs.cdfm_submit_grade}" 
-      		accesskey="s" styleClass="active" disabled="#{!ForumTool.allowedToGradeItem}"/>
-      <sakai:button_bar_item action="#{ForumTool.processDfGradeCancel}" value="#{msgs.cdfm_cancel}" accesskey="x" />
-    </sakai:button_bar>
-    
-    		<f:verbatim><div class="hierItemBlock" style="padding-bottom:0"></f:verbatim>
-		<f:verbatim><h4 class="textPanelHeader" style="margin-bottom:0"></f:verbatim>
-			<h:panelGrid styleClass="itemSummary" columns="2" summary="layout">
-				<h:outputText value="#{msgs.cdfm_subject}" />
-				<h:outputText value="#{ForumTool.selectedMessage.message.title}" />
-
-				<h:outputText value="#{msgs.cdfm_authoredby}" />
+			
+			<p class="instruction" style="margin-top:1em">
+				<h:outputText value="#{msgs.cdfm_required}"rendered="#{ForumTool.allowedToGradeItem}"/> 
+				<h:outputText value="#{msgs.pvt_star}" styleClass="reqStarInline" rendered="#{ForumTool.allowedToGradeItem}" />
+			</p>
+   
+			<h:panelGrid styleClass="jsfFormTable" columns="1" columnClasses="shorttext" border="0">
 				<h:panelGroup>
-	      	<h:outputText value="#{ForumTool.selectedMessage.message.author}" />
-	      	<h:outputText value=" #{msgs.cdfm_openb} " />
-	      	<h:outputText value="#{ForumTool.selectedMessage.message.created}" >
-         	 <f:convertDateTime pattern="#{msgs.date_format}" />  
-       	 </h:outputText>
-       	 <h:outputText value=" #{msgs.cdfm_closeb}" />
-	    	</h:panelGroup>
-				<h:panelGroup styleClass="header"	rendered="#{!empty ForumTool.selectedMessage.message.attachments}">
-					<h:outputText value="#{msgs.cdfm_att}" />
+					<h:outputLabel for="assignment"  style="padding-bottom:.3em;display:block;clear:both;float:none;white-space:nowrap"  rendered="#{ForumTool.allowedToGradeItem}">
+						<h:outputText value="#{msgs.cdfm_info_required_sign}" styleClass="reqStarInline" style="padding-right:3px"/>
+						<h:outputText  value="#{msgs.cdfm_assignments}"/>
+					</h:outputLabel>	
+					<h:selectOneMenu id="assignment" value="#{ForumTool.selectedAssign}" valueChangeListener="#{ForumTool.processGradeAssignChange}"
+							onchange="document.forms[0].submit();">
+						<f:selectItems value="#{ForumTool.assignments}" />
+					</h:selectOneMenu>
+					<h:outputFormat value=" #{msgs.cdfm_points_possible}" rendered="#{!ForumTool.selGBItemRestricted && ForumTool.gbItemPointsPossible != null}">
+						<f:param value="#{ForumTool.gbItemPointsPossible}"/>
+					</h:outputFormat>
 				</h:panelGroup>
-				<h:panelGroup	rendered="#{!empty ForumTool.selectedMessage.attachList}">
-					<%-- Attachments --%>
-					<h:dataTable value="#{ForumTool.selectedMessage.attachList}"	var="eachAttach">
-						<h:column	rendered="#{!empty ForumTool.selectedMessage.message.attachments}">
-							<h:graphicImage url="/images/excel.gif"
-								rendered="#{eachAttach.attachment.attachmentType == 'application/vnd.ms-excel'}"
-								alt="" />
-							<h:graphicImage url="/images/html.gif"
-								rendered="#{eachAttach.attachment.attachmentType == 'text/html'}"	alt="" />
-							<h:graphicImage url="/images/pdf.gif"
-								rendered="#{eachAttach.attachment.attachmentType == 'application/pdf'}"	alt="" />
-							<h:graphicImage url="/sakai-messageforums-tool/images/ppt.gif"
-								rendered="#{eachAttach.attachment.attachmentType == 'application/vnd.ms-powerpoint'}"	alt="" />
-							<h:graphicImage url="/images/text.gif"
-								rendered="#{eachAttach.attachment.attachmentType == 'text/plain'}"	alt="" />
-							<h:graphicImage url="/images/word.gif"
-								rendered="#{eachAttach.attachment.attachmentType == 'application/msword'}"	alt="" />
-
-							<h:outputLink value="#{eachAttach.url}" target="_new_window">
-								<h:outputText value="#{eachAttach.attachment.attachmentName}" />
-							</h:outputLink>
-
-						</h:column>
-					</h:dataTable>
+				<h:outputText value="" rendered="#{ForumTool.selGBItemRestricted && !ForumTool.noItemSelected}" />
+				<h:outputText value="#{msgs.cdfm_no_gb_perm}" rendered="#{ForumTool.selGBItemRestricted && !ForumTool.noItemSelected}" 
+						styleClass="alertMessage"/>
+				<h:panelGroup  rendered="#{!ForumTool.selGBItemRestricted}">
+					<h:outputLabel for="dfMsgGradeGradePoint" rendered="#{ForumTool.allowedToGradeItem}"  style="padding-bottom:.3em;display:block;clear:both;float:none;white-space:nowrap">
+						<h:outputText value="#{msgs.cdfm_info_required_sign}" styleClass="reqStarInline"  style="padding-right:3px" />
+						<h:outputText  value="#{msgs.cdfm_grade_points}" />
+					</h:outputLabel>	
+					<h:panelGroup >
+						<h:inputText value="#{ForumTool.gradePoint}" id="dfMsgGradeGradePoint" size="5" rendered="#{ForumTool.allowedToGradeItem}" />
+						<h:message for="dfMsgGradeGradePoint" styleClass="alertMessage"  rendered="#{ForumTool.allowedToGradeItem}"/>
+					</h:panelGroup>
+  
+					<h:panelGroup rendered="#{!ForumTool.allowedToGradeItem}" >
+						<h:outputText value="#{ForumTool.gradePoint}" rendered="#{ForumTool.gradePoint != null}" />
+						<h:outputText value="#{msgs.cdfm_null_points}" rendered="#{ForumTool.gradePoint == null}" />
+					</h:panelGroup>
 				</h:panelGroup>
+				<h:panelGroup>
+					<h:outputLabel  for="comments" value="#{msgs.cdfm_comments}" 
+							  style="padding-bottom:.3em;display:block;clear:both;float:none;white-space:nowrap"  rendered="#{!ForumTool.selGBItemRestricted}"/>
+					<h:inputTextarea id="comments" value="#{ForumTool.gradeComment}" rows="5" cols="50"
+							rendered="#{!ForumTool.selGBItemRestricted}" readonly="#{!ForumTool.allowedToGradeItem}"/>
+				</h:panelGroup>	
 			</h:panelGrid>
-		  
-			<f:verbatim></h4></f:verbatim>
-    		<f:verbatim><div style="width:100%;height:150px;overflow:auto;"></f:verbatim>
-				<h:outputText escape="false" value="#{ForumTool.selectedMessage.message.body}" />
-			<f:verbatim></div></f:verbatim>
-			
-		<f:verbatim></div></f:verbatim>
 
-  </h:form>
-</sakai:view>
+			<sakai:button_bar>
+				<sakai:button_bar_item action="#{ForumTool.processDfGradeSubmit}" value="#{msgs.cdfm_submit_grade}" 
+				accesskey="s" styleClass="active" disabled="#{!ForumTool.allowedToGradeItem}"/>
+				<sakai:button_bar_item action="#{ForumTool.processDfGradeCancel}" value="#{msgs.cdfm_cancel}" accesskey="x" />
+			</sakai:button_bar>
+		</h:form>
+	</sakai:view>
 </f:view>
Index: msgcntr/messageforums-app/src/webapp/jsp/discussionForum/includes/dfAreaInclude.jsp
===================================================================
--- msgcntr/messageforums-app/src/webapp/jsp/discussionForum/includes/dfAreaInclude.jsp	(revision 46869)
+++ msgcntr/messageforums-app/src/webapp/jsp/discussionForum/includes/dfAreaInclude.jsp	(working copy)
@@ -1,185 +1,150 @@
-<!--jsp/discussionForum/area/dfArea.jsp-->
-  <h:dataTable id="forums" value="#{ForumTool.forums}" width="100%" var="forum" cellpadding="0" cellspacing="0" summary="layout">
-    <h:column rendered="#{! forum.nonePermission}">
-    <f:verbatim><div class="hierItemBlockWrapper"></f:verbatim>
-    <h:panelGrid columns="2" styleClass="hierItemBlock specialLink" columnClasses="bogus,itemAction" summary="layout" style="width:100%;">
-  	    <h:panelGroup>
-  	      <h:outputText styleClass="highlight" id="draft" value="#{msgs.cdfm_draft}" rendered="#{forum.forum.draft == 'true'}"/>
-	      <h:outputText id="draft_space" value=" -  " rendered="#{forum.forum.draft == 'true'}"/>
-		  
-	
-	      <h:graphicImage url="/images/lock.gif" alt="#{msgs.cdfm_forum_locked}"  rendered="#{forum.locked == 'true'}"/>
-	      <h:outputText id="emptyspace" value="  " rendered="#{forum.locked == 'true'}"/>
-	      <f:verbatim><h4></f:verbatim>
-	        <h:commandLink action="#{ForumTool.processActionDisplayForum}"  value="#{forum.forum.title}" title=" #{forum.forum.title}" rendered="#{ForumTool.showForumLinksInNav}">
-		        <f:param value="#{forum.forum.id}" name="forumId"/>
-	        </h:commandLink>
-	        <h:outputText value="#{forum.forum.title}" rendered="#{!ForumTool.showForumLinksInNav}"/>
-	      <f:verbatim></h4></f:verbatim>
-	  	  </h:panelGroup>
-	  	  <h:panelGroup styleClass="msgNav">
-			  <h:commandLink action="#{ForumTool.processActionNewTopic}" value="#{msgs.cdfm_new_topic}" rendered="#{forum.newTopic}" title="#{msgs.cdfm_new_topic}">
-		      <f:param value="#{forum.forum.id}" name="forumId"/>
-	      </h:commandLink>
-		  <h:outputText  value=" | " rendered="#{forum.changeSettings}"/><%-- gsilver: hiding the pipe when user does not have the ability to change the settings --%>
-	   	  <h:commandLink action="#{ForumTool.processActionForumSettings}"  value="#{msgs.cdfm_forum_settings}" rendered="#{forum.changeSettings}" title="#{msgs.cdfm_forum_settings}">
-		      <f:param value="#{forum.forum.id}" name="forumId"/>				
-	      </h:commandLink>
-  	    </h:panelGroup>
+<!--jsp/discussionForum/area/dfAreaInclude.jsp-->
+<h:outputText styleClass="instruction"  value="#{msgs.cdfm_forum_noforums}"  rendered="#{empty ForumTool.forums}"/>
+<h:dataTable id="forums" value="#{ForumTool.forums}" rendered="#{!empty ForumTool.forums}"  width="100%" var="forum" cellpadding="0" cellspacing="0" summary="layout" styleClass="specialLink">
+	<h:column rendered="#{! forum.nonePermission}">
+		<h:panelGrid columns="1" summary="layout" styleClass="forumHeader">
+			<h:panelGroup>
+				<%-- link to forum and decorations --%>
+				<h:outputText styleClass="highlight title" id="draft" value="#{msgs.cdfm_draft}" rendered="#{forum.forum.draft == 'true'}"/>
+				<h:outputText id="draft_space" value=" -  " rendered="#{forum.forum.draft == 'true'}" styleClass="title"/>
+				<%-- locked marker --%>
+				<h:graphicImage url="/images/silk/lock.png" alt="#{msgs.cdfm_forum_locked}" rendered="#{forum.locked == 'true'}" style="margin-right:.5em"/>
+				<h:commandLink action="#{ForumTool.processActionDisplayForum}"  value="#{forum.forum.title}" title=" #{forum.forum.title}" rendered="#{ForumTool.showForumLinksInNav}"  styleClass="title">
+					<f:param value="#{forum.forum.id}" name="forumId"/>
+				</h:commandLink>
+				<h:outputText value="#{forum.forum.title}" rendered="#{!ForumTool.showForumLinksInNav}"  styleClass="title" />
+				<%-- links to act on this forum --%>
+				<h:outputText value=" "  styleClass="actionLinks"/>
+				<h:commandLink action="#{ForumTool.processActionNewTopic}" value="#{msgs.cdfm_new_topic}" rendered="#{forum.newTopic}" title="#{msgs.cdfm_new_topic}">
+					<f:param value="#{forum.forum.id}" name="forumId"/>
+				</h:commandLink>
+				<h:outputText  value=" | " rendered="#{forum.changeSettings}"/><%-- gsilver: hiding the pipe when user does not have the ability to change the settings --%>
+				<h:commandLink action="#{ForumTool.processActionForumSettings}"  value="#{msgs.cdfm_forum_settings}" rendered="#{forum.changeSettings}" title="#{msgs.cdfm_forum_settings}">
+					<f:param value="#{forum.forum.id}" name="forumId"/>				
+				</h:commandLink>
 
-
-		<h:panelGroup>
-		
-
-<%-- the forum details --%>
-	  
-      	<f:verbatim><div></f:verbatim>
-		  <f:verbatim><p class="textPanel"></f:verbatim>
-		  <h:outputText value="#{forum.forum.shortDescription}" />
-		  <f:verbatim></p></f:verbatim>
-		  <f:verbatim><p class="textPanelFooter specialLink"></f:verbatim>
-
-				<%--gsilver: would be good if the returned url from this would include a named internal anchor as the target so that the expando/collapso would go to the top of the viewport and avoid having to scroll and find --%>
-			  <h:outputLink id="forum_extended_show" value="#" title="#{msgs.cdfm_read_full_description}" styleClass="show" 
-			  		rendered="#{forum.forum.extendedDescription != '' && forum.forum.extendedDescription != null}"
-			  		onclick="resize();$(this).next('.hide').toggle(); $('div.toggle', $(this).parents('div:first')).slideToggle(resize);$(this).toggle();">
-			  		<h:outputText value="#{msgs.cdfm_read_full_description}" />
-			  </h:outputLink>
-			  
-			  <h:outputLink id="forum_extended_hide" value="#" title="#{msgs.cdfm_hide_full_description}" style="display:none" styleClass="hide" 
-			  		onclick="resize();$(this).prev('.show').toggle(); $('div.toggle', $(this).parents('div:first')).slideToggle(resize);$(this).toggle();">
-			  		<h:outputText value="#{msgs.cdfm_hide_full_description}" />
-			  </h:outputLink>
-
-		    
-		<f:verbatim></p></f:verbatim>
-
-			 	<f:verbatim><div class="toggle" style="display:none"></f:verbatim>
-				<mf:htmlShowArea value="#{forum.forum.extendedDescription}"  
-		                     hideBorder="true" />
-
-				<f:verbatim></div></f:verbatim>
-		  
-		<f:verbatim></div></f:verbatim>
-		
-	  <h:dataTable  value="#{forum.attachList}" var="eachAttach" rendered="#{!empty forum.attachList}" columnClasses="attach,bogus" styleClass="listHier" summary="layout">
-			<h:column>
-				<h:graphicImage url="/images/excel.gif" rendered="#{eachAttach.attachment.attachmentType == 'application/vnd.ms-excel'}" alt="" />
-				<h:graphicImage url="/images/html.gif" rendered="#{eachAttach.attachment.attachmentType == 'text/html'}" alt="" />
-				<h:graphicImage url="/images/pdf.gif" rendered="#{eachAttach.attachment.attachmentType == 'application/pdf'}" alt="" />
-				<h:graphicImage url="/images/ppt.gif" rendered="#{eachAttach.attachment.attachmentType == 'application/vnd.ms-powerpoint'}" alt="" />
-				<h:graphicImage url="/images/text.gif" rendered="#{eachAttach.attachment.attachmentType == 'text/plain'}" alt="" />
-				<h:graphicImage url="/images/word.gif" rendered="#{eachAttach.attachment.attachmentType == 'application/msword'}" alt="" />
-		  </h:column>
-		  <h:column>
-<%--				<h:outputLink value="#{eachAttach.attachmentUrl}" target="_blank">
-					<h:outputText value="#{eachAttach.attachmentName}"  />
-				</h:outputLink>--%>
-				<h:outputLink value="#{eachAttach.url}" target="_blank">
-					<h:outputText value="#{eachAttach.attachment.attachmentName}"  />
-				</h:outputLink>			
-			</h:column>	
-	  </h:dataTable>
-	  
-	  </h:panelGroup>
-  </h:panelGrid>
-
-	  <%-- the topic list  --%>
-	  
-	  
-	  	<%--gsilver: need a rendered atttrib for the folowing predicated on the existence of topics in this forum--%>
-		 <h:dataTable id="topics" value="#{forum.topics}" var="topic" width="100%" styleClass="topicBloc"  cellspacing="0" cellpadding="0" summary="layout">
-		   <h:column rendered="#{! topic.nonePermission}">
-				<f:verbatim><div class="hierItemBlockChild"></f:verbatim>
-		      <h:panelGrid columns="2" summary="layout" width="100%" styleClass="specialLink" cellpadding="0" cellspacing="0" columnClasses="bogus,itemAction">
-		      	<h:panelGroup>
-		      	<h:graphicImage url="/images/folder.gif" alt="Topic Folder" rendered="#{topic.unreadNoMessages == 0 }" />
-					      <h:graphicImage url="/images/folder_unread.gif" alt="Topic Folder" rendered="#{topic.unreadNoMessages > 0 }" />
-					  <f:verbatim>&nbsp;&nbsp;</f:verbatim>
-						<h:outputText styleClass="highlight" id="draft" value="#{msgs.cdfm_draft}" rendered="#{topic.topic.draft == 'true'}"/>
-				      <h:outputText id="draft_space" value="  - " rendered="#{topic.topic.draft == 'true'}"/>
-				      <h:graphicImage url="/images/lock.gif" alt="#{msgs.cdfm_forum_locked}"  rendered="#{forum.locked == 'true' || topic.locked == 'true'}"/>
-				      <h:outputText id="emptyspace" value="  " rendered="#{topic.locked == 'true'}"/>
-						<f:verbatim><h5></f:verbatim>
-				      <h:commandLink action="#{ForumTool.processActionDisplayTopic}" id="topic_title" value="#{topic.topic.title}" title=" #{topic.topic.title}">
-					      <f:param value="#{topic.topic.id}" name="topicId"/>
-					      <f:param value="#{forum.forum.id}" name="forumId"/>
-				      </h:commandLink>
-					  <f:verbatim></h5></f:verbatim>
-				     <h:outputText styleClass="textPanelFooter" id="topic_msg_count55" value=" #{msgs.cdfm_openb} #{topic.totalNoMessages} #{msgs.cdfm_lowercase_msg} - #{topic.unreadNoMessages} #{msgs.cdfm_unread}" 
-				                    rendered="#{topic.isRead && topic.totalNoMessages < 2}"/>
-					   <h:outputText id="topic_msg_count56" value=" #{msgs.cdfm_openb} #{topic.totalNoMessages} #{msgs.cdfm_lowercase_msgs} - #{topic.unreadNoMessages} #{msgs.cdfm_unread}" 
-				                    rendered="#{topic.isRead && topic.totalNoMessages > 1}" styleClass="textPanelFooter" />
-				     <h:outputText id="topic_moderated" value="#{msgs.cdfm_topic_moderated_flag}" styleClass="textPanelFooter" rendered="#{topic.moderated == 'true' && topic.isRead}" />
-    	        <h:outputText value=" #{msgs.cdfm_closeb}"styleClass="textPanelFooter" rendered="#{topic.isRead}"/>
-    	        </h:panelGroup>
-    	        <h:panelGroup styleClass="msgNav">
-    	         <h:commandLink action="#{ForumTool.processActionTopicSettings}" id="topic_setting" value="#{msgs.cdfm_topic_settings}" rendered="#{topic.changeSettings}"
-    	                        title=" #{msgs.cdfm_topic_settings}">
-					     <f:param value="#{topic.topic.id}" name="topicId"/>
-				       <f:param value="#{forum.forum.id}" name="forumId"/>
-				     </h:commandLink>
-    	        </h:panelGroup>
-    	      </h:panelGrid>
-				<h:panelGrid columns="1" width="100%"  cellpadding="0" cellspacing="0" summary="layout">
-    	        <h:panelGroup styleClass="textPanel">
-    	          <h:outputText id="topic_desc" value="#{topic.topic.shortDescription}" />
-    	        </h:panelGroup>
-			    <h:panelGroup styleClass="textPanelFooter specialLink">
-			    	<h:outputLink id="forum_extended_show" value="#" title="#{msgs.cdfm_read_full_description}" styleClass="show" 
-			    		rendered="#{topic.topic.extendedDescription != '' && topic.topic.extendedDescription != null}"
-				  		onclick="resize();$(this).next('.hide').toggle(); $('td div.toggle', $(this).parents('tr:first').next('tr')).slideToggle(resize);$(this).toggle();">
-				  		<h:outputText value="#{msgs.cdfm_read_full_description}" />
-				    </h:outputLink>  
-				  
-				    <h:outputLink id="forum_extended_hide" value="#" title="#{msgs.cdfm_hide_full_description}" style="display:none" styleClass="hide" 
-				    	rendered="#{topic.topic.extendedDescription != '' && topic.topic.extendedDescription != null}"
-				  		onclick="resize();$(this).prev('.show').toggle(); $('td div.toggle', $(this).parents('tr:first').next('tr')).slideToggle(resize);$(this).toggle();">
-				  		<h:outputText value="#{msgs.cdfm_hide_full_description}" />
-				    </h:outputLink>
-
-				 </h:panelGroup>
-				<%--	gsilver: show the text, not the editor... --%>
-				<h:panelGroup styleClass="textPanel">
-					<f:verbatim><div class="toggle" style="display:none"></f:verbatim>
-					<mf:htmlShowArea  id="topic_fullDescription" hideBorder="true"	 value="#{topic.topic.extendedDescription}" />
-		 			<%--  <sakai:inputRichText rows="5" cols="110" buttonSet="none"  readonly="true" showXPath="false" id="topic_extended_description" value="#{topic.topic.extendedDescription}" rendered="#{topic.readFullDesciption}"/> --%>
-					<f:verbatim></div></f:verbatim>
-				</h:panelGroup>
-				<h:dataTable styleClass="listHier" value="#{topic.attachList}" var="eachAttach" rendered="#{!empty topic.attachList}" cellpadding="0" cellspacing="0" columnClasses="attach,bogus" summary="layout">
-					  <h:column>
-					  <%-- gsilver: need to tie in the attachment type to actual  MIME type mapping tables instead of the below (which is prevalent everywhere) or at the very least provide a mechanism for defaults. --%> 
-						<h:graphicImage url="/images/excel.gif" rendered="#{eachAttach.attachment.attachmentType == 'application/vnd.ms-excel'}" alt="application/vnd.ms-excel" />
-						<h:graphicImage url="/images/html.gif" rendered="#{eachAttach.attachment.attachmentType == 'text/html'}" alt="text/html" />
-						<h:graphicImage url="/images/pdf.gif" rendered="#{eachAttach.attachment.attachmentType == 'application/pdf'}" alt="application/pdf" />
-						<h:graphicImage url="/images/ppt.gif" rendered="#{eachAttach.attachment.attachmentType == 'application/vnd.ms-powerpoint'}" alt="application/vnd.ms-powerpoint" />
-						<h:graphicImage url="/images/text.gif" rendered="#{eachAttach.attachment.attachmentType == 'text/plain'}" alt="text/plain" />
-						<h:graphicImage url="/images/word.gif" rendered="#{eachAttach.attachment.attachmentType == 'application/msword'}" alt="application/msword" />
+				<%--//designNote: delete this forum link, a string now, with a fake rendered attribute - needs a real one --%>
+				<h:outputText  value=" | "   rendered="#{forum.changeSettings}"/>
+				<h:outputText  value=" Delete "  rendered="#{forum.changeSettings}" styleClass="todo"/>
+				<%-- the forum details --%>
+				<h:outputText value="#{forum.forum.shortDescription}" styleClass="shortDescription"/>
+				<h:outputLink id="forum_extended_show" value="#" title="#{msgs.cdfm_read_full_description}"  styleClass="show"
+						rendered="#{forum.forum.extendedDescription != '' && forum.forum.extendedDescription != null}"
+						onclick="resize();$(this).next('.hide').toggle(); $('div.toggle:first', $(this).parents('table.forumHeader')).slideToggle(resize);$(this).toggle();">
+					<h:graphicImage url="/images/collapse.gif" /><h:outputText value="#{msgs.cdfm_read_full_description}" />
+					<h:outputText value=" #{msgs.cdfm_read_full_description_andatts}"  rendered="#{!empty forum.attachList}"/>
+				</h:outputLink>
+				<%--//designNote: these link always show up even after you  have "zeroed out" a long description because it always saves a crlf --%>
+				<h:outputLink id="forum_extended_hide" value="#" title="#{msgs.cdfm_hide_full_description}" style="display:none;" styleClass="hide" 
+						onclick="resize();$(this).prev('.show').toggle(); $('div.toggle:first', $(this).parents('table.forumHeader')).slideToggle(resize);$(this).toggle();">
+					<h:graphicImage url="/images/expand.gif"/> <h:outputText value="#{msgs.cdfm_hide_full_description}" />
+					<h:outputText value=" #{msgs.cdfm_read_full_description_andatts}"  rendered="#{!empty forum.attachList}"/>
+					</h:outputLink>
+				<f:verbatim><div class="toggle" style="display:none;padding-left:1em"></f:verbatim>
+					<mf:htmlShowArea value="#{forum.forum.extendedDescription}"  hideBorder="true" />
+					<%-- attachs --%>
+					<h:dataTable  value="#{forum.attachList}" var="eachAttach" rendered="#{!empty forum.attachList}" columnClasses="attach,bogus"  summary="layout" style="font-size:.9em;width:auto;margin-left:1em" border="0" cellpadding="3" cellspacing="0">
+						<h:column>
+							<h:graphicImage url="/images/attachment.gif"/>
 						</h:column>
 						<h:column>
-<%--						<h:outputLink value="#{eachAttach.attachmentUrl}" target="_blank">
-							<h:outputText value="#{eachAttach.attachmentName}" />
-						</h:outputLink>--%>
-						<h:outputLink value="#{eachAttach.url}" target="_blank">
-							<h:outputText value="#{eachAttach.attachment.attachmentName}" />
-						</h:outputLink>				  
-					</h:column>
-			  </h:dataTable>
-			  <%-- gsilver: need a render attribute on the dataTable here to avoid putting an empty table in response -- since this looks like a stub that was never worked out to display the messages inside this construct - commenting the whole thing out.
-			 <h:dataTable styleClass="indnt2" id="messages" value="#{topics.messages}" var="message">
-			  <h:column>
-					<h:outputText id="message_title" value="#{message.message.title}"/>
-					<f:verbatim><br /></f:verbatim>
-					<h:outputText id="message_desc" value="#{message.message.shortDescription}" />
-			  </h:column>
-			</h:dataTable>
-			--%>
-  	    </h:panelGrid>
-    <f:verbatim></div></f:verbatim>
+							<%--
+								<h:outputLink value="#{eachAttach.attachmentUrl}" target="_blank">
+								<h:outputText value="#{eachAttach.attachmentName}"  />
+								</h:outputLink>
+							--%>
+							<h:outputLink value="#{eachAttach.url}" target="_blank">
+								<h:outputText value="#{eachAttach.attachment.attachmentName}"  />
+							</h:outputLink>			
+						</h:column>	
+					</h:dataTable>
+				<f:verbatim></div></f:verbatim>
+			</h:panelGroup>
+		</h:panelGrid>
+		<%-- the topic list  --%>
+		<%--//designNote: need a rendered atttrib for the folowing predicated on the existence of topics in this forum--%>
+		<h:dataTable id="topics" value="#{forum.topics}" var="topic"  width="100%"   cellspacing="0" cellpadding="0" summary="layout">
+			<h:column rendered="#{! topic.nonePermission}">
+					<h:panelGrid columns="1" summary="layout" width="100%" styleClass="specialLink topicBloc" cellpadding="0" cellspacing="0">
+						<h:panelGroup>
+							<%--//desNote: only show the new "new" message if there are no unread messages --%>
+							<h:outputText styleClass="messageNew" value=" #{msgs.cdfm_newflag}"  rendered="#{topic.unreadNoMessages > 0 }" />
+							<%--
+							<h:graphicImage url="/images/icon_new_blank.png" alt="Topic Folder" rendered="#{topic.unreadNoMessages > 0 }" style="margin-right:.5em"/>
+							<h:graphicImage url="/images/folder.gif" alt="Topic Folder" rendered="#{topic.unreadNoMessages == 0 }" style="margin-right:.5em"/>
+							<h:graphicImage url="/images/folder_unread.gif" alt="Topic Folder" rendered="#{topic.unreadNoMessages > 0 }" style="margin-right:.5em"/>--%>
+							<h:outputText styleClass="highlight title" id="draft" value="#{msgs.cdfm_draft}" rendered="#{topic.topic.draft == 'true'}"/>
+							<h:outputText id="draft_space" value="  - " rendered="#{topic.topic.draft == 'true'}" styleClass="title"/>
+							<h:graphicImage url="/images/silk/lock.png" alt="#{msgs.cdfm_forum_locked}" rendered="#{forum.locked == 'true' || topic.locked == 'true'}" style="margin-right:.5em"/>
+							<h:commandLink action="#{ForumTool.processActionDisplayTopic}" id="topic_title" value="#{topic.topic.title}" title=" #{topic.topic.title}" styleClass="title">
+								<f:param value="#{topic.topic.id}" name="topicId"/>
+								<f:param value="#{forum.forum.id}" name="forumId"/>
+							</h:commandLink>
+							<%-- // display singular ('message') if one message --%>
+							<h:outputText styleClass="textPanelFooter" id="topic_msg_count55" value=" #{msgs.cdfm_openb} #{topic.totalNoMessages} #{msgs.cdfm_lowercase_msg} - #{topic.unreadNoMessages} #{msgs.cdfm_unread}" 
+								rendered="#{topic.isRead && topic.totalNoMessages == 1}"/>
+							<%-- // display plural ('messages') if 0 or more than 1 messages --%>
+								<h:outputText id="topic_msg_count56" value=" #{msgs.cdfm_openb} #{topic.totalNoMessages} #{msgs.cdfm_lowercase_msgs} - #{topic.unreadNoMessages} #{msgs.cdfm_unread}" 
+								rendered="#{topic.isRead && (topic.totalNoMessages > 1 || topic.totalNoMessages == 0) }" styleClass="textPanelFooter" />
+							<h:outputText id="topic_moderated" value="#{msgs.cdfm_topic_moderated_flag}" styleClass="textPanelFooter" rendered="#{topic.moderated == 'true' && topic.isRead}" />
+							<h:outputText value=" #{msgs.cdfm_closeb}" styleClass="textPanelFooter" rendered="#{topic.isRead}"/>
+							<%--//desNote: links to act on this topic --%>
+							<h:outputText value=" "  styleClass="actionLinks"/>
+							<h:commandLink action="#{ForumTool.processActionTopicSettings}" id="topic_setting" value="#{msgs.cdfm_topic_settings}" rendered="#{topic.changeSettings}"
+								title=" #{msgs.cdfm_topic_settings}">
+									<f:param value="#{topic.topic.id}" name="topicId"/>
+									<f:param value="#{forum.forum.id}" name="forumId"/>
+							</h:commandLink>
+							<%-- delete this topic  link, a string now - needs a real rendered attribute --%>
+							<h:outputText  value=" | " rendered="#{topic.changeSettings}"/>
+							<h:outputText  value=" Delete " rendered="#{topic.changeSettings}" styleClass="todo"/>
 
-	 </h:column>
-			
-      </h:dataTable>			
-	<f:verbatim></div><!--end single topic here --></f:verbatim>
-	  </h:column>
-  </h:dataTable>
\ No newline at end of file
+							<%--the topic details --%>
+							<h:outputText id="topic_desc" value="#{topic.topic.shortDescription}" styleClass="shortDescription" />
+							<h:outputLink id="forum_extended_show" value="#" title="#{msgs.cdfm_read_full_description}" styleClass="show"
+									rendered="#{topic.topic.extendedDescription != '' && topic.topic.extendedDescription != null}"
+									onclick="resize();$(this).next('.hide').toggle(); $('td div.toggle', $(this).parents('tr:first').next('tr')).slideToggle(resize);$(this).toggle();">
+									<h:graphicImage url="/images/collapse.gif"/><h:outputText value="#{msgs.cdfm_read_full_description}" />
+									<h:outputText value=" #{msgs.cdfm_read_full_description_andatts}" rendered="#{!empty topic.attachList}"/>
+							</h:outputLink>  
+							<h:outputLink id="forum_extended_hide" value="#" title="#{msgs.cdfm_hide_full_description}" style="display:none " styleClass="hide" 
+									rendered="#{topic.topic.extendedDescription != '' && topic.topic.extendedDescription != null}"
+									onclick="resize();$(this).prev('.show').toggle(); $('td div.toggle', $(this).parents('tr:first').next('tr')).slideToggle(resize);$(this).toggle();">
+									<h:graphicImage url="/images/expand.gif"/><h:outputText value="#{msgs.cdfm_hide_full_description}" />
+									<h:outputText value=" #{msgs.cdfm_read_full_description_andatts}"  rendered="#{!empty topic.attachList}"/>
+							</h:outputLink>
+						</h:panelGroup>
+						<h:panelGroup>
+							<f:verbatim><div class="toggle" style="display:none;padding-left:1em"></f:verbatim>
+								<mf:htmlShowArea  id="topic_fullDescription" hideBorder="true"	 value="#{topic.topic.extendedDescription}" />
+								<%--//desNote:attach list --%>
+								<h:dataTable  value="#{topic.attachList}" var="eachAttach" rendered="#{!empty topic.attachList}" cellpadding="3" cellspacing="0" columnClasses="attach,bogus" summary="layout"  style="font-size:.9em;width:auto;margin-left:1em" border="0">
+									<h:column>
+										<h:graphicImage url="/images/attachment.gif"/>
+									</h:column>
+									<h:column>
+										<%--<h:outputLink value="#{eachAttach.attachmentUrl}" target="_blank">
+										<h:outputText value="#{eachAttach.attachmentName}" />
+										</h:outputLink>--%>
+										<h:outputLink value="#{eachAttach.url}" target="_blank">
+										<h:outputText value="#{eachAttach.attachment.attachmentName}" />
+										</h:outputLink>  
+									</h:column>
+								</h:dataTable>
+								<%-- gsilver: need a render attribute on the dataTable here to avoid putting an empty table in response -- since this looks like a stub that was never worked out to display the messages inside this construct - commenting the whole thing out.
+								<h:dataTable styleClass="indnt2" id="messages" value="#{topics.messages}" var="message">
+								<h:column>
+								<h:outputText id="message_title" value="#{message.message.title}"/>
+								<f:verbatim><br /></f:verbatim>
+								<h:outputText id="message_desc" value="#{message.message.shortDescription}" />
+								</h:column>
+								</h:dataTable>
+								--%>
+							<f:verbatim></div></f:verbatim>
+						</h:panelGroup>
+								
+					</h:panelGrid>
+			</h:column>
+		</h:dataTable>
+	</h:column>
+</h:dataTable>
\ No newline at end of file
Index: msgcntr/messageforums-app/src/webapp/jsp/discussionForum/area/dfTemplateOrganize.jsp
===================================================================
--- msgcntr/messageforums-app/src/webapp/jsp/discussionForum/area/dfTemplateOrganize.jsp	(revision 46869)
+++ msgcntr/messageforums-app/src/webapp/jsp/discussionForum/area/dfTemplateOrganize.jsp	(working copy)
@@ -5,14 +5,14 @@
 <%@ taglib uri="http://sakaiproject.org/jsf/sakai" prefix="sakai" %>
 <%@ taglib uri="http://sakaiproject.org/jsf/messageforums" prefix="mf" %>
 <jsp:useBean id="msgs" class="org.sakaiproject.util.ResourceLoader" scope="session">
-   <jsp:setProperty name="msgs" property="baseName" value="org.sakaiproject.api.app.messageforums.bundle.Messages"/>
+	<jsp:setProperty name="msgs" property="baseName" value="org.sakaiproject.api.app.messageforums.bundle.Messages"/>
 </jsp:useBean>
 
 <f:view>
-       		<script type="text/javascript" src="/library/js/jquery.js"></script>
-       		<sakai:script contextBase="/sakai-messageforums-tool" path="/js/sak-10625.js"/>
-   <f:verbatim>
-      <script language="javascript">
+	<script type="text/javascript" src="/library/js/jquery.js"></script>
+	<sakai:script contextBase="/sakai-messageforums-tool" path="/js/sak-10625.js"/>
+	<f:verbatim>
+	<script language="javascript">
       
          function updateForums(forumIndexChanged)
          {
@@ -29,7 +29,7 @@
          		
          	for(i = 0; i < numForums; i++) {
          		var sel = document.getElementById("revise:forums:" + i +":forumIndex");
-         		
+         		sel.className="selChanged";
          		indexSet[sel.selectedIndex] = true;
          	}
          	var oldIndex = -1;
@@ -80,7 +80,7 @@
          	for(i = 0; i < numTopics; i++) {
          		var sel = document.getElementById("revise:forums:" + 
          					forumIndex + ":topics:" + i +":topicIndex");
-         		
+				sel.className="selChanged";   
          		indexSet[sel.selectedIndex] = true;
          	}
          	var oldIndex = -1;
@@ -119,67 +119,53 @@
          //because we don't know which order
          var forumIndexIterator = 0;
          
-      </script>
-   </f:verbatim>
-   <sakai:view title="#{msgs.cdfm_default_template_organize}">           
-      <h:form id="revise">
-<!--jsp/discussionForum/area/dfTemplateSettings.jsp-->
-        <sakai:tool_bar_message value="#{msgs.cdfm_default_template_organize}" />
-		 		<div class="instruction">
-		  		  <h:outputText id="instruction" value="#{msgs.cdfm_default_template_organize_instruction}"/>
-				</div>
+		 </script>
+	</f:verbatim>
+	<sakai:view title="#{msgs.cdfm_default_template_organize}">           
+		<h:form id="revise">
+		<style type="text/css">
+			@import url("/sakai-messageforums-tool/css/msgcntr.css");
+		</style>
 		
-		
-  <h:dataTable id="forums" binding="#{ForumTool.forumTable}" value="#{ForumTool.forums}" width="100%" var="forum" cellpadding="0" cellspacing="0" summary="layout">
-    <h:column rendered="#{! forum.nonePermission}">
-    <f:verbatim><div class="hierItemBlockWrapper"></f:verbatim>
-	      <f:verbatim><h4></f:verbatim>
-	         <h:selectOneMenu id="forumIndex" value="#{forum.forum.sortIndex}" onchange="updateForums(this);">
-	            <f:selectItems value="#{ForumTool.forumSelectItems}"/>
-	         </h:selectOneMenu>
-				<h:outputText id="space1" value="  &nbsp;  " escape="false" />
-	         
-				<h:outputText id="forumTitle" value="#{forum.forum.title}" />
-	        
-	      <f:verbatim></h4></f:verbatim>
-    
-	  	<%--gsilver: need a rendered atttrib for the folowing predicated on the existence of topics in this forum--%>
-		 <h:dataTable id="topics" value="#{forum.forum.topics}" var="topic" width="100%" styleClass="topicBloc"  cellspacing="0" cellpadding="0" summary="layout">
-		   <h:column>
-				<f:verbatim><div class="hierItemBlockChild"></f:verbatim>
-				<h:outputText id="space2" value="  &nbsp;  " escape="false" />
-				<h:outputText id="space3" value="  &nbsp;  " escape="false" />
-		         <h:selectOneMenu id="topicIndex" value="#{topic.sortIndex}" onchange="updateTopics(#{ForumTool.forumTable.rowIndex}, this);">
-		            <f:selectItems value="#{forum.topicSelectItems}"/>
-		         </h:selectOneMenu>
-				<h:outputText id="space4" value="  &nbsp;  " escape="false" />
-				
-						<f:verbatim><h5></f:verbatim>
-						<h:outputText id="topicTitle" value="#{topic.title}" />
-				      
-					  <f:verbatim></h5></f:verbatim>
-				
-				
-			    <f:verbatim></div></f:verbatim>
+			<!--jsp/discussionForum/area/dfTemplateOrganize.jsp-->
+			<sakai:tool_bar_message value="#{msgs.cdfm_default_template_organize}" />
+			<div class="instruction">
+				<h:outputText id="instruction" value="#{msgs.cdfm_default_template_organize_instruction}"/>
+			</div>
+			<h:dataTable id="forums" binding="#{ForumTool.forumTable}" value="#{ForumTool.forums}" width="100%" var="forum" cellpadding="0" cellspacing="0" summary="layout" styleClass="listHier">
+				<h:column rendered="#{! forum.nonePermission}">
+					<h:panelGroup style="display:block;width:90%;padding:.5em" styleClass="forumHeader">
+					<h:selectOneMenu id="forumIndex" value="#{forum.forum.sortIndex}" onchange="updateForums(this);" style="margin-right:1em">
+						<f:selectItems value="#{ForumTool.forumSelectItems}" />
+					</h:selectOneMenu>
+					<h:outputText id="forumTitle" value="#{forum.forum.title}" style="font-weight:bold;font-size:1.3em;"/>
+					</h:panelGroup>
+						<%--//designNote: need a rendered atttrib for the folowing predicated on the existence of topics in this forum--%>
+					<h:dataTable id="topics" value="#{forum.forum.topics}" var="topic" width="100%" cellspacing="0" cellpadding="0" summary="layout">
+						<h:column>
+							<h:panelGroup style="display:block;width:90%;padding:.2em;margin:.2em 0 .2em .5em" styleClass="topicBloc">
+								<h:selectOneMenu id="topicIndex" value="#{topic.sortIndex}" onchange="updateTopics(#{ForumTool.forumTable.rowIndex}, this);" style="margin-left:.3em;margin-right:1em">
+									<f:selectItems value="#{forum.topicSelectItems}"/>
+								</h:selectOneMenu>
+								<h:outputText id="topicTitle" value="#{topic.title}"style="font-weight:bold;font-size:1.2em;"/>
+							</h:panelGroup>
+						</h:column>
+					</h:dataTable>
+				</h:column>
+			</h:dataTable>
 			
-		   </h:column>
-        </h:dataTable>			
-        <f:verbatim></div><!--end single topic here --></f:verbatim>
-   </h:column>
- </h:dataTable>
-		
-		
-        <div class="act">
-          <h:commandButton action="#{ForumTool.processActionSaveTemplateOrganization}" 
-                           onclick="form.submit;" value="#{msgs.cdfm_button_bar_save_setting}" 
-                           accesskey="s" 
-						   styleClass="active"/>
-          <h:commandButton action="#{ForumTool.processActionHome}" 
-                           value="#{msgs.cdfm_button_bar_cancel}"
-                           accesskey="x" />
-       </div>
-	  </h:form>
-    </sakai:view>
+			
+				<div class="act">
+					<h:commandButton action="#{ForumTool.processActionSaveTemplateOrganization}" 
+						onclick="form.submit;" value="#{msgs.cdfm_button_bar_save_setting}" 
+						accesskey="s" 
+						styleClass="active"/>
+					<h:commandButton action="#{ForumTool.processActionHome}" 
+						value="#{msgs.cdfm_button_bar_cancel}"
+						accesskey="x" />
+				</div>
+		</h:form>
+		</sakai:view>
 </f:view>
 
 
Index: msgcntr/messageforums-app/src/webapp/jsp/discussionForum/area/dfTemplateSettings.jsp
===================================================================
--- msgcntr/messageforums-app/src/webapp/jsp/discussionForum/area/dfTemplateSettings.jsp	(revision 46869)
+++ msgcntr/messageforums-app/src/webapp/jsp/discussionForum/area/dfTemplateSettings.jsp	(working copy)
@@ -11,6 +11,10 @@
 <f:view>
    <sakai:view title="#{msgs.cdfm_default_template_settings}">           
       <h:form id="revise">
+	  			<style type="text/css">
+				@import url("/sakai-messageforums-tool/css/msgcntr.css");
+			</style>
+
              		<script type="text/javascript" src="/library/js/jquery.js"></script>
        		<sakai:script contextBase="/sakai-messageforums-tool" path="/js/sak-10625.js"/>
 <!--jsp/discussionForum/area/dfTemplateSettings.jsp-->
@@ -19,11 +23,11 @@
 		  		  <h:outputText id="instruction" value="#{msgs.cdfm_default_template_settings_instruction}"/>
 				</div>
 				
-				<div class="discTria" style="padding: 0.5em;"><h4><h:outputText  value="#{msgs.cdfm_forum_posting}" /></h4></div>
+				<h4><h:outputText  value="#{msgs.cdfm_forum_posting}" /></h4>
 				<h:panelGrid columns="2" columnClasses="shorttext,checkbox">
-				  <h:panelGroup><h:outputLabel id="outputLabel4" for="moderated"  value="#{msgs.cdfm_moderate_forums}"/>	</h:panelGroup>
+				  <h:panelGroup><h:outputText id="outputLabel4"   value="#{msgs.cdfm_moderate_forums}"/>	</h:panelGroup>
 				  <h:panelGroup>
-					  <h:selectOneRadio layout="pageDirection" disabled="#{not ForumTool.editMode}" id="moderated"  value="#{ForumTool.template.moderated}"
+					  <h:selectOneRadio layout="lineDirection" disabled="#{not ForumTool.editMode}" id="moderated"  value="#{ForumTool.template.moderated}"
 					  	onclick="javascript:disableOrEnableModeratePerm();">
     					<f:selectItem itemValue="true" itemLabel="#{msgs.cdfm_yes}"/>
     					<f:selectItem itemValue="false" itemLabel="#{msgs.cdfm_no}"/>
Index: msgcntr/messageforums-app/src/webapp/jsp/discussionForum/forum/dfForumDetail.jsp
===================================================================
--- msgcntr/messageforums-app/src/webapp/jsp/discussionForum/forum/dfForumDetail.jsp	(revision 46869)
+++ msgcntr/messageforums-app/src/webapp/jsp/discussionForum/forum/dfForumDetail.jsp	(working copy)
@@ -3,144 +3,142 @@
 <%@ taglib uri="http://sakaiproject.org/jsf/sakai" prefix="sakai" %>
 <%@ taglib uri="http://sakaiproject.org/jsf/messageforums" prefix="mf" %>
 <jsp:useBean id="msgs" class="org.sakaiproject.util.ResourceLoader" scope="session">
-   <jsp:setProperty name="msgs" property="baseName" value="org.sakaiproject.api.app.messagecenter.bundle.Messages"/>
+	<jsp:setProperty name="msgs" property="baseName" value="org.sakaiproject.api.app.messagecenter.bundle.Messages"/>
 </jsp:useBean>
 <f:view>
-  <sakai:view>
+<sakai:view>
+	<h:form id="msgForum" rendered="#{!ForumTool.selectedForum.forum.draft || ForumTool.selectedForum.forum.createdBy == ForumTool.userId}">
+		<style type="text/css">
+			@import url("/sakai-messageforums-tool/css/msgcntr.css");
+		</style>
+		<script type="text/javascript" src="/library/js/jquery.js"></script>
+		<sakai:script contextBase="/sakai-messageforums-tool" path="/js/sak-10625.js"/>
+		<sakai:script contextBase="/sakai-messageforums-tool" path="/js/forum.js"/>
+		<!--jsp/discussionForum/forum/dfForumDetail.jsp-->
 
-    <h:form id="msgForum">
-  		<script type="text/javascript" src="/library/js/jquery.js"></script>
-  		<sakai:script contextBase="/sakai-messageforums-tool" path="/js/sak-10625.js"/>
-    	<sakai:script contextBase="/sakai-messageforums-tool" path="/js/forum.js"/>
-<!--jsp/discussionForum/forum/dfForumDetail.jsp-->
-      <h:panelGrid columns="2" summary="layout" width="100%" styleClass="navPanel  specialLink">
-        <h:panelGroup>
-          	<f:verbatim><div class="breadCrumb"><h3></f:verbatim>
-          		<%-- Display the proper home page link: either Messages & Forums OR Forums --%>
-			      <h:commandLink action="#{ForumTool.processActionHome}" value="#{msgs.cdfm_message_forums}" title=" #{msgs.cdfm_message_forums}"
-			      		rendered="#{ForumTool.messagesandForums}" />
-			      <h:commandLink action="#{ForumTool.processActionHome}" value="#{msgs.cdfm_discussion_forums}" title=" #{msgs.cdfm_discussion_forums}"
-			      		rendered="#{ForumTool.forumsTool}" />
-			      <f:verbatim><h:outputText value=" " /><h:outputText value=" / " /><h:outputText value=" " /></f:verbatim>
-			      <h:outputText value="#{ForumTool.selectedForum.forum.title}" />
-			    <f:verbatim></h3></div></f:verbatim>
-        </h:panelGroup>
-        <h:panelGroup styleClass="itemNav">
-        		<h:commandLink action="#{ForumTool.processActionNewTopic}"  value="#{msgs.cdfm_new_topic}" rendered="#{ForumTool.selectedForum.newTopic}" 
-        		               title=" #{msgs.cdfm_new_topic}">
-					  <f:param value="#{ForumTool.selectedForum.forum.id}" name="forumId"/>
-				  </h:commandLink>
-				  <f:verbatim><h:outputText value=" | " rendered="#{ForumTool.selectedForum.changeSettings}"/></f:verbatim>
-				  <h:commandLink action="#{ForumTool.processActionForumSettings}" value="#{msgs.cdfm_forum_settings}" rendered="#{ForumTool.selectedForum.changeSettings}"
-				                 title=" #{msgs.cdfm_forum_settings}">
-					  <f:param value="#{ForumTool.selectedForum.forum.id}" name="forumId"/>
-				  </h:commandLink>
-        </h:panelGroup>
-      </h:panelGrid>
-      <f:verbatim><div class="hierItemBlockWrapper"></f:verbatim>
-      	<f:verbatim><div class="hierItemBlock"></f:verbatim>
-		  <p class="textPanel">
-		  
-		  <h4>
-		  <h:outputText value="#{ForumTool.selectedForum.forum.title}" />
-		  </h4>
-		  
-		  <h:outputText value="#{ForumTool.selectedForum.forum.shortDescription}" />
-		  </p>
-		  <p class="textPanelFooter specialLink">
 
-			  <h:outputLink id="forum_extended_show" value="#" title="#{msgs.cdfm_read_full_description}" styleClass="show" 
-			  		rendered="#{ForumTool.selectedForum.forum.extendedDescription != '' && ForumTool.selectedForum.forum.extendedDescription != null}"
-			  		onclick="resize();$(this).next('.hide').toggle(); $('div.toggle', $(this).parents('div.hierItemBlock')).slideToggle(resize);$(this).toggle();">
-			  		<h:outputText value="#{msgs.cdfm_read_full_description}" />
-			  </h:outputLink>
-			  
-			  <h:outputLink id="forum_extended_hide" value="#" title="#{msgs.cdfm_hide_full_description}" style="display:none" styleClass="hide" 
-			  		rendered="#{ForumTool.selectedForum.forum.extendedDescription != '' && ForumTool.selectedForum.forum.extendedDescription != null}"
-			  		onclick="resize();$(this).prev('.show').toggle(); $('div.toggle', $(this).parents('div.hierItemBlock')).slideToggle(resize);$(this).toggle();">
-			  		<h:outputText value="#{msgs.cdfm_hide_full_description}" />
-			  </h:outputLink>
 
-		    
-		</p>
+		<h3 class="specialLink" style="margin-bottom:1em">
+			<%-- Display the proper home page link: either Messages & Forums OR Forums --%>
+			<h:commandLink action="#{ForumTool.processActionHome}" value="#{msgs.cdfm_message_forums}" title=" #{msgs.cdfm_message_forums}"
+				rendered="#{ForumTool.messagesandForums}" />
+			<h:commandLink action="#{ForumTool.processActionHome}" value="#{msgs.cdfm_discussion_forums}" title=" #{msgs.cdfm_discussion_forums}"
+				rendered="#{ForumTool.forumsTool}" />
+			<f:verbatim><h:outputText value=" " /><h:outputText value=" / " /><h:outputText value=" " /></f:verbatim>
+			<h:outputText value="#{ForumTool.selectedForum.forum.title}" />
+		</h3>
+		<h:panelGrid columns="1" summary="layout" styleClass="forumHeader">
+			<h:panelGroup>
+				<h:outputText styleClass="highlight title" id="draft" value="#{msgs.cdfm_draft}" rendered="#{ForumTool.selectedForum.forum.draft == 'true'}"/>
+				<h:outputText id="draft_space" value=" -  " rendered="#{ForumTool.selectedForum.forum.draft == 'true'}" styleClass="title"/>
+				<h:graphicImage url="/images/silk/lock.png" alt="#{msgs.cdfm_forum_locked}" rendered="#{ForumTool.selectedForum.forum.locked == 'true'}" style="margin-right:.5em"/>	
+				<h:outputText value="#{ForumTool.selectedForum.forum.title}" styleClass="title"/>
+				<h:outputText value=" "  styleClass="actionLinks"/>
+				<h:commandLink action="#{ForumTool.processActionNewTopic}"  value="#{msgs.cdfm_new_topic}" rendered="#{ForumTool.selectedForum.newTopic}" 
+					title=" #{msgs.cdfm_new_topic}">
+					<f:param value="#{ForumTool.selectedForum.forum.id}" name="forumId"/>
+				</h:commandLink>
+				<f:verbatim><h:outputText value=" | " rendered="#{ForumTool.selectedForum.changeSettings}"/></f:verbatim>
+				<h:commandLink action="#{ForumTool.processActionForumSettings}" value="#{msgs.cdfm_forum_settings}" rendered="#{ForumTool.selectedForum.changeSettings}"
+					title=" #{msgs.cdfm_forum_settings}">
+					<f:param value="#{ForumTool.selectedForum.forum.id}" name="forumId"/>
+				</h:commandLink>
+				<h:outputText  value=" | "   rendered="#{ForumTool.selectedForum.changeSettings}"/>
+				<h:outputText  value=" Delete "  styleClass="todo"  rendered="#{ForumTool.selectedForum.changeSettings}"/>
+				
+				<h:outputText value="#{ForumTool.selectedForum.forum.shortDescription}" styleClass="shortDescription"/>
 
+				<h:outputLink id="forum_extended_show" value="#" title="#{msgs.cdfm_read_full_description}" styleClass="show" 
+						rendered="#{ForumTool.selectedForum.forum.extendedDescription != '' && ForumTool.selectedForum.forum.extendedDescription != null}"
+						onclick="resize();$(this).next('.hide').toggle(); $('div.toggle', $(this).parents('table.forumHeader')).slideToggle(resize);$(this).toggle();">
+					<h:graphicImage url="/images/collapse.gif" /><h:outputText value="#{msgs.cdfm_read_full_description}" />
+				</h:outputLink>
+				<h:outputLink id="forum_extended_hide" value="#" title="#{msgs.cdfm_hide_full_description}" style="display:none" styleClass="hide" 
+						rendered="#{ForumTool.selectedForum.forum.extendedDescription != '' && ForumTool.selectedForum.forum.extendedDescription != null}"
+						onclick="resize();$(this).prev('.show').toggle(); $('div.toggle', $(this).parents('table.forumHeader')).slideToggle(resize);$(this).toggle();">
+					<h:graphicImage url="/images/expand.gif" /><h:outputText value="#{msgs.cdfm_hide_full_description}" />
+				</h:outputLink>
 			 	<f:verbatim><div class="toggle" style="display:none"></f:verbatim>
-				<mf:htmlShowArea value="#{ForumTool.selectedForum.forum.extendedDescription}"  
-		                     hideBorder="true" />
-
+					<mf:htmlShowArea value="#{ForumTool.selectedForum.forum.extendedDescription}"  
+						hideBorder="true" />
+					<%--//designNote: need thge atts list but it is not in scope --%>
+					<%--
+						<h:dataTable  value="#{ForumTool.selectedForum.forum.attachList}" var="eachAttach" rendered="#{!empty ForumTool.selectedForum.forum.attachList}" columnClasses="attach,bogus"  summary="layout" style="font-size:.9em;width:auto;margin-left:1em" border="0" cellpadding="3" cellspacing="0">
+							<h:column>
+								<h:graphicImage url="/images/attachment.gif"/>
+							</h:column>
+							<h:column>
+								<h:outputLink value="#{eachAttach.url}" target="_blank">
+									<h:outputText value="#{eachAttach.attachment.attachmentName}"  />
+								</h:outputLink>			
+							</h:column>	
+						</h:dataTable>
+					--%>	
 				<f:verbatim></div></f:verbatim>
-		  
-		  
+			</h:panelGroup>
+		</h:panelGrid>
 
-
-		<f:verbatim></div></f:verbatim>
-		<h:dataTable id="topics" styleClass="topicBloc" value="#{ForumTool.selectedForum.topics}" var="topic" width="100%"  cellspacing="0" cellpadding="0">
+		<%--//designNote: need a rendered atttrib for the folowing predicated on the existence of topics in this forum--%>
+		 <h:outputText value="#{msgs.cdfm_no_topics}" rendered="#{empty ForumTool.selectedForum.topics}"    styleClass="messageInformation" />
+		<h:dataTable id="topics"  rendered="#{!empty ForumTool.selectedForum.topics}" value="#{ForumTool.selectedForum.topics}" var="topic" width="100%"  cellspacing="0" cellpadding="0">
 			<h:column rendered="#{! topic.nonePermission}">
-			<f:verbatim><div class="hierItemBlockChild"></f:verbatim>	
-        <h:panelGrid columns="2" summary="layout" width="100%"  styleClass="topicHeadings specialLink" columnClasses="bogus,itemAction" cellspacing="0" cellpadding="0">
-          <h:panelGroup>
-			 	<f:verbatim><h4></f:verbatim>
-				    <h:commandLink action="#{ForumTool.processActionDisplayTopic}" id="topic_title" value="#{topic.topic.title}" title=" #{topic.topic.title}">
-						  <f:param value="#{topic.topic.id}" name="topicId"/>
-						  <f:param value="#{ForumTool.selectedForum.forum.id}" name="forumId"/>
-					  </h:commandLink>
-					 <f:verbatim></h4></f:verbatim> 
-						<h:outputText styleClass="textPanelFooter" id="topic_msg_count" value=" #{msgs.cdfm_openb} #{topic.totalNoMessages} #{msgs.cdfm_lowercase_msg} - #{topic.unreadNoMessages} #{msgs.cdfm_unread}" rendered="#{topic.isRead && topic.totalNoMessages < 2}"/>
-						<h:outputText styleClass="textPanelFooter" id="topic_msgs_count" value=" #{msgs.cdfm_openb} #{topic.totalNoMessages} #{msgs.cdfm_lowercase_msgs} - #{topic.unreadNoMessages} #{msgs.cdfm_unread}" rendered="#{topic.isRead && topic.totalNoMessages > 1}"/>
-				  	<h:outputText id="topic_moderated" value="#{msgs.cdfm_topic_moderated_flag}" styleClass="textPanelFooter" rendered="#{topic.moderated == 'true'}" />
-    	      <h:outputText value=" #{msgs.cdfm_closeb}"styleClass="textPanelFooter" />
-				  </h:panelGroup>
-				  <h:panelGroup styleClass="msgNav">
-						<h:commandLink action="#{ForumTool.processActionTopicSettings}" id="topic_setting" value="#{msgs.cdfm_topic_settings}"
-						rendered="#{topic.changeSettings}" title=" #{msgs.cdfm_topic_settings}">
+				<h:panelGrid columns="1" summary="layout" width="100%"  styleClass="topicBloc specialLink"  cellspacing="0" cellpadding="0">
+					<h:panelGroup>
+						<h:outputText styleClass="messageNew" value=" #{msgs.cdfm_newflag}"  rendered="#{topic.unreadNoMessages > 0 }" />
+						<h:outputText styleClass="highlight title" id="draft" value="#{msgs.cdfm_draft}" rendered="#{topic.topic.draft == 'true'}"/>
+						<h:outputText id="draft_space" value="  - " rendered="#{topic.topic.draft == 'true'}" styleClass="title"/>
+						<h:graphicImage url="/images/silk/lock.png" alt="#{msgs.cdfm_forum_locked}" rendered="#{ForumTool.selectedForum.forum.locked == 'true' || topic.locked == 'true'}" style="margin-right:.5em"/>
+
+						<h:commandLink action="#{ForumTool.processActionDisplayTopic}" id="topic_title" value="#{topic.topic.title}" title=" #{topic.topic.title}" styleClass="title">
 							<f:param value="#{topic.topic.id}" name="topicId"/>
 							<f:param value="#{ForumTool.selectedForum.forum.id}" name="forumId"/>
 						</h:commandLink>
-				  </h:panelGroup>
-			  </h:panelGrid>
-			<f:verbatim><div class="textPanel"></f:verbatim>  
-			<h:panelGroup><h:outputText id="topic_desc" value="#{topic.topic.shortDescription}" /></h:panelGroup>
-			<f:verbatim></div></f:verbatim>
-			<f:verbatim><div class="textPanel"></f:verbatim>
-			<h:panelGroup styleClass="textPanelFooter specialLink">
-			    	<h:outputLink id="forum_extended_show" value="#" title="#{msgs.cdfm_read_full_description}" styleClass="show" 
-			    		rendered="#{topic.topic.extendedDescription != '' && topic.topic.extendedDescription != null}"
-				  		onclick="resize();$(this).next('.hide').toggle(); $('div.toggle', $(this).parents('div.textPanel')).slideToggle(resize);$(this).toggle();">
-				  		<h:outputText value="#{msgs.cdfm_read_full_description}" />
-				    </h:outputLink>  
-				  
-				    <h:outputLink id="forum_extended_hide" value="#" title="#{msgs.cdfm_hide_full_description}" style="display:none" styleClass="hide" 
-				    	rendered="#{topic.topic.extendedDescription != '' && topic.topic.extendedDescription != null}"
-				  		onclick="resize();$(this).prev('.show').toggle(); $('div.toggle', $(this).parents('div.textPanel')).slideToggle(resize);$(this).toggle();">
-				  		<h:outputText value="#{msgs.cdfm_hide_full_description}" />
-				    </h:outputLink>
-
-				 </h:panelGroup>
-				<%--	gsilver: show the text, not the editor... --%>
-				<h:panelGroup styleClass="textPanel">
-					<f:verbatim><div class="toggle" style="display:none"></f:verbatim>
-					<mf:htmlShowArea  id="topic_fullDescription" hideBorder="true"	 value="#{topic.topic.extendedDescription}" />
-		 			<%--  <sakai:inputRichText rows="5" cols="110" buttonSet="none"  readonly="true" showXPath="false" id="topic_extended_description" value="#{topic.topic.extendedDescription}" rendered="#{topic.readFullDesciption}"/> --%>
-					<f:verbatim></div></f:verbatim>
-				</h:panelGroup>
-				
-				
-			<f:verbatim></div></f:verbatim>
-			
-			<%-- gsilver:need a rendered attribute on this next block - or is this just a forgotten bit of cruft? a placeholder to display responses in context?--%>
-			<%-- %>
-			<h:dataTable id="messages" value="#{topics.messages}" var="message">
-			<h:column>
-				<h:outputText id="message_title" value="#{message.message.title}"/>
-				<f:verbatim><br /></f:verbatim>
-				<h:outputText id="message_desc" value="#{message.message.shortDescription}" />
+						<h:outputText styleClass="textPanelFooter" id="topic_msg_count" value=" #{msgs.cdfm_openb} #{topic.totalNoMessages} #{msgs.cdfm_lowercase_msg} - #{topic.unreadNoMessages} #{msgs.cdfm_unread}" rendered="#{topic.isRead && topic.totalNoMessages == 1}"/>
+						<h:outputText styleClass="textPanelFooter" id="topic_msgs_count" value=" #{msgs.cdfm_openb} #{topic.totalNoMessages} #{msgs.cdfm_lowercase_msgs} - #{topic.unreadNoMessages} #{msgs.cdfm_unread}" rendered="#{topic.isRead && (topic.totalNoMessages > 1 ||  topic.totalNoMessages == 0)}"/>
+						<h:outputText id="topic_moderated" value="#{msgs.cdfm_topic_moderated_flag}" styleClass="textPanelFooter" rendered="#{topic.moderated == 'true'}" />
+						<h:outputText value=" #{msgs.cdfm_closeb}"styleClass="textPanelFooter" />
+						<h:outputText value=" "  styleClass="actionLinks"/>
+						<h:commandLink action="#{ForumTool.processActionTopicSettings}" id="topic_setting" value="#{msgs.cdfm_topic_settings}"
+							rendered="#{topic.changeSettings}" title=" #{msgs.cdfm_topic_settings}">
+								<f:param value="#{topic.topic.id}" name="topicId"/>
+								<f:param value="#{ForumTool.selectedForum.forum.id}" name="forumId"/>
+						</h:commandLink>
+						<h:outputText  value=" | "   rendered="#{topic.changeSettings}" />
+						<h:outputText  value=" Delete "  styleClass="todo" rendered="#{topic.changeSettings}" />						
+						<h:outputText id="topic_desc" value="#{topic.topic.shortDescription}" styleClass="shortDescription" />
+						<h:outputLink id="forum_extended_show" value="#" title="#{msgs.cdfm_read_full_description}" styleClass="show" 
+			    				rendered="#{topic.topic.extendedDescription != '' && topic.topic.extendedDescription != null}"
+								onclick="resize();$(this).next('.hide').toggle(); $('div.toggle', $(this).parents('table.topicBloc')).slideToggle(resize);$(this).toggle();">
+							<h:graphicImage url="/images/collapse.gif" /><h:outputText value="#{msgs.cdfm_read_full_description}" />
+							<h:outputText value=" #{msgs.cdfm_read_full_description_andatts}"  rendered="#{!empty topic.attachList}"/>
+						</h:outputLink>  
+						<h:outputLink id="forum_extended_hide" value="#" title="#{msgs.cdfm_hide_full_description}" style="display:none" styleClass="hide" 
+				    			rendered="#{topic.topic.extendedDescription != '' && topic.topic.extendedDescription != null}"
+								onclick="resize();$(this).prev('.show').toggle(); $('div.toggle', $(this).parents('table.topicBloc')).slideToggle(resize);$(this).toggle();">
+							<h:graphicImage url="/images/expand.gif"/><h:outputText value="#{msgs.cdfm_hide_full_description}" />
+							<h:outputText value=" #{msgs.cdfm_read_full_description_andatts}"  rendered="#{!empty topic.attachList}"/>
+						</h:outputLink>
+					</h:panelGroup>	
+					<h:panelGroup>
+						<f:verbatim><div class="toggle" style="display:none"></f:verbatim>
+							<mf:htmlShowArea  id="topic_fullDescription" hideBorder="true"	 value="#{topic.topic.extendedDescription}" />
+							<%--  <sakai:inputRichText rows="5" cols="110" buttonSet="none"  readonly="true" showXPath="false" id="topic_extended_description" value="#{topic.topic.extendedDescription}" rendered="#{topic.readFullDesciption}"/> --%>
+	
+							<h:dataTable styleClass="listHier" value="#{topic.attachList}" var="eachAttach" rendered="#{!empty topic.attachList}" style="font-size:.9em;width:auto;margin-left:1em" border="0" cellpadding="3" cellspacing="0" columnClasses="attach,bogus" summary="layout">
+								  <h:column>
+									<h:graphicImage url="/images/attachment.gif" />
+									</h:column>
+									<h:column>                                                 
+									<h:outputLink value="#{eachAttach.url}" target="_blank">
+										<h:outputText value="#{eachAttach.attachment.attachmentName}" />
+									</h:outputLink>				  
+								</h:column>
+						  </h:dataTable>
+						<f:verbatim></div></f:verbatim> 
+					</h:panelGroup>
+				</h:panelGrid>
 			</h:column>
-			</h:dataTable>
-			--%>
-				<f:verbatim></div></f:verbatim>
-				</h:column>
 		</h:dataTable>
-		<f:verbatim></div></f:verbatim>
 		<h:inputHidden id="mainOrForumOrTopic" value="dfForumDetail" />
 		<%
   String thisId = request.getParameter("panel");
@@ -155,6 +153,7 @@
   			}
 			</script> 
 	 </h:form>
+	 <h:outputText value="#{msgs.cdfm_insufficient_privileges_view_forum}" rendered="#{ForumTool.selectedForum.forum.draft && ForumTool.selectedForum.forum.createdBy != ForumTool.userId}" />
     </sakai:view>
 </f:view>
 
Index: msgcntr/messageforums-app/src/webapp/jsp/discussionForum/forum/dfForumSettings.jsp
===================================================================
--- msgcntr/messageforums-app/src/webapp/jsp/discussionForum/forum/dfForumSettings.jsp	(revision 46869)
+++ msgcntr/messageforums-app/src/webapp/jsp/discussionForum/forum/dfForumSettings.jsp	(working copy)
@@ -1,198 +1,222 @@
 <%@ page import="java.util.*, javax.faces.context.*, javax.faces.application.*,
-                 javax.faces.el.*, org.sakaiproject.tool.messageforums.*"%>
+		javax.faces.el.*, org.sakaiproject.tool.messageforums.*"%>
 <%@ taglib uri="http://java.sun.com/jsf/html" prefix="h" %>
 <%@ taglib uri="http://java.sun.com/jsf/core" prefix="f" %>
 <%@ taglib uri="http://sakaiproject.org/jsf/sakai" prefix="sakai" %>
 <%@ taglib uri="http://sakaiproject.org/jsf/messageforums" prefix="mf" %>
 <jsp:useBean id="msgs" class="org.sakaiproject.util.ResourceLoader" scope="session">
-   <jsp:setProperty name="msgs" property="baseName" value="org.sakaiproject.api.app.messagecenter.bundle.Messages"/>
+	<jsp:setProperty name="msgs" property="baseName" value="org.sakaiproject.api.app.messagecenter.bundle.Messages"/>
 </jsp:useBean>
 
 <f:view>
-   <sakai:view>
+	<sakai:view>
+	
+		<h:form id="revise">
+		<script type="text/javascript" src="/library/js/jquery.js"></script>
+		<sakai:script contextBase="/sakai-messageforums-tool" path="/js/sak-10625.js"/>
+		<style type="text/css">
+			@import url("/sakai-messageforums-tool/css/msgcntr.css");
+		</style>
 
-      <h:form id="revise">
-             		<script type="text/javascript" src="/library/js/jquery.js"></script>
-       		<sakai:script contextBase="/sakai-messageforums-tool" path="/js/sak-10625.js"/>
-<!--jsp/discussionForum/forum/dfForumSettings.jsp-->
-        <sakai:tool_bar_message value="#{msgs.cdfm_discussion_forum_settings}" />
-         <h:outputText styleClass="alertMessage" value="#{msgs.cdfm_delete_forum}" rendered="#{ForumTool.selectedForum.markForDeletion}"/>	
-
-			<table summary="" class="itemSummary">
-			  <tr>
-			    <th>
-			      <h:outputText value="#{msgs.cdfm_forum_title}"/>	
-				  </th>
-					<td>
-				    <h:outputText id="forum_title"  value="#{ForumTool.selectedForum.forum.title}"/>
-				  </td>
-				</tr>
-         <tr>
-				  <th>
-				    <h:outputText value="#{msgs.cdfm_shortDescription}"/>	
-				  </th>
-				  <td>
-				    <h:outputText id="forum_shortDescription"  value="#{ForumTool.selectedForum.forum.shortDescription}"/>
-				  </td>
-				</tr>
-				<tr>
-				  <th><h:outputText value="#{msgs.cdfm_fullDescription}" />
-				  </th>
-				  <td><mf:htmlShowArea  id="forum_fullDescription" hideBorder="true" value="#{ForumTool.selectedForum.forum.extendedDescription}"/>
-				  </td>
-				</tr>
-   		</table>
-
-			  <h:dataTable value="#{ForumTool.selectedForum.attachList}" var="eachAttach" rendered="#{!empty ForumTool.selectedForum.attachList}" styleClass="listHier" columnClasses="attach,bogus">
-			    <h:column>
-						<h:graphicImage url="/images/excel.gif" rendered="#{eachAttach.attachment.attachmentType == 'application/vnd.ms-excel'}" alt="" />
-						<h:graphicImage url="/images/html.gif" rendered="#{eachAttach.attachment.attachmentType == 'text/html'}" alt="" />
-						<h:graphicImage url="/images/pdf.gif" rendered="#{eachAttach.attachment.attachmentType == 'application/pdf'}" alt="" />
-						<h:graphicImage url="/images/ppt.gif" rendered="#{eachAttach.attachment.attachmentType == 'application/vnd.ms-powerpoint'}" alt="" />
-						<h:graphicImage url="/images/text.gif" rendered="#{eachAttach.attachment.attachmentType == 'text/plain'}" alt="" />
-						<h:graphicImage url="/images/word.gif" rendered="#{eachAttach.attachment.attachmentType == 'application/msword'}" alt="" />
+		<script type="text/javascript">
+			$(document).ready(function(){
+				//fade permission block 
+				$('#permissionReadOnly').fadeTo("fast", 0.50);
+				// and then disable all the inputs/selects in the permission include so as not to confuse people
+				// cannot seem to be able to submit this if these inputs are disabled :-(
+				// $('#permissionReadOnly input, #permissionReadOnly select').attr('disabled', 'disabled');
+				//toggle the long description, hiding the hide link, then toggling the hide, show links and description
+				$('a#hide').hide();
+				$('#toggle').hide();
+				$('a#show,a#hide').click(function(){
+					$('#toggle,a#hide,a#show').toggle();
+					resizeFrame('grow');
+					return false;
+				});
+			});
+		</script>
+		<!--jsp/discussionForum/forum/dfForumSettings.jsp-->
+		<sakai:tool_bar_message value="#{msgs.cdfm_delete_forum_title}" />
+		<%--//designNote: this just feels weird - presenting somehting that sort of looks like the form used to create the forum (with an editable permissions block!) to comfirm deletion --%>
+		<h:outputText styleClass="messageAlert" value="#{msgs.cdfm_delete_forum}" rendered="#{ForumTool.selectedForum.markForDeletion}" style="display:block" />	
+		<table class="forumHeader">
+			<tr>
+				<td>
+				<h:graphicImage url="/images/silk/lock.png" alt="#{msgs.cdfm_forum_locked}" rendered="#{ForumTool.selectedForum.locked=='true'}"  style="margin-right:.3em"/>
+				<h:graphicImage url="/images/silk/lock_open.png" alt="#{msgs.cdfm_forum_locked}" rendered="#{ForumTool.selectedForum.locked=='false'}"  style="margin-right:.3em"/>
+				<span class="title">
+					<h:outputText id="forum_title"  value="#{ForumTool.selectedForum.forum.title}"/>
+				</span>
+				<h:outputText   value="#{msgs.cdfm_openb}"/>
+					<h:outputText   value="#{msgs.cdfm_moderated}"  rendered="#{ForumTool.selectedForum.moderated=='true'}" />
+					<h:outputText   value="#{msgs.cdfm_notmoderated}"  rendered="#{ForumTool.selectedForum.moderated=='false'}" />
+				<h:outputText   value="#{msgs.cdfm_closeb}"/>
+			<p class="textPanel">
+				<h:outputText id="forum_shortDescription"  value="#{ForumTool.selectedForum.forum.shortDescription}"/>
+			</p>
+			<p>
+				<a id="show" class="show"  href="#">
+					<h:graphicImage url="/images/collapse.gif" /><h:outputText   value="#{msgs.cdfm_read_full_description}"/>
+				</a>
+			</p>
+			<p>
+				<a id="hide" class="hide"  href="#">
+					<h:graphicImage url="/images/expand.gif" /><h:outputText   value="#{msgs.cdfm_hide_full_description}"/>
+				</a>
+			</p>
+			<div class="textPanel toggle" id="toggle">
+				<mf:htmlShowArea  id="forum_fullDescription" hideBorder="true" value="#{ForumTool.selectedForum.forum.extendedDescription}"/>
+				<h:dataTable value="#{ForumTool.selectedForum.attachList}" var="eachAttach" rendered="#{!empty ForumTool.selectedForum.attachList}" styleClass="listHier" columnClasses="attach,bogus">
+					<h:column>
+						<h:graphicImage url="/images/attachment.gif"/>
 					</h:column>
-				  <h:column>	
-<%--  				  <h:outputLink value="#{eachAttach.attachmentUrl}" target="_new_window">
-	  				  <h:outputText value="#{eachAttach.attachmentName}"  style="text-decoration:underline;"/>
-		  		  </h:outputLink>--%>
-  				  <h:outputLink value="#{eachAttach.url}" target="_new_window">
-	  				  <h:outputText value="#{eachAttach.attachment.attachmentName}"  style="text-decoration:underline;"/>
-		  		  </h:outputLink>
-			    </h:column>
-			  </h:dataTable>
-	
-    <h4><h:outputText  value="#{msgs.cdfm_forum_posting}"/></h4>
-
-			<h:panelGrid columns="2">
-				<h:panelGroup><h:outputLabel for="lock_forum"  value="#{msgs.cdfm_lock_forum}" styleClass="shorttext"/>	</h:panelGroup>
-				<h:panelGroup>
-					<h:selectOneRadio layout="pageDirection" disabled="true" id="lock_forum"  value="#{ForumTool.selectedForum.locked}">
-    					<f:selectItem itemValue="true" itemLabel="#{msgs.cdfm_yes}"/>
-    					<f:selectItem itemValue="false" itemLabel="#{msgs.cdfm_no}"/>
-  					</h:selectOneRadio>
-				</h:panelGroup>
-				<h:panelGroup><h:outputLabel for="moderate_forum"  value="#{msgs.cdfm_moderate_forum}" styleClass="shorttext"/>	</h:panelGroup>
-				<h:panelGroup>
-					<h:selectOneRadio layout="pageDirection" disabled="true" id="moderate_forum"  value="#{ForumTool.selectedForum.moderated}" styleClass="checkbox inlineForm">
-    					<f:selectItem itemValue="true" itemLabel="#{msgs.cdfm_yes}"/>
-    					<f:selectItem itemValue="false" itemLabel="#{msgs.cdfm_no}"/>
-  					</h:selectOneRadio>
-				</h:panelGroup>
-			</h:panelGrid>
-
+					<h:column>	
+						<%--<h:outputLink value="#{eachAttach.attachmentUrl}" target="_new_window">
+						<h:outputText value="#{eachAttach.attachmentName}"  style="text-decoration:underline;"/>
+						</h:outputLink>--%>
+						<h:outputLink value="#{eachAttach.url}" target="_new_window">
+						<h:outputText value="#{eachAttach.attachment.attachmentName}"  style="text-decoration:underline;"/>
+						</h:outputLink>
+					</h:column>
+				</h:dataTable>
+			</div>
+		</div>	
+		</td>
+		</tr>
+		</table>
+		<%--
+		<h:panelGrid columns="2">
+		<h:panelGroup><h:outputLabel for="lock_forum"  value="#{msgs.cdfm_lock_forum}" styleClass="shorttext"/>	</h:panelGroup>
+		<h:panelGroup>
+		<h:selectOneRadio layout="pageDirection" disabled="true" id="lock_forum"  value="#{ForumTool.selectedForum.locked}">
+		<f:selectItem itemValue="true" itemLabel="#{msgs.cdfm_yes}"/>
+		<f:selectItem itemValue="false" itemLabel="#{msgs.cdfm_no}"/>
+		</h:selectOneRadio>
+		</h:panelGroup>
+		<h:panelGroup><h:outputLabel for="moderate_forum"  value="#{msgs.cdfm_moderate_forum}" styleClass="shorttext"/>	</h:panelGroup>
+		<h:panelGroup>
+		<h:selectOneRadio layout="pageDirection" disabled="true" id="moderate_forum"  value="#{ForumTool.selectedForum.moderated}" styleClass="checkbox inlineForm">
+		<f:selectItem itemValue="true" itemLabel="#{msgs.cdfm_yes}"/>
+		<f:selectItem itemValue="false" itemLabel="#{msgs.cdfm_no}"/>
+		</h:selectOneRadio>
+		</h:panelGroup>
+		</h:panelGrid>
+		--%>
+		<%--
+		<mf:forumHideDivision title="#{msgs.cdfm_access}" id="access_perm" hideByDefault="true">
+		<p class="shorttext">
+		<h:panelGrid columns="2" width="50%">
+		<h:panelGroup><h:outputLabel id="outputLabelCont" for="contributors"  value="#{msgs.cdfm_contributors}"/>	</h:panelGroup>
+		<h:panelGroup>
+		<h:selectManyListbox  id="contributors" disabled ="true" value="#{ForumTool.selectedForum.contributorsList}" size="5" style="width:200px;">
+		<f:selectItems value="#{ForumTool.totalComposeToList}" />
+		</h:selectManyListbox> 
+		</h:panelGroup>
 		
-     <%--
-	 <mf:forumHideDivision title="#{msgs.cdfm_access}" id="access_perm" hideByDefault="true">
-      <p class="shorttext">
-		<h:panelGrid columns="2" width="50%">
-				<h:panelGroup><h:outputLabel id="outputLabelCont" for="contributors"  value="#{msgs.cdfm_contributors}"/>	</h:panelGroup>
-				<h:panelGroup>
-					<h:selectManyListbox  id="contributors" disabled ="true" value="#{ForumTool.selectedForum.contributorsList}" size="5" style="width:200px;">
-    					<f:selectItems value="#{ForumTool.totalComposeToList}" />
-  					</h:selectManyListbox> 
-				</h:panelGroup>
-
-			  <h:panelGroup><h:outputLabel id="outputLabelRead" for="readOnly"  value="#{msgs.cdfm_read_only_access}"/>	</h:panelGroup>
-				<h:panelGroup>
-					<h:selectManyListbox  disabled ="true" id="readOnly"  value="#{ForumTool.selectedForum.accessorList}" size="5" style="width:200px;">
-    					<f:selectItems value="#{ForumTool.totalComposeToList}"  />
-  					</h:selectManyListbox>
-				</h:panelGroup>
+		<h:panelGroup><h:outputLabel id="outputLabelRead" for="readOnly"  value="#{msgs.cdfm_read_only_access}"/>	</h:panelGroup>
+		<h:panelGroup>
+		<h:selectManyListbox  disabled ="true" id="readOnly"  value="#{ForumTool.selectedForum.accessorList}" size="5" style="width:200px;">
+		<f:selectItems value="#{ForumTool.totalComposeToList}"  />
+		</h:selectManyListbox>
+		</h:panelGroup>
 		</h:panelGrid>
-	  </p>
-	   </mf:forumHideDivision>
-	   	  	   	   	   
-      
-      <mf:forumHideDivision title="#{msgs.cdfm_control_permissions}" id="cntrl_perm" hideByDefault="true">
-          <h:dataTable styleClass="listHier" id="control_permissions" value="#{ForumTool.forumControlPermissions}" var="cntrl_settings">
-   			<h:column>
-				<f:facet name="header"><h:outputText value="#{msgs.perm_role}" /></f:facet>
-				<h:outputText value="#{cntrl_settings.role}"/>
-			</h:column>
- 			<h:column>
-				<f:facet name="header"><h:outputText value="#{msgs.perm_new_topic}" /></f:facet>
-				<h:selectBooleanCheckbox disabled="true" value="#{cntrl_settings.newTopic}"/>
-			</h:column>
-			<h:column>
-				<f:facet name="header"><h:outputText value="#{msgs.perm_new_response}" /></f:facet>
-				<h:selectBooleanCheckbox disabled="true" value="#{cntrl_settings.newResponse}"/>
-			</h:column>
-			<h:column>
-				<f:facet name="header"><h:outputText value="#{msgs.perm_response_to_response}" /></f:facet>
-				<h:selectBooleanCheckbox disabled="true" value="#{cntrl_settings.responseToResponse}"/>
-			</h:column>
-			<h:column>
-				<f:facet name="header">	<h:outputText value="#{msgs.perm_move_postings}" /></f:facet>
-				<h:selectBooleanCheckbox disabled="true" value="#{cntrl_settings.movePostings}"/>
-			</h:column>
-			<h:column>
-				<f:facet name="header"><h:outputText value="#{msgs.perm_change_settings}" /></f:facet>
-				<h:selectBooleanCheckbox disabled="true" value="#{cntrl_settings.changeSettings}"/>
-			</h:column>
-			<h:column>
-				<f:facet name="header"><h:outputText value="#{msgs.perm_post_to_gradebook}" /></f:facet>
-				<h:selectBooleanCheckbox disabled="true" value="#{cntrl_settings.postToGradebook}"/>
-			</h:column>
+		</p>
+		</mf:forumHideDivision>
+		
+		
+		<mf:forumHideDivision title="#{msgs.cdfm_control_permissions}" id="cntrl_perm" hideByDefault="true">
+		<h:dataTable styleClass="listHier" id="control_permissions" value="#{ForumTool.forumControlPermissions}" var="cntrl_settings">
+		<h:column>
+		<f:facet name="header"><h:outputText value="#{msgs.perm_role}" /></f:facet>
+		<h:outputText value="#{cntrl_settings.role}"/>
+		</h:column>
+		<h:column>
+		<f:facet name="header"><h:outputText value="#{msgs.perm_new_topic}" /></f:facet>
+		<h:selectBooleanCheckbox disabled="true" value="#{cntrl_settings.newTopic}"/>
+		</h:column>
+		<h:column>
+		<f:facet name="header"><h:outputText value="#{msgs.perm_new_response}" /></f:facet>
+		<h:selectBooleanCheckbox disabled="true" value="#{cntrl_settings.newResponse}"/>
+		</h:column>
+		<h:column>
+		<f:facet name="header"><h:outputText value="#{msgs.perm_response_to_response}" /></f:facet>
+		<h:selectBooleanCheckbox disabled="true" value="#{cntrl_settings.responseToResponse}"/>
+		</h:column>
+		<h:column>
+		<f:facet name="header">	<h:outputText value="#{msgs.perm_move_postings}" /></f:facet>
+		<h:selectBooleanCheckbox disabled="true" value="#{cntrl_settings.movePostings}"/>
+		</h:column>
+		<h:column>
+		<f:facet name="header"><h:outputText value="#{msgs.perm_change_settings}" /></f:facet>
+		<h:selectBooleanCheckbox disabled="true" value="#{cntrl_settings.changeSettings}"/>
+		</h:column>
+		<h:column>
+		<f:facet name="header"><h:outputText value="#{msgs.perm_post_to_gradebook}" /></f:facet>
+		<h:selectBooleanCheckbox disabled="true" value="#{cntrl_settings.postToGradebook}"/>
+		</h:column>
 		</h:dataTable>
-      </mf:forumHideDivision>
-      <mf:forumHideDivision title="#{msgs.cdfm_message_permissions}" id="msg_perm" hideByDefault="true">
-     	 <h:dataTable styleClass="listHier" id="message_permissions" value="#{ForumTool.forumMessagePermissions}" var="msg_settings">
-   			<h:column>
-				<f:facet name="header"><h:outputText value="#{msgs.perm_role}" /></f:facet>
-				<h:outputText value="#{msg_settings.role}"/>
-			</h:column>
-			 <h:column>
-				<f:facet name="header"><h:outputText value="#{msgs.perm_read}" /></f:facet>
-				<h:selectBooleanCheckbox disabled="true" value="#{msg_settings.read}"/>
-			</h:column>
-			<h:column>
-				<f:facet name="header"><h:outputText value="#{msgs.perm_revise_any}" /></f:facet>
-				<h:selectBooleanCheckbox disabled="true" value="#{msg_settings.reviseAny}"/>
-			</h:column>
-			<h:column>
-				<f:facet name="header">	<h:outputText value="#{msgs.perm_revise_own}" /></f:facet>
-				<h:selectBooleanCheckbox disabled="true" value="#{msg_settings.reviseOwn}"/>
-			</h:column>
-			<h:column>
-				<f:facet name="header"><h:outputText value="#{msgs.perm_delete_any}" /></f:facet>
-				<h:selectBooleanCheckbox disabled="true" value="#{msg_settings.deleteAny}"/>
-			</h:column>
-			<h:column>
-				<f:facet name="header">	<h:outputText value="#{msgs.perm_delete_own}" /></f:facet>
-				<h:selectBooleanCheckbox disabled="true" value="#{msg_settings.deleteOwn}"/>
-			</h:column>
-			<h:column>
-				<f:facet name="header"><h:outputText value="#{msgs.perm_mark_as_read}" /></f:facet>
-				<h:selectBooleanCheckbox disabled="true" value="#{msg_settings.markAsRead}"/>
-			</h:column>			 		
+		</mf:forumHideDivision>
+		<mf:forumHideDivision title="#{msgs.cdfm_message_permissions}" id="msg_perm" hideByDefault="true">
+		<h:dataTable styleClass="listHier" id="message_permissions" value="#{ForumTool.forumMessagePermissions}" var="msg_settings">
+		<h:column>
+		<f:facet name="header"><h:outputText value="#{msgs.perm_role}" /></f:facet>
+		<h:outputText value="#{msg_settings.role}"/>
+		</h:column>
+		<h:column>
+		<f:facet name="header"><h:outputText value="#{msgs.perm_read}" /></f:facet>
+		<h:selectBooleanCheckbox disabled="true" value="#{msg_settings.read}"/>
+		</h:column>
+		<h:column>
+		<f:facet name="header"><h:outputText value="#{msgs.perm_revise_any}" /></f:facet>
+		<h:selectBooleanCheckbox disabled="true" value="#{msg_settings.reviseAny}"/>
+		</h:column>
+		<h:column>
+		<f:facet name="header">	<h:outputText value="#{msgs.perm_revise_own}" /></f:facet>
+		<h:selectBooleanCheckbox disabled="true" value="#{msg_settings.reviseOwn}"/>
+		</h:column>
+		<h:column>
+		<f:facet name="header"><h:outputText value="#{msgs.perm_delete_any}" /></f:facet>
+		<h:selectBooleanCheckbox disabled="true" value="#{msg_settings.deleteAny}"/>
+		</h:column>
+		<h:column>
+		<f:facet name="header">	<h:outputText value="#{msgs.perm_delete_own}" /></f:facet>
+		<h:selectBooleanCheckbox disabled="true" value="#{msg_settings.deleteOwn}"/>
+		</h:column>
+		<h:column>
+		<f:facet name="header"><h:outputText value="#{msgs.perm_mark_as_read}" /></f:facet>
+		<h:selectBooleanCheckbox disabled="true" value="#{msg_settings.markAsRead}"/>
+		</h:column>			 		
 		</h:dataTable>		 	
-      </mf:forumHideDivision>
-      --%>
-      <%@include file="/jsp/discussionForum/permissions/permissions_include.jsp"%>
-      
-       <div class="act">
-          <h:commandButton id ="revise" rendered="#{!ForumTool.selectedForum.markForDeletion}" 
-                           immediate="true"  action="#{ForumTool.processActionReviseForumSettings}" 
-                           value="#{msgs.cdfm_button_bar_revise}" accesskey="r"> 
-    	 	  	<f:param value="#{ForumTool.selectedForum.forum.id}" name="forumId"/>    	 	  	
-          </h:commandButton>
-          
-          <h:commandButton id="delete_confirm" action="#{ForumTool.processActionDeleteForumConfirm}" 
-                           value="#{msgs.cdfm_button_bar_delete}" rendered="#{!ForumTool.selectedForum.markForDeletion}"
-                           accesskey="">
-	        	<f:param value="#{ForumTool.selectedForum.forum.id}" name="forumId"/>
-          </h:commandButton>
-          
-          <h:commandButton id="delete" action="#{ForumTool.processActionDeleteForum}" 
-                           value="#{msgs.cdfm_button_bar_delete}" rendered="#{ForumTool.selectedForum.markForDeletion}"
-                           accesskey="">
-	        	<f:param value="#{ForumTool.selectedForum.forum.id}" name="forumId"/>
-          </h:commandButton>
-          
-          <h:commandButton id="cancel" immediate="true" action="#{ForumTool.processReturnToOriginatingPage}" 
-                           value="#{msgs.cdfm_button_bar_cancel}" accesskey="x" />
-       </div>
-	 </h:form>
-    </sakai:view>
+		</mf:forumHideDivision>
+		--%>
+		<div id="permissionReadOnlyW">
+		<div id="permissionReadOnly">	
+			<%@include file="/jsp/discussionForum/permissions/permissions_include.jsp"%>
+		</div>	
+		</div>
+		
+		<div class="act">
+		<h:commandButton id ="revise" rendered="#{!ForumTool.selectedForum.markForDeletion}" 
+		immediate="true"  action="#{ForumTool.processActionReviseForumSettings}" 
+		value="#{msgs.cdfm_button_bar_revise}" accesskey="r"> 
+		<f:param value="#{ForumTool.selectedForum.forum.id}" name="forumId"/>    	 	  	
+		</h:commandButton>
+		
+		<h:commandButton id="delete_confirm" action="#{ForumTool.processActionDeleteForumConfirm}" 
+		value="#{msgs.cdfm_button_bar_delete}" rendered="#{!ForumTool.selectedForum.markForDeletion}"
+		accesskey="">
+		<f:param value="#{ForumTool.selectedForum.forum.id}" name="forumId"/>
+		</h:commandButton>
+		
+		<h:commandButton id="delete" action="#{ForumTool.processActionDeleteForum}" 
+		value="#{msgs.cdfm_button_bar_delete}" rendered="#{ForumTool.selectedForum.markForDeletion}"
+		accesskey="">
+		<f:param value="#{ForumTool.selectedForum.forum.id}" name="forumId"/>
+		</h:commandButton>
+		
+		<h:commandButton id="cancel" immediate="true" action="#{ForumTool.processReturnToOriginatingPage}" 
+		value="#{msgs.cdfm_button_bar_cancel}" accesskey="x" />
+		</div>
+		</h:form>
+	</sakai:view>
 </f:view>
Index: msgcntr/messageforums-app/src/webapp/jsp/discussionForum/statistics/dfStatisticsList.jsp
===================================================================
--- msgcntr/messageforums-app/src/webapp/jsp/discussionForum/statistics/dfStatisticsList.jsp	(revision 46869)
+++ msgcntr/messageforums-app/src/webapp/jsp/discussionForum/statistics/dfStatisticsList.jsp	(working copy)
@@ -12,14 +12,14 @@
        		<sakai:script contextBase="/sakai-messageforums-tool" path="/js/sak-10625.js"/>
   		<h:panelGrid columns="1" summary="layout" width="100%" styleClass="navPanel  specialLink">
           <h:panelGroup>
-          	 <f:verbatim><div class="breadCrumb"><h3></f:verbatim>
+          	 <f:verbatim><h3></f:verbatim>
 			      <h:commandLink action="#{ForumTool.processActionHome}" value="#{msgs.cdfm_message_forums}" title=" #{msgs.cdfm_message_forums}"
 			      		rendered="#{ForumTool.messagesandForums}" />
 			      <h:commandLink action="#{ForumTool.processActionHome}" value="#{msgs.cdfm_discussion_forums}" title=" #{msgs.cdfm_discussion_forums}"
 			      		rendered="#{ForumTool.forumsTool}" />
 			      <f:verbatim><h:outputText value=" " /><h:outputText value=" / " /><h:outputText value=" " /></f:verbatim>
 			      <h:outputText value="#{msgs.stat_list}" />
-			    <f:verbatim></h3></div></f:verbatim>
+			    <f:verbatim></h3></f:verbatim>
           </h:panelGroup>
         </h:panelGrid>
   	
Index: msgcntr/messageforums-app/src/webapp/jsp/discussionForum/statistics/dfStatisticsUser.jsp
===================================================================
--- msgcntr/messageforums-app/src/webapp/jsp/discussionForum/statistics/dfStatisticsUser.jsp	(revision 46869)
+++ msgcntr/messageforums-app/src/webapp/jsp/discussionForum/statistics/dfStatisticsUser.jsp	(working copy)
@@ -13,7 +13,7 @@
   	
   		<h:panelGrid columns="1" summary="layout" width="100%" styleClass="navPanel  specialLink">
           <h:panelGroup>
-          	 <f:verbatim><div class="breadCrumb"><h3></f:verbatim>
+          	 <f:verbatim><h3></f:verbatim>
 			      <h:commandLink action="#{ForumTool.processActionHome}" value="#{msgs.cdfm_message_forums}" title=" #{msgs.cdfm_message_forums}"
 			      		rendered="#{ForumTool.messagesandForums}" />
 			      <h:commandLink action="#{ForumTool.processActionHome}" value="#{msgs.cdfm_discussion_forums}" title=" #{msgs.cdfm_discussion_forums}"
@@ -22,7 +22,7 @@
 			      <h:commandLink action="#{ForumTool.processActionStatistics}" value="#{msgs.stat_list}" title="#{msgs.stat_list}"/>
 			      <f:verbatim><h:outputText value=" " /><h:outputText value=" / " /><h:outputText value=" " /></f:verbatim>
 			      <h:outputText value="#{mfStatisticsBean.selectedSiteUser}" />
-			    <f:verbatim></h3></div></f:verbatim>
+			    <f:verbatim></div></f:verbatim>
           </h:panelGroup>
         </h:panelGrid>
     	
Index: msgcntr/messageforums-app/src/webapp/jsp/discussionForum/permissions/permissions_include.jsp
===================================================================
--- msgcntr/messageforums-app/src/webapp/jsp/discussionForum/permissions/permissions_include.jsp	(revision 46869)
+++ msgcntr/messageforums-app/src/webapp/jsp/discussionForum/permissions/permissions_include.jsp	(working copy)
@@ -6,144 +6,146 @@
     DiscussionForumTool dft = (DiscussionForumTool) binding.getValue(context);
     out.print(dft.generatePermissionScript());
 %>
-       		<script type="text/javascript" src="/library/js/jquery.js"></script>
-       		<sakai:script contextBase="/sakai-messageforums-tool" path="/js/sak-10625.js"/>
+<script type="text/javascript" src="/library/js/jquery.js"></script>
+<sakai:script contextBase="/sakai-messageforums-tool" path="/js/sak-10625.js"/>
 <sakai:script contextBase="/sakai-messageforums-tool" path="/js/permissions_header.js"/>
 <sakai:script contextBase="/sakai-messageforums-tool" path="/js/forum.js"/>
 <!--jsp/discussionForum/permissions/permissions_include.jsp-->
 <mf:forumHideDivision title="#{msgs.cdfm_permissions}" id="cntrl_perm" hideByDefault="false" >
+	<%--role picker pane--%>
+	<h:panelGrid  columns="2" summary="layout" style="margin:.5em 0;" styleClass="jsfFormTable">
+		<h:panelGroup styleClass="shorttext">
+			<h:outputLabel for="role" >
+				<h:outputText value="#{msgs.perm_role_label}" />
+			</h:outputLabel>
+		</h:panelGroup>
+		<h:panelGroup>
+			<h:selectOneListbox size="1" id="role" value ="#{ForumTool.selectedRole}" onchange="javascript:displayRelevantBlock();">
+				<f:selectItems value="#{ForumTool.siteRoles}"/>
+			</h:selectOneListbox>
+		</h:panelGroup>
+	</h:panelGrid>
+	<%--
+	<f:verbatim><p class="act"></f:verbatim>
+		<h:commandButton immediate="true" action="#{ForumTool.processActionAddGroupsUsers}" value="#{msgs.cdfm_button_bar_add_groups_users}" rendered="#{ForumTool.editMode}"/> 
+	<f:verbatim><p/></f:verbatim>
+	--%>
+	<%
+		String thisId = request.getParameter("panel");
+		if (thisId == null) 
+		{
+		thisId = "Main" + org.sakaiproject.tool.cover.ToolManager.getCurrentPlacement().getId();
+	}
+	
+	%>
+	<script type="text/javascript">
+		setPanelId('<%= org.sakaiproject.util.Web.escapeJavascript(thisId)%>');
+	</script>   
 
-  <h:panelGrid  columns="2" summary="layout">
-	  <h:panelGroup styleClass="shorttext">
-	    <h:outputLabel for="role" ><h:outputText value="#{msgs.perm_role_label}" /></h:outputLabel>
-	  </h:panelGroup>
-	  <h:panelGroup>
-	    <h:selectOneListbox size="4" id="role" value ="#{ForumTool.selectedRole}" onchange="javascript:displayRelevantBlock();">
-	      <f:selectItems value="#{ForumTool.siteRoles}"/>
-	    </h:selectOneListbox>
-	  </h:panelGroup>
+	<h:dataTable id="perm" value="#{ForumTool.permissions}" var="permission" cellpadding="0" cellspacing="0" styleClass="jsfFormTable">
+		<h:column>
+			<h:panelGrid id="permissionSet"  columns="2" summary="layout"  styleClass="permissionPanel jsfFormTable lines nolines" cellpadding="0" cellspacing="0" rowClasses="blank exclude, header, colored,colored,colored,colored,colored,colored  last " columnClasses="first, second" >   
+				<%--permission level picker pane--%>
+					<h:panelGroup styleClass="shorttext">
+						<h:outputLabel for="level"><h:outputText value="#{msgs.perm_level}" /></h:outputLabel>
+					</h:panelGroup>
+					<h:panelGroup style="padding-left:5px">
+						<h:selectOneMenu id="level" value="#{permission.selectedLevel}" onchange="javascript:setCorrespondingCheckboxes(this.id);"  disabled="#{not ForumTool.editMode}">
+							<f:selectItems value="#{ForumTool.levels}"/>
+						</h:selectOneMenu>
+					</h:panelGroup>	
+				<%--permission level picker pane end--%>	
+				<%--specific permission picker pane label  begin--%>	
+					<h:panelGroup>	
+						<h:outputText value="#{msgs.perm_custom}" />
+					</h:panelGroup>
+					<h:panelGroup>
+						<h:outputText value=" "/>
+					</h:panelGroup>
+				<%--specific permission picker pane label  end--%>	
+				<%--specific permission  pane grid start--%>
+					<h:panelGroup styleClass="checkbox">
+						<h:selectBooleanCheckbox id="newForum" onclick="javascript:setCorrespondingLevel(this.id);" value="#{permission.newForum}" disabled="#{not ForumTool.editMode || ForumTool.permissionMode != 'template'}"/>
+						<h:outputLabel for="newForum"><h:outputText  value="#{msgs.perm_new_forum}" /></h:outputLabel>
+					</h:panelGroup>
+					<h:panelGroup styleClass="checkbox">
+						<h:selectBooleanCheckbox id="changeSetting" value="#{permission.changeSettings}" onclick="javascript:setCorrespondingLevel(this.id);" disabled="#{not ForumTool.editMode}"/>
+						<h:outputLabel for="changeSetting"><h:outputText value="#{msgs.perm_change_settings}" /></h:outputLabel>
+					</h:panelGroup>
+					<h:panelGroup styleClass="checkbox">
+						<h:selectBooleanCheckbox id="newTopic" onclick="javascript:setCorrespondingLevel(this.id);" value="#{permission.newTopic}" disabled="#{not ForumTool.editMode || ForumTool.permissionMode == 'topic'}"/>
+						<h:outputLabel for="newTopic"><h:outputText value="#{msgs.perm_new_topic}" /></h:outputLabel>
+					</h:panelGroup>        
+					<h:panelGroup styleClass="checkbox">
+						<h:selectBooleanCheckbox id="read" onclick="javascript:setCorrespondingLevel(this.id);" value="#{permission.read}"  disabled="#{not ForumTool.editMode}"/>
+						<h:outputLabel for="read"><h:outputText value="#{msgs.perm_read}" /></h:outputLabel>
+					</h:panelGroup>
+					<h:panelGroup styleClass="checkbox">
+						<h:selectBooleanCheckbox  id="newR" value="#{permission.newResponse}" onclick="javascript:setCorrespondingLevel(this.id);"  disabled="#{not ForumTool.editMode}"/>
+						<h:outputLabel for="newR"><h:outputText value="#{msgs.perm_new_response}" /></h:outputLabel>
+					</h:panelGroup>
+					<h:panelGroup styleClass="checkbox">
+						<h:selectBooleanCheckbox id="markAsRead" value="#{permission.markAsRead}" onclick="javascript:setCorrespondingLevel(this.id);"  disabled="#{not ForumTool.editMode}"/>
+						<h:outputLabel for="markAsRead"><h:outputText value="#{msgs.perm_mark_as_read}" /></h:outputLabel>
+					</h:panelGroup>
+					<h:panelGroup styleClass="checkbox">
+						<h:selectBooleanCheckbox id="newRtoR"  value="#{permission.responseToResponse}" onclick="javascript:setCorrespondingLevel(this.id);" disabled="#{not ForumTool.editMode}"/>
+						<h:outputLabel for="newRtoR"><h:outputText value="#{msgs.perm_response_to_response}" /></h:outputLabel>
+					</h:panelGroup>  
+					<h:panelGroup styleClass="checkbox">
+						<h:selectBooleanCheckbox id="moderatePostings" value="#{permission.moderatePostings}" onclick="javascript:setCorrespondingLevel(this.id);" disabled="#{(not ForumTool.editMode) || ForumTool.disableModeratePerm}"/>
+						<h:outputLabel for="moderatePostings"><h:outputText value="#{msgs.perm_moderate_postings}" /></h:outputLabel>
+					</h:panelGroup>
+					<h:panelGroup styleClass="checkbox">
+						<h:selectBooleanCheckbox id="postGrades" rendered="#{ForumTool.gradebookExist}" onclick="javascript:setCorrespondingLevel(this.id);" value="#{permission.postToGradebook}" disabled="#{not ForumTool.editMode}"/>
+						<h:outputLabel for="postGrades" rendered="#{ForumTool.gradebookExist}"><h:outputText rendered="#{ForumTool.gradebookExist}" value="#{msgs.perm_post_to_gradebook}" /></h:outputLabel>
+					</h:panelGroup>
+					<h:panelGroup>
+						<h:outputText value="" />
+					</h:panelGroup>
+					<h:panelGroup>
+						<h:outputText value="#{msgs.perm_revise_postings}" style="display:block;padding:.3em;margin:0  "/>
+						<h:selectOneRadio id="revisePostings" value="#{permission.revisePostings}"  layout="pageDirection"  onclick="setCorrespondingLevel(this.name);"  disabled="#{not ForumTool.editMode}" styleClass="selectOneRadio" >
+							<f:selectItems   value="#{ForumTool.postingOptions}" />
+						</h:selectOneRadio>
+					</h:panelGroup>
+					<h:panelGroup>
+						<h:outputText  value="#{msgs.perm_delete_postings}" style="display:block;padding:.3em;margin:0"/>	
+						<h:selectOneRadio id="deletePostings" value="#{permission.deletePostings}"  layout="pageDirection"  onclick="setCorrespondingLevel(this.name);"  disabled="#{not ForumTool.editMode}" styleClass="selectOneRadio">
+							<f:selectItems   value="#{ForumTool.postingOptions}" />
+						</h:selectOneRadio>      
+					</h:panelGroup>
+				<%--specific permission  pane grid end--%>	
+			</h:panelGrid>
+				<%--<h:selectBooleanCheckbox id="movePosting" value="#{permission.movePosting}" onclick="javascript:setCorrespondingLevel(this.id);" disabled="#{not ForumTool.editMode}"/>
+				<h:outputText value="#{msgs.perm_move_postings}" />
+				--%>
+				<%--<h:selectBooleanCheckbox id="moderatePostings"  value="#{permission.moderatePostings}" onclick="javascript:setCorrespondingLevel(this.id);"  disabled="#{not ForumTool.editMode}"/>
+				<h:outputText value="#{msgs.perm_moderate_postings}" />
+				--%>
+		</h:column>
+	</h:dataTable>
+  	<%--designNote: gradebook assignment - need to finesse this - make aware that functionality exists, but flag that there are no gb assignmetns to select --%>
+	<%--designNote:  How is this a "permission" item? --%>  
+	<h:panelGrid columns="2" summary="layout" rendered="#{ForumTool.gradebookExist &&  ForumTool.permissionMode == 'forum'}" style="margin-top:.5em;clear:both">
+		<h:panelGroup styleClass="shorttext">
+			<h:outputLabel for="forum_assignments" value="#{msgs.perm_choose_assignment}"></h:outputLabel>  
+		</h:panelGroup>
+		<h:panelGroup>
+			<h:selectOneMenu id="forum_assignments" value="#{ForumTool.selectedForum.gradeAssign}" disabled="#{not ForumTool.editMode}">
+				<f:selectItems value="#{ForumTool.assignments}" />
+			</h:selectOneMenu>
+		</h:panelGroup>
 	</h:panelGrid>
-  <%--
-  <f:verbatim><p class="act"></f:verbatim>
-    <h:commandButton immediate="true" action="#{ForumTool.processActionAddGroupsUsers}" value="#{msgs.cdfm_button_bar_add_groups_users}" rendered="#{ForumTool.editMode}"/> 
-  <f:verbatim><p/></f:verbatim>
-  --%>
-<%
-  String thisId = request.getParameter("panel");
-  if (thisId == null) 
-  {
-    thisId = "Main" + org.sakaiproject.tool.cover.ToolManager.getCurrentPlacement().getId();
-  }
-
-%>
-<script type="text/javascript">
-  setPanelId('<%= org.sakaiproject.util.Web.escapeJavascript(thisId)%>');
-</script>   
-
-  <h:dataTable id="perm" value="#{ForumTool.permissions}" var="permission" cellpadding="0" cellspacing="0" >
-    <h:column>
-      <h:panelGrid id="permissionSet"  columns="2" summary="layout">   
-        <h:panelGroup styleClass="shorttext">
-          <h:outputLabel for="level"><h:outputText value="#{msgs.perm_level}" /></h:outputLabel>
-        </h:panelGroup> 
-        <h:panelGroup> 
-          <h:selectOneMenu id="level" value="#{permission.selectedLevel}" onchange="javascript:setCorrespondingCheckboxes(this.id);"  disabled="#{not ForumTool.editMode}">
-            <f:selectItems value="#{ForumTool.levels}"/>
-          </h:selectOneMenu>
-        </h:panelGroup>
-                
-        <h:panelGroup styleClass="checkbox" >
-          <h:selectBooleanCheckbox id="newForum" onclick="javascript:setCorrespondingLevel(this.id);" value="#{permission.newForum}" disabled="#{not ForumTool.editMode || ForumTool.permissionMode != 'template'}"/>
-          <h:outputLabel for="newForum"><h:outputText  value="#{msgs.perm_new_forum}" /></h:outputLabel>    
-        </h:panelGroup>
-        <h:panelGroup styleClass="checkbox">
-          <h:selectBooleanCheckbox id="changeSetting" value="#{permission.changeSettings}" onclick="javascript:setCorrespondingLevel(this.id);" disabled="#{not ForumTool.editMode}"/>
-          <h:outputLabel for="changeSetting"><h:outputText value="#{msgs.perm_change_settings}" /></h:outputLabel>
-        </h:panelGroup>
-        
-        <h:panelGroup styleClass="checkbox">
-          <h:selectBooleanCheckbox id="newTopic" onclick="javascript:setCorrespondingLevel(this.id);" value="#{permission.newTopic}" disabled="#{not ForumTool.editMode || ForumTool.permissionMode == 'topic'}"/>
-          <h:outputLabel for="newTopic"><h:outputText value="#{msgs.perm_new_topic}" /></h:outputLabel>
-        </h:panelGroup>        
-        <h:panelGroup styleClass="checkbox">
-          <h:selectBooleanCheckbox id="read" onclick="javascript:setCorrespondingLevel(this.id);" value="#{permission.read}"  disabled="#{not ForumTool.editMode}"/>
-          <h:outputLabel for="read"><h:outputText value="#{msgs.perm_read}" /></h:outputLabel>
-        </h:panelGroup>
-
-        <h:panelGroup styleClass="checkbox">
-          <h:selectBooleanCheckbox  id="newR" value="#{permission.newResponse}" onclick="javascript:setCorrespondingLevel(this.id);"  disabled="#{not ForumTool.editMode}"/>
-          <h:outputLabel for="newR"><h:outputText value="#{msgs.perm_new_response}" /></h:outputLabel>
-        </h:panelGroup>
-         <h:panelGroup styleClass="checkbox">
-          <h:selectBooleanCheckbox id="markAsRead" value="#{permission.markAsRead}" onclick="javascript:setCorrespondingLevel(this.id);"  disabled="#{not ForumTool.editMode}"/>
-          <h:outputLabel for="markAsRead"><h:outputText value="#{msgs.perm_mark_as_read}" /></h:outputLabel>
-        </h:panelGroup>
-        
-        <h:panelGroup styleClass="checkbox">
-          <h:selectBooleanCheckbox id="newRtoR"  value="#{permission.responseToResponse}" onclick="javascript:setCorrespondingLevel(this.id);" disabled="#{not ForumTool.editMode}"/>
-          <h:outputLabel for="newRtoR"><h:outputText value="#{msgs.perm_response_to_response}" /></h:outputLabel>
-        </h:panelGroup>  
-        <h:panelGroup styleClass="checkbox">
-          <h:selectBooleanCheckbox id="moderatePostings" value="#{permission.moderatePostings}" onclick="javascript:setCorrespondingLevel(this.id);" disabled="#{(not ForumTool.editMode) || ForumTool.disableModeratePerm}"/>
-          <h:outputLabel for="moderatePostings"><h:outputText value="#{msgs.perm_moderate_postings}" /></h:outputLabel>
-        </h:panelGroup>
-        
-        <h:panelGroup styleClass="checkbox">
-          <h:selectBooleanCheckbox id="postGrades" rendered="#{ForumTool.gradebookExist}" onclick="javascript:setCorrespondingLevel(this.id);" value="#{permission.postToGradebook}" disabled="#{not ForumTool.editMode}"/>
-          <h:outputLabel for="postGrades" rendered="#{ForumTool.gradebookExist}"><h:outputText rendered="#{ForumTool.gradebookExist}" value="#{msgs.perm_post_to_gradebook}" /></h:outputLabel>
-        </h:panelGroup>
-        <h:panelGroup>
-        	<h:outputText value="" />
-        </h:panelGroup>
-        
-        <h:panelGroup>
-          <h:outputLabel for="revisePostings"><h:outputText value="#{msgs.perm_revise_postings}" /></h:outputLabel>
-        </h:panelGroup>       
-        <h:panelGroup>
-          <h:selectOneRadio id="revisePostings" value="#{permission.revisePostings}"  layout="pageDirection"  onclick="setCorrespondingLevel(this.name);"  disabled="#{not ForumTool.editMode}" styleClass="checkbox inlineForm">
-		        <f:selectItems   value="#{ForumTool.postingOptions}" />
-		      </h:selectOneRadio>
-        </h:panelGroup> 
-
-				<h:outputLabel for="deletePostings" value="#{msgs.perm_delete_postings}" />	
-		    <h:selectOneRadio id="deletePostings" value="#{permission.deletePostings}"  layout="pageDirection"  onclick="setCorrespondingLevel(this.name);"  disabled="#{not ForumTool.editMode}" styleClass="checkbox inlineForm">
-				  <f:selectItems   value="#{ForumTool.postingOptions}" />
-				</h:selectOneRadio>      
-        
-      </h:panelGrid>
-         
-
-		<%--<h:selectBooleanCheckbox id="movePosting" value="#{permission.movePosting}" onclick="javascript:setCorrespondingLevel(this.id);" disabled="#{not ForumTool.editMode}"/>
-		<h:outputText value="#{msgs.perm_move_postings}" />
-		--%>
-
-		<%--<h:selectBooleanCheckbox id="moderatePostings"  value="#{permission.moderatePostings}" onclick="javascript:setCorrespondingLevel(this.id);"  disabled="#{not ForumTool.editMode}"/>
-		<h:outputText value="#{msgs.perm_moderate_postings}" />
-		--%>
-
-    </h:column>
-  </h:dataTable>
-  
-  <h:panelGrid columns="2" summary="layout" rendered="#{ForumTool.gradebookExist}">
-    <h:panelGroup styleClass="shorttext">
-      <h:outputLabel for="forum_assignments" rendered="#{ ForumTool.permissionMode == 'forum'}" value="#{msgs.perm_choose_assignment}"></h:outputLabel>  
-      </h:panelGroup>
-	  <h:panelGroup>
-  	    <h:selectOneMenu id="forum_assignments" value="#{ForumTool.selectedForum.gradeAssign}" rendered="#{ ForumTool.permissionMode == 'forum'}" disabled="#{not ForumTool.editMode}">
-   	    <f:selectItems value="#{ForumTool.assignments}" />
-      </h:selectOneMenu>
-    </h:panelGroup>
-  </h:panelGrid>
-  <h:panelGrid columns="2" summary="layout" rendered="#{ForumTool.gradebookExist}">
-    <h:panelGroup>  	
-  	    <h:outputLabel for="topic_assignments" rendered="#{ ForumTool.permissionMode == 'topic'}" value="#{msgs.perm_choose_assignment}"  ></h:outputLabel>
-  	</h:panelGroup>		
-  	<h:panelGroup>
-  	    <h:selectOneMenu value="#{ForumTool.selectedTopic.gradeAssign}" id="topic_assignments" rendered="#{ ForumTool.permissionMode == 'topic'}" disabled="#{not ForumTool.editMode}">
-     	    <f:selectItems value="#{ForumTool.assignments}" />
-  	    </h:selectOneMenu>
-  	  </h:panelGroup>
-  </h:panelGrid>
-  	
+	<h:panelGrid columns="2" summary="layout" rendered="#{ForumTool.gradebookExist &&  ForumTool.permissionMode == 'topic'}" style="margin-top:.5em;clear:both">
+		<h:panelGroup>  	
+			<h:outputLabel for="topic_assignments"  value="#{msgs.perm_choose_assignment}"  ></h:outputLabel>
+		</h:panelGroup>		
+		<h:panelGroup>
+			<h:selectOneMenu value="#{ForumTool.selectedTopic.gradeAssign}" id="topic_assignments" disabled="#{not ForumTool.editMode}">
+				<f:selectItems value="#{ForumTool.assignments}" />
+			</h:selectOneMenu>
+		</h:panelGroup>
+	</h:panelGrid>
   <sakai:script contextBase="/sakai-messageforums-tool" path="/js/permissions_footer.js"/>	 	
 </mf:forumHideDivision>
Index: msgcntr/messageforums-app/src/webapp/jsp/discussionForum/forumsOnly/dfForums.jsp
===================================================================
--- msgcntr/messageforums-app/src/webapp/jsp/discussionForum/forumsOnly/dfForums.jsp	(revision 46869)
+++ msgcntr/messageforums-app/src/webapp/jsp/discussionForum/forumsOnly/dfForums.jsp	(working copy)
@@ -13,13 +13,19 @@
    <jsp:setProperty name="msgs" property="baseName" value="org.sakaiproject.api.app.messagecenter.bundle.Messages"/>
 </jsp:useBean>
 
+
+
 <f:view>
   <sakai:view title="#{msgs.cdfm_discussion_forums}">
   		<script type="text/javascript" src="/library/js/jquery.js"></script>
   		<sakai:script contextBase="/sakai-messageforums-tool" path="/js/sak-10625.js"/>
 		<sakai:script contextBase="/sakai-messageforums-tool" path="/js/forum.js"/>
-	<h:form id="msgForum">
 
+		<h:form id="msgForum">
+		<style type="text/css">
+			@import url("/sakai-messageforums-tool/css/msgcntr.css");
+		</style>	
+
   <sakai:tool_bar separator="#{msgs.cdfm_toolbar_separator}" rendered="#{ForumTool.newForum || ForumTool.instructor || ForumTool.displayPendingMsgQueue}">
     <sakai:tool_bar_item value="#{msgs.cdfm_new_forum}" action="#{ForumTool.processActionNewForum}" rendered="#{ForumTool.newForum}"/>
     <sakai:tool_bar_item value="#{msgs.cdfm_organize}" action="#{ForumTool.processActionTemplateOrganize}" rendered="#{ForumTool.instructor}" />
@@ -28,9 +34,9 @@
 	  <sakai:tool_bar_item value="#{msgs.cdfm_msg_pending_queue} #{msgs.cdfm_openb}#{ForumTool.numPendingMessages}#{msgs.cdfm_closeb}" action="#{ForumTool.processPendingMsgQueue}" rendered="#{ForumTool.displayPendingMsgQueue}" />
   </sakai:tool_bar>
 
+
+ 	<h3 style="margin-bottom:1em"><h:outputText value="#{msgs.cdfm_discussion_forums}" /></h3>
  	
- 	<div><h3><h:outputText value="#{msgs.cdfm_discussion_forums}" /></h3></div>
- 	
 	<%@include file="/jsp/discussionForum/includes/dfAreaInclude.jsp"%>
 	
  	<%
Index: msgcntr/messageforums-app/src/webapp/jsp/discussionForum/topic/dfTopicSettings.jsp
===================================================================
--- msgcntr/messageforums-app/src/webapp/jsp/discussionForum/topic/dfTopicSettings.jsp	(revision 46869)
+++ msgcntr/messageforums-app/src/webapp/jsp/discussionForum/topic/dfTopicSettings.jsp	(working copy)
@@ -1,232 +1,205 @@
 <%@ page import="java.util.*, javax.faces.context.*, javax.faces.application.*,
-                 javax.faces.el.*, org.sakaiproject.tool.messageforums.*"%>
+		javax.faces.el.*, org.sakaiproject.tool.messageforums.*"%>
 <%@ taglib uri="http://java.sun.com/jsf/html" prefix="h" %>
 <%@ taglib uri="http://java.sun.com/jsf/core" prefix="f" %>
 <%@ taglib uri="http://sakaiproject.org/jsf/sakai" prefix="sakai" %>
 <%@ taglib uri="http://sakaiproject.org/jsf/messageforums" prefix="mf" %>
 <jsp:useBean id="msgs" class="org.sakaiproject.util.ResourceLoader" scope="session">
-   <jsp:setProperty name="msgs" property="baseName" value="org.sakaiproject.api.app.messagecenter.bundle.Messages"/>
+	<jsp:setProperty name="msgs" property="baseName" value="org.sakaiproject.api.app.messagecenter.bundle.Messages"/>
 </jsp:useBean>
 <f:view>
-   <sakai:view>
+	<sakai:view>
+		
+		<h:form id="revise">
+		<script type="text/javascript" src="/library/js/jquery.js"></script>
+		<script type="text/javascript">
+			$(document).ready(function(){
+				//fade permission block and then disable all the inputs/selects in the permission include so as not to confuse people
+				$('#permissionReadOnly').fadeTo("fast", 0.50);
+				// cannot seem to disable these controls and still submit
+				// $('#permissionReadOnly input, #permissionReadOnly select').attr('disabled', 'disabled');
+				//toggle the long description, hiding the hide link, then toggling the hide, show links and description
+				$('a#hide').hide();
+				$('#toggle').hide();
+				$('a#show,a#hide').click(function(){
+					$('#toggle,a#hide,a#show').toggle();
+					resizeFrame('grow');
+					return false;
+				});
+			});
+		</script>
+		<sakai:script contextBase="/sakai-messageforums-tool" path="/js/sak-10625.js"/>
+		<style type="text/css">
+			@import url("/sakai-messageforums-tool/css/msgcntr.css");
+		</style>
+		<%--//designNote: this just feels weird - presenting somehting that sort of looks like the form used to create the topic (with an editable permissions block!) to comfirm deletion --%>
+		<!--jsp/discussionForum/topic/dfTopicSettings.jsp-->
+		<sakai:tool_bar_message value="#{msgs.cdfm_delete_topic_title}" />
+		<h:outputText styleClass="messageAlert" value="#{msgs.cdfm_delete_topic}" rendered="#{ForumTool.selectedTopic.markForDeletion}"/>
+		<div class="topicBloc" style="padding:0 .5em">
+			<p>	
+				<span class="title">
+					<h:graphicImage url="/images/silk/lock.png" alt="#{msgs.cdfm_forum_locked}" rendered="#{ForumTool.selectedTopic.topic.locked=='true'}"  style="margin-right:.3em"/>
+					<h:graphicImage url="/images/silk/lock_open.png" alt="#{msgs.cdfm_forum_locked}" rendered="#{ForumTool.selectedTopic.topic.locked=='false'}"  style="margin-right:.3em"/>
+					<h:outputText id="topic_title"  value="#{ForumTool.selectedTopic.topic.title}"/>
+				</span>
+				<h:outputText   value="#{msgs.cdfm_openb}"/>
+				<h:outputText   value="#{msgs.cdfm_moderated}"  rendered="#{ForumTool.selectedTopic.topic.moderated=='true'}" />
+				<h:outputText   value="#{msgs.cdfm_notmoderated}"  rendered="#{ForumTool.selectedTopic.topic.moderated=='false'}" />
+				<h:outputText   value="#{msgs.cdfm_closeb}"/>
 
-      <h:form id="revise">
-             		<script type="text/javascript" src="/library/js/jquery.js"></script>
-       		<sakai:script contextBase="/sakai-messageforums-tool" path="/js/sak-10625.js"/>
-<!--jsp/discussionForum/topic/dfTopicSettings.jsp-->
-        <sakai:tool_bar_message value="#{msgs.cdfm_discussion_topic_settings}" />
+				</p>
+			<p class="textPanel">
+				<h:outputText id="topic_shortDescription"  value="#{ForumTool.selectedTopic.topic.shortDescription}"/>
+			</p>
+			<p><a id="show" class="show"  href="#">
+				<h:graphicImage url="/images/collapse.gif" /><h:outputText   value="#{msgs.cdfm_read_full_description}"/>
+			</a></p>
+			<p><a id="hide" class="hide"  href="#">
+				<h:graphicImage url="/images/expand.gif" /><h:outputText   value="#{msgs.cdfm_hide_full_description}"/>
+			</a></p>
 
-        <h:outputText styleClass="alertMessage" value="#{msgs.cdfm_delete_topic}" rendered="#{ForumTool.selectedTopic.markForDeletion}"/>
-
-			<table summary="layout" class="itemSummary">
-				<tr>
-				  <th>
-				    <h:outputText value="#{msgs.cdfm_topic_title}" />
-				  </th>
-				  <td>
-    				  <h:outputText id="topic_title"  value="#{ForumTool.selectedTopic.topic.title}"/>
-				  </td>
-				</tr>
-				<tr>
-				  <th>
-   				  <h:outputText value="#{msgs.cdfm_shortDescription}" />	
-				  </th>
-				  <td>	
-				    <h:outputText id="topic_shortDescription"  value="#{ForumTool.selectedTopic.topic.shortDescription}"/>
-				  </td>
-				</tr>
-				<tr>
-				  <th><h:outputText value="#{msgs.cdfm_fullDescription}" />
-				  </th>
-				  <td><mf:htmlShowArea hideBorder="true" id="topic_fullDescription"  value="#{ForumTool.selectedTopic.topic.extendedDescription}"/>
-				  </td>
-				</tr>
-		  </table>
-				
+			<div class="textPanel toggle"  id="toggle">
+				<mf:htmlShowArea hideBorder="true" id="topic_fullDescription"  value="#{ForumTool.selectedTopic.topic.extendedDescription}"/>
 				<h:dataTable value="#{ForumTool.selectedTopic.attachList}" var="eachAttach" rendered="#{!empty ForumTool.selectedTopic.attachList}" styleClass="listHier" columnClasses="attach,bogus">
 				  <h:column>
-					<h:graphicImage url="/images/excel.gif" rendered="#{eachAttach.attachment.attachmentType == 'application/vnd.ms-excel'}" alt="" />
-					<h:graphicImage url="/images/html.gif" rendered="#{eachAttach.attachment.attachmentType == 'text/html'}" alt="" />
-					<h:graphicImage url="/images/pdf.gif" rendered="#{eachAttach.attachment.attachmentType == 'application/pdf'}" alt="" />
-					<h:graphicImage url="/images/ppt.gif" rendered="#{eachAttach.attachment.attachmentType == 'application/vnd.ms-powerpoint'}" alt="" />
-					<h:graphicImage url="/images/text.gif" rendered="#{eachAttach.attachment.attachmentType == 'text/plain'}" alt="" />
-					<h:graphicImage url="/images/word.gif" rendered="#{eachAttach.attachment.attachmentType == 'application/msword'}" alt="" />
-					</h:column>
+						<h:graphicImage url="/images/attachment.gif"/>
+				  </h:column>
 					  <h:column>
-<%--					<h:outputLink value="#{eachAttach.attachmentUrl}" target="_blank">
-					  <h:outputText value="#{eachAttach.attachmentName}"  style="text-decoration:underline;"/>
-				    </h:outputLink>--%>
 					<h:outputLink value="#{eachAttach.url}" target="_blank">
 					  <h:outputText value="#{eachAttach.attachment.attachmentName}"  style="text-decoration:underline;"/>
-				    </h:outputLink>
+					</h:outputLink>
 				  </h:column>
 				</h:dataTable>
-
-
-
-				<%--<h:panelGroup>
-					 <h:dataTable id="topic_attachments"  value="#{ForumTool.selectedTopic.topic.attachments}" var="attachment" >
-					  		<h:column rendered="#{!empty ForumTool.selectedTopic.topic.attachments}">
-								<h:graphicImage url="/images/excel.gif" rendered="#{attachment.attachmentType == 'application/vnd.ms-excel'}"/>
-								<h:graphicImage url="/images/html.gif" rendered="#{attachment.attachmentType == 'text/html'}"/>
-								<h:graphicImage url="/images/pdf.gif" rendered="#{attachment.attachmentType == 'application/pdf'}"/>
-								<h:graphicImage url="/sakai-messageforums-tool/images/ppt.gif" rendered="#{attachment.attachmentType == 'application/vnd.ms-powerpoint'}"/>
-								<h:graphicImage url="/images/text.gif" rendered="#{attachment.attachmentType == 'text/plain'}"/>
-								<h:graphicImage url="/images/word.gif" rendered="#{attachment.attachmentType == 'application/msword'}"/>
-								<h:outputText value="#{attachment.attachmentName}"/>
-						</h:column>
-					</h:dataTable> 			 
-				</h:panelGroup>--%>
-      <h4><h:outputText value="#{msgs.cdfm_topic_posting}"/></h4>
-
-			<h:panelGrid columns="2">
-				<h:panelGroup >
-				  <h:outputLabel for="topic_locked" value="#{msgs.cdfm_lock_topic}" styleClass="shorttext"/>
-				</h:panelGroup>
-				<h:panelGroup>	
-					<h:selectOneRadio  layout="pageDirection" disabled="true" id="topic_locked"  value="#{ForumTool.selectedTopic.locked}" styleClass="checkbox inlineForm">
-    			  <f:selectItem itemValue="true" itemLabel="#{msgs.cdfm_yes}"/>
-    		  	<f:selectItem itemValue="false" itemLabel="#{msgs.cdfm_no}"/>
-  			  </h:selectOneRadio>
-				</h:panelGroup>
-				<h:panelGroup >
-				  <h:outputLabel for="topic_moderated" value="#{msgs.cdfm_moderate_topic}" styleClass="shorttext"/>
-				</h:panelGroup>
-				<h:panelGroup>	
-		  	<h:selectOneRadio  layout="pageDirection" disabled="true" id="topic_moderated"  value="#{ForumTool.selectedTopic.moderated}" styleClass="checkbox inlineForm">
-    		  <f:selectItem itemValue="true" itemLabel="#{msgs.cdfm_yes}"/>
-    			<f:selectItem itemValue="false" itemLabel="#{msgs.cdfm_no}"/>
-  			</h:selectOneRadio>
-				</h:panelGroup>
-			</h:panelGrid>
-
-		<%--
-		   <h4><h:outputText  value="Anonymous Responses"/></h4>
-		   <h:selectBooleanCheckbox   title= "#{msgs.cdfm_topic_allow_anonymous_postings}" disabled="true" value="false" />
-		   <h:outputText   value="  #{msgs.cdfm_topic_allow_anonymous_postings}" /> 
-		   <br/>
-		   <h:selectBooleanCheckbox  disabled="true" title= "#{msgs.cdfm_topic_author_identity}"  value="false" />
-		   <h:outputText   value="  #{msgs.cdfm_topic_author_identity}" />
-     
-       <h4><h:outputText  value="Post Before Reading"/></h4>
-    	   <p class="shorttext">
+			</div>
+		</div>	
+		<%-- originally hidden
+			<h4><h:outputText  value="Anonymous Responses"/></h4>
+			<h:selectBooleanCheckbox   title= "#{msgs.cdfm_topic_allow_anonymous_postings}" disabled="true" value="false" />
+			<h:outputText   value="  #{msgs.cdfm_topic_allow_anonymous_postings}" /> 
+			<br/>
+			<h:selectBooleanCheckbox  disabled="true" title= "#{msgs.cdfm_topic_author_identity}"  value="false" />
+			<h:outputText   value="  #{msgs.cdfm_topic_author_identity}" />
+			<h4><h:outputText  value="Post Before Reading"/></h4>
+		   <p class="shorttext">
 				<h:panelGrid columns="2">
 					<h:panelGroup><h:outputLabel id="outputLabel5" for="topic_reading"  value="Users must post a response before reading others"/>	</h:panelGroup>
 					<h:panelGroup>
 						<h:selectOneRadio disabled ="true" layout="pageDirection"  id="topic_reading" value="#{ForumTool.selectedTopic.mustRespondBeforeReading}">
-	    					<f:selectItem itemValue="true" itemLabel="Yes"/>
-	    					<f:selectItem itemValue="false" itemLabel="No"/>
-	  					</h:selectOneRadio>
+							<f:selectItem itemValue="true" itemLabel="Yes"/>
+							<f:selectItem itemValue="false" itemLabel="No"/>
+						</h:selectOneRadio>
 					</h:panelGroup>
 				</h:panelGrid>
 			</p>
-		  --%>
-		  
-		  
-	  <%@include file="/jsp/discussionForum/permissions/permissions_include.jsp"%>
-	    
-	  <%--
-      <mf:forumHideDivision title="#{msgs.cdfm_access}" id="access_perm" hideByDefault="true">
-	  	<p class="shorttext">
-			<h:panelGrid columns="2" width="50%">
-				<h:panelGroup><h:outputLabel id="outputLabelCont" for="contributors"  value="#{msgs.cdfm_contributors}"/>	</h:panelGroup>
-				<h:panelGroup>
-					<h:selectManyListbox disabled ="true" id="contributors"  value="#{ForumTool.selectedTopic.contributorsList}" size="5" style="width:200px;">
-    					<f:selectItems value="#{ForumTool.totalComposeToList}" />
-  					</h:selectManyListbox>
-				</h:panelGroup>
-
-			  <h:panelGroup><h:outputLabel id="outputLabelRead" for="readOnly"  value="#{msgs.cdfm_read_only_access}"/>	</h:panelGroup>
-				<h:panelGroup>
-					<h:selectManyListbox  disabled ="true" id="readOnly"  value="#{ForumTool.selectedTopic.accessorList}" size="5" style="width:200px;">
-    					<f:selectItems value="#{ForumTool.totalComposeToList}"  />
-  					</h:selectManyListbox>
-				</h:panelGroup>
-			</h:panelGrid>
-		</p>
-	  </mf:forumHideDivision>
-      <mf:forumHideDivision title="#{msgs.cdfm_control_permissions}" id="cntrl_perm" hideByDefault="true">
-          <h:dataTable styleClass="listHier" id="control_permissions" value="#{ForumTool.topicControlPermissions}" var="cntrl_settings">
-   			<h:column>
-				<f:facet name="header"><h:outputText value="#{msgs.perm_role}" /></f:facet>
-				<h:outputText value="#{cntrl_settings.role}"/>
-			</h:column> 			 
-			<h:column>
-				<f:facet name="header"><h:outputText value="#{msgs.perm_new_response}" /></f:facet>
-				<h:selectBooleanCheckbox disabled="true" value="#{cntrl_settings.newResponse}"/>
-			</h:column>
-			<h:column>
-				<f:facet name="header"><h:outputText value="#{msgs.perm_response_to_response}" /></f:facet>
-				<h:selectBooleanCheckbox disabled="true" value="#{cntrl_settings.responseToResponse}"/>
-			</h:column>
-		    <h:column>
-				<f:facet name="header">	<h:outputText value="#{msgs.perm_move_postings}" /></f:facet>
-				<h:selectBooleanCheckbox disabled="true" value="#{cntrl_settings.movePostings}"/>
-			</h:column>
-			<h:column>
-				<f:facet name="header"><h:outputText value="#{msgs.perm_change_settings}" /></f:facet>
-				<h:selectBooleanCheckbox disabled="true" value="#{cntrl_settings.changeSettings}"/>
-			</h:column>
-			<h:column>
-				<f:facet name="header"><h:outputText value="#{msgs.perm_post_to_gradebook}" /></f:facet>
-				<h:selectBooleanCheckbox disabled="true" value="#{cntrl_settings.postToGradebook}"/>
-			</h:column>
-		</h:dataTable>
-      </mf:forumHideDivision>
-      <mf:forumHideDivision title="#{msgs.cdfm_message_permissions}" id="msg_perm" hideByDefault="true">
-      <h:dataTable styleClass="listHier" id="message_permissions" value="#{ForumTool.topicMessagePermissions}" var="msg_settings">
-   			<h:column>
-				<f:facet name="header"><h:outputText value="#{msgs.perm_role}" /></f:facet>
-				<h:outputText value="#{msg_settings.role}"/>
-			</h:column>
-			 <h:column>
-				<f:facet name="header"><h:outputText value="#{msgs.perm_read}" /></f:facet>
-				<h:selectBooleanCheckbox disabled="true" value="#{msg_settings.read}"/>
-			</h:column>
-			<h:column>
-				<f:facet name="header"><h:outputText value="#{msgs.perm_revise_any}" /></f:facet>
-				<h:selectBooleanCheckbox disabled="true" value="#{msg_settings.reviseAny}"/>
-			</h:column>
-			<h:column>
-				<f:facet name="header">	<h:outputText value="#{msgs.perm_revise_own}" /></f:facet>
-				<h:selectBooleanCheckbox disabled="true" value="#{msg_settings.reviseOwn}"/>
-			</h:column>
-			<h:column>
-				<f:facet name="header"><h:outputText value="#{msgs.perm_delete_any}" /></f:facet>
-				<h:selectBooleanCheckbox disabled="true" value="#{msg_settings.deleteAny}"/>
-			</h:column>
-			<h:column>
-				<f:facet name="header">	<h:outputText value="#{msgs.perm_delete_own}" /></f:facet>
-				<h:selectBooleanCheckbox disabled="true" value="#{msg_settings.deleteOwn}"/>
-			</h:column>
-			<h:column>
-				<f:facet name="header"><h:outputText value="#{msgs.perm_mark_as_read}" /></f:facet>
-				<h:selectBooleanCheckbox disabled="true" value="#{msg_settings.markAsRead}"/>
-			</h:column>			 		
-		</h:dataTable>	 	
-      </mf:forumHideDivision>
-      --%>
-      
-       <div class="act">
-          <h:commandButton action="#{ForumTool.processActionReviseTopicSettings}" id="revise"  
-                           value="#{msgs.cdfm_button_bar_revise}" rendered="#{!ForumTool.selectedTopic.markForDeletion}"
-                           accesskey="r" styleClass="active"> 
-    	 	  	<f:param value="#{ForumTool.selectedTopic.topic.id}" name="topicId"/> 
-    	 	  	<f:param value="#{ForumTool.selectedForum.forum.id}" name="forumId"/>        
-          </h:commandButton>
-          <h:commandButton action="#{ForumTool.processActionDeleteTopicConfirm}" id="delete_confirm" 
-                           value="#{msgs.cdfm_button_bar_delete}" rendered="#{!ForumTool.selectedTopic.markForDeletion}"
-                           >
-	        	<f:param value="#{ForumTool.selectedTopic.topic.id}" name="topicId"/>
-          </h:commandButton>
-          <h:commandButton action="#{ForumTool.processActionDeleteTopic}" id="delete" 
-                           value="#{msgs.cdfm_button_bar_delete}" rendered="#{ForumTool.selectedTopic.markForDeletion}"
-                           >
-	        	<f:param value="#{ForumTool.selectedTopic.topic.id}" name="topicId"/>
-          </h:commandButton>
-          <h:commandButton immediate="true" action="#{ForumTool.processReturnToOriginatingPage}" id="cancel" 
-                           value="#{msgs.cdfm_button_bar_cancel} " accesskey="x" />
-       </div>
-	 </h:form>
-    </sakai:view>
-</f:view>
+		--%>
+					  
+				<div id="permissionReadOnly">	  
+					<%@include file="/jsp/discussionForum/permissions/permissions_include.jsp"%>
+				 </div> 
+				 
+				  <%--
+				  <mf:forumHideDivision title="#{msgs.cdfm_access}" id="access_perm" hideByDefault="true">
+					<p class="shorttext">
+						<h:panelGrid columns="2" width="50%">
+							<h:panelGroup><h:outputLabel id="outputLabelCont" for="contributors"  value="#{msgs.cdfm_contributors}"/>	</h:panelGroup>
+							<h:panelGroup>
+								<h:selectManyListbox disabled ="true" id="contributors"  value="#{ForumTool.selectedTopic.contributorsList}" size="5" style="width:200px;">
+									<f:selectItems value="#{ForumTool.totalComposeToList}" />
+								</h:selectManyListbox>
+							</h:panelGroup>
+			
+						  <h:panelGroup><h:outputLabel id="outputLabelRead" for="readOnly"  value="#{msgs.cdfm_read_only_access}"/>	</h:panelGroup>
+							<h:panelGroup>
+								<h:selectManyListbox  disabled ="true" id="readOnly"  value="#{ForumTool.selectedTopic.accessorList}" size="5" style="width:200px;">
+									<f:selectItems value="#{ForumTool.totalComposeToList}"  />
+								</h:selectManyListbox>
+							</h:panelGroup>
+						</h:panelGrid>
+					</p>
+				  </mf:forumHideDivision>
+				  <mf:forumHideDivision title="#{msgs.cdfm_control_permissions}" id="cntrl_perm" hideByDefault="true">
+					  <h:dataTable styleClass="listHier" id="control_permissions" value="#{ForumTool.topicControlPermissions}" var="cntrl_settings">
+						<h:column>
+							<f:facet name="header"><h:outputText value="#{msgs.perm_role}" /></f:facet>
+							<h:outputText value="#{cntrl_settings.role}"/>
+						</h:column> 			 
+						<h:column>
+							<f:facet name="header"><h:outputText value="#{msgs.perm_new_response}" /></f:facet>
+							<h:selectBooleanCheckbox disabled="true" value="#{cntrl_settings.newResponse}"/>
+						</h:column>
+						<h:column>
+							<f:facet name="header"><h:outputText value="#{msgs.perm_response_to_response}" /></f:facet>
+							<h:selectBooleanCheckbox disabled="true" value="#{cntrl_settings.responseToResponse}"/>
+						</h:column>
+						<h:column>
+							<f:facet name="header">	<h:outputText value="#{msgs.perm_move_postings}" /></f:facet>
+							<h:selectBooleanCheckbox disabled="true" value="#{cntrl_settings.movePostings}"/>
+						</h:column>
+						<h:column>
+							<f:facet name="header"><h:outputText value="#{msgs.perm_change_settings}" /></f:facet>
+							<h:selectBooleanCheckbox disabled="true" value="#{cntrl_settings.changeSettings}"/>
+						</h:column>
+						<h:column>
+							<f:facet name="header"><h:outputText value="#{msgs.perm_post_to_gradebook}" /></f:facet>
+							<h:selectBooleanCheckbox disabled="true" value="#{cntrl_settings.postToGradebook}"/>
+						</h:column>
+					</h:dataTable>
+				  </mf:forumHideDivision>
+				  <mf:forumHideDivision title="#{msgs.cdfm_message_permissions}" id="msg_perm" hideByDefault="true">
+				  <h:dataTable styleClass="listHier" id="message_permissions" value="#{ForumTool.topicMessagePermissions}" var="msg_settings">
+						<h:column>
+							<f:facet name="header"><h:outputText value="#{msgs.perm_role}" /></f:facet>
+							<h:outputText value="#{msg_settings.role}"/>
+						</h:column>
+						 <h:column>
+							<f:facet name="header"><h:outputText value="#{msgs.perm_read}" /></f:facet>
+							<h:selectBooleanCheckbox disabled="true" value="#{msg_settings.read}"/>
+						</h:column>
+						<h:column>
+							<f:facet name="header"><h:outputText value="#{msgs.perm_revise_any}" /></f:facet>
+							<h:selectBooleanCheckbox disabled="true" value="#{msg_settings.reviseAny}"/>
+						</h:column>
+						<h:column>
+							<f:facet name="header">	<h:outputText value="#{msgs.perm_revise_own}" /></f:facet>
+							<h:selectBooleanCheckbox disabled="true" value="#{msg_settings.reviseOwn}"/>
+						</h:column>
+						<h:column>
+							<f:facet name="header"><h:outputText value="#{msgs.perm_delete_any}" /></f:facet>
+							<h:selectBooleanCheckbox disabled="true" value="#{msg_settings.deleteAny}"/>
+						</h:column>
+						<h:column>
+							<f:facet name="header">	<h:outputText value="#{msgs.perm_delete_own}" /></f:facet>
+							<h:selectBooleanCheckbox disabled="true" value="#{msg_settings.deleteOwn}"/>
+						</h:column>
+						<h:column>
+							<f:facet name="header"><h:outputText value="#{msgs.perm_mark_as_read}" /></f:facet>
+							<h:selectBooleanCheckbox disabled="true" value="#{msg_settings.markAsRead}"/>
+						</h:column>			 		
+					</h:dataTable>	 	
+				  </mf:forumHideDivision>
+				  --%>
+				  
+				   <div class="act">
+					  <h:commandButton action="#{ForumTool.processActionReviseTopicSettings}" id="revise"  
+									   value="#{msgs.cdfm_button_bar_revise}" rendered="#{!ForumTool.selectedTopic.markForDeletion}"
+									   accesskey="r" styleClass="active"> 
+							<f:param value="#{ForumTool.selectedTopic.topic.id}" name="topicId"/> 
+							<f:param value="#{ForumTool.selectedForum.forum.id}" name="forumId"/>        
+					  </h:commandButton>
+					  <h:commandButton action="#{ForumTool.processActionDeleteTopicConfirm}" id="delete_confirm" 
+									   value="#{msgs.cdfm_button_bar_delete}" rendered="#{!ForumTool.selectedTopic.markForDeletion}"
+									   >
+							<f:param value="#{ForumTool.selectedTopic.topic.id}" name="topicId"/>
+					  </h:commandButton>
+					  <h:commandButton action="#{ForumTool.processActionDeleteTopic}" id="delete" 
+									   value="#{msgs.cdfm_button_bar_delete}" rendered="#{ForumTool.selectedTopic.markForDeletion}"
+									   >
+							<f:param value="#{ForumTool.selectedTopic.topic.id}" name="topicId"/>
+					  </h:commandButton>
+					  <h:commandButton immediate="true" action="#{ForumTool.processReturnToOriginatingPage}" id="cancel" 
+									   value="#{msgs.cdfm_button_bar_cancel} " accesskey="x" />
+				   </div>
+			 </h:form>
+		</sakai:view>
+	</f:view>
Index: msgcntr/messageforums-app/src/webapp/jsp/dfMessageReplyThread.jsp
===================================================================
--- msgcntr/messageforums-app/src/webapp/jsp/dfMessageReplyThread.jsp	(revision 46869)
+++ msgcntr/messageforums-app/src/webapp/jsp/dfMessageReplyThread.jsp	(working copy)
@@ -3,242 +3,242 @@
 <%@ taglib uri="http://sakaiproject.org/jsf/sakai" prefix="sakai" %>
 <%@ taglib uri="http://sakaiproject.org/jsf/messageforums" prefix="mf" %>
 <jsp:useBean id="msgs" class="org.sakaiproject.util.ResourceLoader" scope="session">
-   <jsp:setProperty name="msgs" property="baseName" value="org.sakaiproject.api.app.messagecenter.bundle.Messages"/>
+	<jsp:setProperty name="msgs" property="baseName" value="org.sakaiproject.api.app.messagecenter.bundle.Messages"/>
 </jsp:useBean>
 <f:view>
 
-  <sakai:view title="#{msgs.cdfm_reply_tool_bar_message}">
-<!--jsp/dfMessageReply.jsp-->    
-      <h:form id="dfCompose">
-             		<script type="text/javascript" src="/library/js/jquery.js"></script>
-       		<sakai:script contextBase="/sakai-messageforums-tool" path="/js/sak-10625.js"/>
-        <h:outputText styleClass="alertMessage" value="#{msgs.cdfm_reply_deleted}" rendered="#{ForumTool.errorSynch}" />
+<sakai:view title="#{msgs.cdfm_reply_tool_bar_message}">
+	<!--jsp/dfMessageReplyThread.jsp-->    
+	<h:form id="dfCompose">
+		<style type="text/css">
+			@import url("/sakai-messageforums-tool/css/msgcntr.css");
+		</style>
+		<script type="text/javascript" src="/library/js/jquery.js"></script>
+		<sakai:script contextBase="/sakai-messageforums-tool" path="/js/sak-10625.js"/>
+		<h:outputText styleClass="alertMessage" value="#{msgs.cdfm_reply_deleted}" rendered="#{ForumTool.errorSynch}" />
+		
+		
+		<h3><h:outputText value="#{msgs.cdfm_reply_thread_tool_bar_message}"  /></h3>
 	
+		<table class="topicBloc topicBlocLone">
+			<tr>
+				<td>
+					<span class ="title">
+						<h:outputText value="#{ForumTool.selectedForum.forum.title}" />
+						<h:outputText value=" / "/>
+						<h:outputText value="#{ForumTool.selectedTopic.topic.title}"/>
+					</span>
+					<p class="textPanel">
+						<h:outputText value="#{ForumTool.selectedTopic.topic.shortDescription}"/>
+					</p>
+				</td>
+			</tr>
+		</table>	
 
-		  <h3><h:outputText value="#{msgs.cdfm_reply_thread_tool_bar_message}"  /></h3>
-      <h4><h:outputText value="#{ForumTool.selectedForum.forum.title}" />
-		    <h:outputText value=" - "/>
-	      <h:outputText value="#{ForumTool.selectedTopic.topic.title}"/>
-		  </h4>	
+		<%--********************* Reply To *********************--%>	     	
+		<div class="singleMessage">
+			<p><a href="javascript:$('#replytomessage').toggle();resizeFrame('grow');" class="show"><h:outputText value="#{msgs.cdfm_replytoshowhide}"/></a></p>
+			<div  id="replytomessage">
+				<h:outputText value="#{ForumTool.selectedMessage.message.title}" styleClass="title"/>
+				<h:outputText value="#{ForumTool.selectedMessage.message.author}" styleClass="textPanelFooter"/>
+				<h:outputText value=" #{msgs.cdfm_openb}" styleClass="textPanelFooter"/>
+				<h:outputText value="#{ForumTool.selectedMessage.message.created}" styleClass="textPanelFooter">
+					<f:convertDateTime pattern="#{msgs.date_format}" />  
+				</h:outputText>
+				<h:outputText value=" #{msgs.cdfm_closeb}" styleClass="textPanelFooter"/>
+	
+				<mf:htmlShowArea value="#{ForumTool.selectedMessage.message.body}" hideBorder="true" />
+				<h:dataTable value="#{ForumTool.selectedMessage.message.attachments}" var="eachAttach"  rendered="#{!empty ForumTool.selectedMessage.message.attachments}" columnClasses="attach,bogus" styleClass="attachList"   summary="layout"  
+						style="font-size:.9em;width:auto;margin-left:1em" border="0">
+					<h:column rendered="#{!empty ForumTool.selectedMessage.message.attachments}">
+						<h:graphicImage url="/images/attachment.gif" />
+					</h:column>
+					<h:column>
+						<%--							<h:outputLink value="#{eachAttach.attachmentUrl}" target="_blank">
+						<h:outputText value="#{eachAttach.attachmentName}"/>
+						</h:outputLink>--%>
+						<%--							<h:outputLink value="#{ForumTool.attachmentUrl}" target="_blank">
+						<f:param name="attachmentId" value="#{eachAttach.attachment.attachmentId}"/>
+						<h:outputText value="#{eachAttach.attachment.attachmentName}"/>
+						</h:outputLink>--%>
+						<h:outputText value="#{eachAttach.attachmentName}"/>							
+					</h:column>
+				</h:dataTable>
+			</div>
+		</div>	
+		<p class="instruction">
+			<h:outputText value="#{msgs.cdfm_required}"/>
+			<h:outputText value="#{msgs.cdfm_info_required_sign}" styleClass="reqStarInline" />
+		</p>	 
 
-    <p class="textPanel">
-		  <h:outputText value="#{ForumTool.selectedTopic.topic.shortDescription}"/>
-    </p>
+		<h:panelGrid styleClass="jsfFormTable" columns="1" style="width: 100%;">
+		
+			<h:panelGroup style="padding-top:.5em">
+				<h:message for="df_compose_title" styleClass="messageAlert" id="errorMessages" />
+				<h:outputLabel for="df_compose_title" style="display:block;float:none;clear:both;padding-bottom:.3em;padding-top:.3em;">
+					<h:outputText value="#{msgs.cdfm_info_required_sign}" styleClass="reqStar"/>
+					<h:outputText value="#{msgs.cdfm_reply_title}" />
+				</h:outputLabel>
+				<h:inputText value="#{ForumTool.composeTitle}" style="width: 30em;" required="true" id="df_compose_title" />
+			</h:panelGroup>
+		</h:panelGrid>
+		
+		
+		<h:outputText value="#{msgs.cdfm_message}"/> 
+		<h:inputHidden id="msgHidden" value="#{ForumTool.selectedMessage.message.body}" />
+		<h:inputHidden id="titleHidden" value="#{ForumTool.selectedMessage.message.title}" />
+		<h:outputText value="&nbsp;&nbsp;&nbsp; " escape="false" />
+		<img src="/library/image/silk/paste_plain.png" />
+		<a  href="#"  onclick="InsertHTML();">
+		<h:outputText value="#{msgs.cdfm_message_insert}" /></a>
 
-
-		<p class="instruction">
-              <h:outputText value="#{msgs.cdfm_required}"/>
-              <h:outputText value="#{msgs.cdfm_info_required_sign}" styleClass="reqStarInline" />
-		</p>	  
-          <h:panelGrid styleClass="jsfFormTable" columns="2" style="width: 100%;">
-            <h:panelGroup>
-	   			     <h:outputText value="#{msgs.cdfm_info_required_sign}" styleClass="reqStar"/>
-			  		   <h:outputLabel for="df_compose_title"><h:outputText value="#{msgs.cdfm_reply_title}" /></h:outputLabel>
- 					  </h:panelGroup>
-				   <h:inputText value="#{ForumTool.composeTitle}" style="width: 30em;" required="true" id="df_compose_title" />
-
-          </h:panelGrid>
-          
-          <h:message for="df_compose_title" styleClass="alertMessage" id="errorMessages" />
-		  <h4>
-		     <h:outputText value="#{msgs.cdfm_message}" /> 
-		  </h4>
-		    
-		    <h:inputHidden id="msgHidden" value="#{ForumTool.selectedMessage.message.body}" />
-		    <h:inputHidden id="titleHidden" value="#{ForumTool.selectedMessage.message.title}" />
-		    <input type="button" value="Insert Original Message Text" onClick="InsertHTML();" /><br/>
-            <sakai:rich_text_area value="#{ForumTool.composeBody}" rows="17" columns="70"/>
-            <script language="javascript" type="text/javascript">
-            var textareas = document.getElementsByTagName("textarea");
-	        var rteId = textareas.item(0).id;
-	        
-//	        function FCKeditor_OnComplete( editorInstance )
-//	        {
-//	          // clears the FCK editor after initial loading
-//	          editorInstance.SetHTML( "" );
-//	        }
-	        
-	        // set the previous message variable
-	        var messagetext = document.forms['dfCompose'].elements['dfCompose:msgHidden'].value;
-	        var titletext = document.forms['dfCompose'].elements['dfCompose:titleHidden'].value;
-	        
-            function InsertHTML() 
-            { 
-              // These lines will write to the original textarea and makes the quoting work when FCK is not present
-              var finalhtml = '<b><i>Original Message:</i></b><br/><b><i><h:outputText value="#{msgs.cdfm_from}" /></i></b> <i><h:outputText value="#{ForumTool.selectedMessage.message.author}" /><h:outputText value=" #{msgs.cdfm_openb}" /><h:outputText value="#{ForumTool.selectedMessage.message.created}" ><f:convertDateTime pattern="#{msgs.date_format}" /></h:outputText><h:outputText value="#{msgs.cdfm_closeb}" /></i><br/><b><i><h:outputText value="#{msgs.cdfm_subject}" /></i></b> <i>' + titletext + '</i><br/><br/><i>' + messagetext + '</i><br/><br/>';
-              document.forms['dfCompose'].elements[rteId].value = finalhtml;
-              // Get the editor instance that we want to interact with.
-              var oEditor = FCKeditorAPI.GetInstance(rteId);
-              // Check the active editing mode.
-              if ( oEditor.EditMode == FCK_EDITMODE_WYSIWYG )
-              {
-              // Insert the desired HTML.
-              oEditor.InsertHtml( finalhtml );
-              }
-              else alert( 'You must be on WYSIWYG mode!' );
-            }
-            </script>
-            
-<%--********************* Attachment *********************--%>	
-	        <h4>
-	          <h:outputText value="#{msgs.cdfm_att}"/>
-	        </h4>
+		<sakai:rich_text_area value="#{ForumTool.composeBody}" rows="17" columns="70"/>
+		<script language="javascript" type="text/javascript">
+			var textareas = document.getElementsByTagName("textarea");
+			var rteId = textareas.item(0).id;
+			
+			//	        function FCKeditor_OnComplete( editorInstance )
+			//	        {
+			//	          // clears the FCK editor after initial loading
+			//	          editorInstance.SetHTML( "" );
+			//	        }
+			
+			// set the previous message variable
+			var messagetext = document.forms['dfCompose'].elements['dfCompose:msgHidden'].value;
+			var titletext = document.forms['dfCompose'].elements['dfCompose:titleHidden'].value;
+			
+			function InsertHTML() 
+			{ 
+			// These lines will write to the original textarea and makes the quoting work when FCK is not present
+			var finalhtml = '<b><i>Original Message:</i></b><br/><b><i><h:outputText value="#{msgs.cdfm_from}" /></i></b> <i><h:outputText value="#{ForumTool.selectedMessage.message.author}" /><h:outputText value=" #{msgs.cdfm_openb}" /><h:outputText value="#{ForumTool.selectedMessage.message.created}" ><f:convertDateTime pattern="#{msgs.date_format}" /></h:outputText><h:outputText value="#{msgs.cdfm_closeb}" /></i><br/><b><i><h:outputText value="#{msgs.cdfm_subject}" /></i></b> <i>' + titletext + '</i><br/><br/><i>' + messagetext + '</i><br/><br/>';
+			document.forms['dfCompose'].elements[rteId].value = finalhtml;
+			// Get the editor instance that we want to interact with.
+			var oEditor = FCKeditorAPI.GetInstance(rteId);
+			// Check the active editing mode.
+			if ( oEditor.EditMode == FCK_EDITMODE_WYSIWYG )
+			{
+			// Insert the desired HTML.
+			oEditor.InsertHtml( finalhtml );
+			}
+			else alert( 'You must be on WYSIWYG mode!' );
+			}
+		</script>
+		
+		<%--********************* Attachment *********************--%>	
+		<h4>
+			<h:outputText value="#{msgs.cdfm_att}"/>
+		</h4>
+		<p>
 			<h:outputText value="#{msgs.cdfm_no_attachments}" rendered="#{empty ForumTool.attachments}" styleClass="instruction" />
+		</p>	
 
-	          <sakai:button_bar>
-	          	<sakai:button_bar_item action="#{ForumTool.processAddAttachmentRedirect}" value="#{msgs.cdfm_button_bar_add_attachment_redirect}" immediate="true"/>
-	          </sakai:button_bar>
-	        <%-- gsilver:moving rendered attr from column to table to avoid childless table if empty--%>
-		    <h:dataTable styleClass="listHier lines nolines" id="attmsg" width="100%" value="#{ForumTool.attachments}" var="eachAttach"   rendered="#{!empty ForumTool.attachments}"
-			columnClasses="attach,bogus,specialLink itemAction,bogus,bogus">
-			  <h:column rendered="#{!empty ForumTool.attachments}">
-				  <h:graphicImage url="/images/excel.gif" rendered="#{eachAttach.attachment.attachmentType == 'application/vnd.ms-excel'}" alt="" />
-				  <h:graphicImage url="/images/html.gif" rendered="#{eachAttach.attachment.attachmentType == 'text/html'}" alt="" />
-				  <h:graphicImage url="/images/pdf.gif" rendered="#{eachAttach.attachment.attachmentType == 'application/pdf'}"/>
-				  <h:graphicImage url="/images/ppt.gif" rendered="#{eachAttach.attachment.attachmentType == 'application/vnd.ms-powerpoint'}" alt="" />
-				  <h:graphicImage url="/images/text.gif" rendered="#{eachAttach.attachment.attachmentType == 'text/plain'}" alt="" />
-				  <h:graphicImage url="/images/word.gif" rendered="#{eachAttach.attachment.attachmentType == 'application/msword'}" alt="" />
-				</h:column>
-				  <h:column>
-					  <f:facet name="header">
-						<h:outputText value="#{msgs.cdfm_title}"/>
+		<%-- //designNote: moving rendered attr from column to table to avoid childless table if empty--%>
+		<h:dataTable styleClass="attachPanel" id="attmsg"  value="#{ForumTool.attachments}" var="eachAttach"   rendered="#{!empty ForumTool.attachments}"
+			columnClasses="attach,bogus,specialLink itemAction,bogus,bogus" style="width:auto">
+			<h:column rendered="#{!empty ForumTool.attachments}">
+					<h:graphicImage url="/images/excel.gif" rendered="#{eachAttach.attachment.attachmentType == 'application/vnd.ms-excel'}" alt="" />
+					<h:graphicImage url="/images/html.gif" rendered="#{eachAttach.attachment.attachmentType == 'text/html'}" alt="" />
+					<h:graphicImage url="/images/pdf.gif" rendered="#{eachAttach.attachment.attachmentType == 'application/pdf'}"/>
+					<h:graphicImage url="/images/ppt.gif" rendered="#{eachAttach.attachment.attachmentType == 'application/vnd.ms-powerpoint'}" alt="" />
+					<h:graphicImage url="/images/text.gif" rendered="#{eachAttach.attachment.attachmentType == 'text/plain'}" alt="" />
+					<h:graphicImage url="/images/word.gif" rendered="#{eachAttach.attachment.attachmentType == 'application/msword'}" alt="" />
+			</h:column>
+			<h:column>
+				<f:facet name="header">
+					<h:outputText value="#{msgs.cdfm_title}"/>
 					</f:facet>
-					  <h:outputText value="#{eachAttach.attachment.attachmentName}"/>			
-				</h:column>
-				<h:column>
-				  <h:commandLink action="#{ForumTool.processDeleteAttach}" 
-								immediate="true"
-								onfocus="document.forms[0].onsubmit();"
-								title="#{msgs.cdfm_remove}">
-				    <h:outputText value="#{msgs.cdfm_remove}"/>
-<%--									<f:param value="#{eachAttach.attachment.attachmentId}" name="dfmsg_current_attach"/>--%>
+					<h:outputText value="#{eachAttach.attachment.attachmentName}"/>			
+			</h:column>
+			<h:column>
+				<h:commandLink action="#{ForumTool.processDeleteAttach}" 
+						immediate="true"
+						onfocus="document.forms[0].onsubmit();"
+						title="#{msgs.cdfm_remove}">
+					<h:outputText value="#{msgs.cdfm_remove}"/>
+					<%--									<f:param value="#{eachAttach.attachment.attachmentId}" name="dfmsg_current_attach"/>--%>
 					<f:param value="#{eachAttach.attachment.attachmentId}" name="dfmsg_current_attach"/>
-				  </h:commandLink>
-			  </h:column>
-			  <h:column rendered="#{!empty ForumTool.attachments}">
-			    <f:facet name="header">
-				  <h:outputText value="#{msgs.cdfm_attsize}" />
+				</h:commandLink>
+			</h:column>
+			<h:column rendered="#{!empty ForumTool.attachments}">
+				<f:facet name="header">
+					<h:outputText value="#{msgs.cdfm_attsize}" />
 				</f:facet>
 				<h:outputText value="#{eachAttach.attachment.attachmentSize}"/>
-			  </h:column>
-			  <h:column rendered="#{!empty ForumTool.attachments}">
-			    <f:facet name="header">
-		  		  <h:outputText value="#{msgs.cdfm_atttype}" />
+			</h:column>
+			<h:column rendered="#{!empty ForumTool.attachments}">
+				<f:facet name="header">
+					<h:outputText value="#{msgs.cdfm_atttype}" />
 				</f:facet>
 				<h:outputText value="#{eachAttach.attachment.attachmentType}"/>
-			  </h:column>
-			</h:dataTable>   
-  
-        		
-<%--********************* Label *********************
-				<sakai:panel_titled>
-          <table width="80%" align="left">
-            <tr>
-              <td align="left" width="20%">
-                <h:outputText value="Label"/>
-              </td>
-              <td align="left">
- 							  <h:selectOneListbox size="1" id="viewlist">
-            		  <f:selectItem itemLabel="Normal" itemValue="none"/>
-          			</h:selectOneListbox>  
-              </td>                           
-            </tr>                                
-          </table>
-        </sakai:panel_titled>
---%>
+			</h:column>
+		</h:dataTable>   
+		
+		<p style="padding:0" class="act">
+			<sakai:button_bar_item action="#{ForumTool.processAddAttachmentRedirect}" value="#{msgs.cdfm_button_bar_add_attachment_redirect}" immediate="true"
+				rendered="#{empty ForumTool.attachments}" style="font-size:95%"/>
+			<sakai:button_bar_item action="#{ForumTool.processAddAttachmentRedirect}" value="#{msgs.cdfm_button_bar_add_attachment_more_redirect}" immediate="true"
+				rendered="#{!empty ForumTool.attachments}" style="font-size:95%"/>
+		</p>
+	
+		<%--********************* Label *********************
+		<sakai:panel_titled>
+		<table width="80%" align="left">
+		<tr>
+		<td align="left" width="20%">
+		<h:outputText value="Label"/>
+		</td>
+		<td align="left">
+		<h:selectOneListbox size="1" id="viewlist">
+		<f:selectItem itemLabel="Normal" itemValue="none"/>
+		</h:selectOneListbox>  
+		</td>                           
+		</tr>                                
+		</table>
+		</sakai:panel_titled>
+		--%>
+		
+		
+		
+		<%--
+		<tr>
+		<td>
+		<h:outputText value="Label" />
+		</td>
+		<td>
+		<h:outputText value="#{ForumTool.selectedMessage.message.label}" />  
+		</td>
+		</tr>
+		--%>
 
-	        
-            
-            <%--
-            <tr>
-              <td>
-                <h:outputText value="Label" />
-              </td>
-              <td>
-              	<h:outputText value="#{ForumTool.selectedMessage.message.label}" />  
-              </td>
-            </tr>
-            --%>
-<%--********************* Reply *********************--%>	     	
-
-		<h4 class="textPanelHeader">
-	  	<h:outputText value="#{msgs.cdfm_replyto}"/>  
-	  </h4> 
-	  
-	<f:verbatim><div class="hierItemBlock"></f:verbatim>
-	<f:verbatim><h4 class="textPanelHeader"></f:verbatim>
+		
+		<p style="padding:0" class="act">
+		<sakai:button_bar_item action="#{ForumTool.processDfReplyMsgPost}" value="#{msgs.cdfm_button_bar_post_message}" accesskey="s" styleClass="active" />
+		<%--    <sakai:button_bar_item action="#{ForumTool.processDfReplyMsgSaveDraft}" value="#{msgs.cdfm_button_bar_save_draft}" /> --%>
+		<sakai:button_bar_item action="#{ForumTool.processDfReplyThreadCancel}" value="#{msgs.cdfm_button_bar_cancel}" accesskey="x" />
+		</p>
+		
+		<script type="text/javascript">
+		setTimeout(function(){ 
+		var _div = document.getElementsByTagName('div');
+		for(i=0;i<_div.length; i++)
+		{
+		if(_div[i].className == 'htmlarea')
+		{
+		var children = _div[i].childNodes;
+		for (j=0; j<children.length; j++)
+		{
+		if(children.item(j).tagName == 'IFRAME')
+		{
+		children.item(j).contentWindow.focus();
+		}
+		}
+		}
+		}
+		}, 800);
+		</script>
 	
-	  <h:panelGrid columns="2" styleClass="itemSummary">
-	    <h:outputText value="#{msgs.cdfm_from}" />
-	    <h:panelGroup>
-	      <h:outputText value="#{ForumTool.selectedMessage.message.author}" />
-	      <h:outputText value=" #{msgs.cdfm_openb}" />
-	      <h:outputText value="#{ForumTool.selectedMessage.message.created}" >
-          <f:convertDateTime pattern="#{msgs.date_format}" />  
-        </h:outputText>
-        <h:outputText value=" #{msgs.cdfm_closeb}" />
-	    </h:panelGroup>
-	    
-	    <h:outputText value="#{msgs.cdfm_subject}" />
-	    <h:outputText value="#{ForumTool.selectedMessage.message.title}" />
-	    
-	    <h:outputText value="#{msgs.cdfm_att}" rendered="#{!empty ForumTool.selectedMessage.message.attachments}"/>
-	    <h:panelGroup rendered="#{!empty ForumTool.selectedMessage.message.attachments}">
-	      <h:dataTable value="#{ForumTool.selectedMessage.message.attachments}" var="eachAttach"  rendered="#{!empty ForumTool.selectedMessage.message.attachments}" columnClasses="attach,bogus" styleClass="attachList">
-					  <h:column rendered="#{!empty ForumTool.selectedMessage.message.attachments}">
-						  <h:graphicImage url="/images/excel.gif" rendered="#{eachAttach.attachmentType == 'application/vnd.ms-excel'}" alt="" />
-							<h:graphicImage url="/images/html.gif" rendered="#{eachAttach.attachmentType == 'text/html'}" alt="" />
-							<h:graphicImage url="/images/pdf.gif" rendered="#{eachAttach.attachmentType == 'application/pdf'}" alt="" />
-							<h:graphicImage url="/sakai-messageforums-tool/images/ppt.gif" rendered="#{eachAttach.attachmentType == 'application/vnd.ms-powerpoint'}" alt="" />
-							<h:graphicImage url="/images/text.gif" rendered="#{eachAttach.attachmentType == 'text/plain'}" alt="" />
-							<h:graphicImage url="/images/word.gif" rendered="#{eachAttach.attachmentType == 'application/msword'}" alt="" />
-							</h:column>
-								<h:column>
-<%--							<h:outputLink value="#{eachAttach.attachmentUrl}" target="_blank">
-							  <h:outputText value="#{eachAttach.attachmentName}"/>
-							  </h:outputLink>--%>
-<%--							<h:outputLink value="#{ForumTool.attachmentUrl}" target="_blank">
-							  <f:param name="attachmentId" value="#{eachAttach.attachment.attachmentId}"/>
-							  <h:outputText value="#{eachAttach.attachment.attachmentName}"/>
-							</h:outputLink>--%>
-						  <h:outputText value="#{eachAttach.attachmentName}"/>							
-					  </h:column>
-					</h:dataTable>
-	    </h:panelGroup> 
-	    </h:panelGrid>
-	    <f:verbatim></h4></f:verbatim>
-	    <mf:htmlShowArea value="#{ForumTool.selectedMessage.message.body}" hideBorder="true" />
-	       
-	<f:verbatim></div></f:verbatim>
-			
-      <sakai:button_bar>
-        <sakai:button_bar_item action="#{ForumTool.processDfReplyMsgPost}" value="#{msgs.cdfm_button_bar_post_message}" accesskey="s" styleClass="active" />
-    <%--    <sakai:button_bar_item action="#{ForumTool.processDfReplyMsgSaveDraft}" value="#{msgs.cdfm_button_bar_save_draft}" /> --%>
-        <sakai:button_bar_item action="#{ForumTool.processDfReplyThreadCancel}" value="#{msgs.cdfm_button_bar_cancel}" accesskey="x" />
-      </sakai:button_bar>
-
-<script type="text/javascript">
-setTimeout(function(){ 
-  var _div = document.getElementsByTagName('div');
-  for(i=0;i<_div.length; i++)
-  {
-    if(_div[i].className == 'htmlarea')
-    {
-      var children = _div[i].childNodes;
-    	for (j=0; j<children.length; j++)
-	    {
-    	  if(children.item(j).tagName == 'IFRAME')
-	      {
-    	    children.item(j).contentWindow.focus();
-	      }
-      }
-    }
-  }
-}, 800);
-</script>
-      
-    </h:form>
-
-  </sakai:view>
+	</h:form>
+	
+	</sakai:view>
 </f:view> 
 
Index: msgcntr/messageforums-app/src/webapp/jsp/compose.jsp
===================================================================
--- msgcntr/messageforums-app/src/webapp/jsp/compose.jsp	(revision 46869)
+++ msgcntr/messageforums-app/src/webapp/jsp/compose.jsp	(working copy)
@@ -92,7 +92,7 @@
 	                                 accesskey="a" />
 	        </sakai:button_bar>
 	      </sakai:doc_section>
-	        <%--gsilver: copying the redenred attribute used in the first h:column to the dataTable - is there are no attachmetns - do not render the table at all.--%>
+	        <%--designNote: copying the redenred attribute used in the first h:column to the dataTable - is there are no attachmetns - do not render the table at all.--%>
 			<h:dataTable styleClass="listHier lines nolines" cellpadding="0" cellspacing="0"
 			columnClasses="attach,bogus,itemAction specialLink,bogus,bogus"  id="attmsg" width="100%" value="#{PrivateMessagesTool.attachments}" var="eachAttach"   rendered="#{!empty PrivateMessagesTool.attachments}">
 		      <h:column rendered="#{!empty PrivateMessagesTool.attachments}">
Index: msgcntr/messageforums-app/src/webapp/jsp/dfMessageReply.jsp
===================================================================
--- msgcntr/messageforums-app/src/webapp/jsp/dfMessageReply.jsp	(revision 46869)
+++ msgcntr/messageforums-app/src/webapp/jsp/dfMessageReply.jsp	(working copy)
@@ -3,245 +3,200 @@
 <%@ taglib uri="http://sakaiproject.org/jsf/sakai" prefix="sakai" %>
 <%@ taglib uri="http://sakaiproject.org/jsf/messageforums" prefix="mf" %>
 <jsp:useBean id="msgs" class="org.sakaiproject.util.ResourceLoader" scope="session">
-   <jsp:setProperty name="msgs" property="baseName" value="org.sakaiproject.api.app.messagecenter.bundle.Messages"/>
+	<jsp:setProperty name="msgs" property="baseName" value="org.sakaiproject.api.app.messagecenter.bundle.Messages"/>
 </jsp:useBean>
-<f:view>
 
-  <sakai:view title="#{msgs.cdfm_reply_tool_bar_message}">
-<!--jsp/dfMessageReply.jsp-->    
-      <h:form id="dfCompose">
-             		<script type="text/javascript" src="/library/js/jquery.js"></script>
-       		<sakai:script contextBase="/sakai-messageforums-tool" path="/js/sak-10625.js"/>
-        <h:outputText styleClass="alertMessage" value="#{msgs.cdfm_reply_deleted}" rendered="#{ForumTool.errorSynch}" />
-	
-
-		  <h3><h:outputText value="#{msgs.cdfm_reply_tool_bar_message}"  /></h3>
-      <h4><h:outputText value="#{ForumTool.selectedForum.forum.title}" />
-		    <h:outputText value=" - "/>
-	      <h:outputText value="#{ForumTool.selectedTopic.topic.title}"/>
-		  </h4>	
-
-    <p class="textPanel">
-		  <h:outputText value="#{ForumTool.selectedTopic.topic.shortDescription}"/>
-    </p>
-
-
+<f:view>
+	<sakai:view title="#{msgs.cdfm_reply_tool_bar_message}">
+	<!--jsp/dfMessageReply.jsp-->    
+		<h:form id="dfCompose">
+			<style type="text/css">
+				@import url("/sakai-messageforums-tool/css/msgcntr.css");
+			</style>
+			
+			<script type="text/javascript" src="/library/js/jquery.js"></script>
+			<sakai:script contextBase="/sakai-messageforums-tool" path="/js/sak-10625.js"/>
+			<h:outputText styleClass="messageAlert" value="#{msgs.cdfm_reply_deleted}" rendered="#{ForumTool.errorSynch}" />
+			<h3><h:outputText value="#{msgs.cdfm_reply_tool_bar_message}"  /></h3>
+			<table class="topicBloc topicBlocLone" border="0">
+				<tr>
+					<td>
+						<h4 style="margin:0 0 1em 0">
+							<h:outputText value="#{ForumTool.selectedForum.forum.title}" />
+							<h:outputText value="/ "/>
+							<h:outputText value="#{ForumTool.selectedTopic.topic.title}"/>
+						</h4>	
+						<h:outputText value="#{ForumTool.selectedTopic.topic.shortDescription}"/>
+					</td>
+				</tr>	
+			</table>
+			<div class="singleMessage">
+				<%-- //designNote: need to make this toggle look and behave exactly like the  rest --%> 
+				<p><a href="javascript:$('#replytomessage').toggle();resizeFrame('grow')" class="show"><h:outputText value="#{msgs.cdfm_replytoshowhide}"/></a></p>
+				<div  id="replytomessage">   
+					<h:outputText value="#{ForumTool.selectedMessage.message.title}" styleClass="title"/>
+					<h:outputText value="#{ForumTool.selectedMessage.message.author}" styleClass="textPanelFooter"  style="padding-left:.5em"/>
+					<h:outputText value=" #{msgs.cdfm_openb}" styleClass="textPanelFooter"/>
+					<h:outputText value="#{ForumTool.selectedMessage.message.created}" styleClass="textPanelFooter">
+						<f:convertDateTime pattern="#{msgs.date_format}" />  
+					</h:outputText>
+					<h:outputText value=" #{msgs.cdfm_closeb}" styleClass="textPanelFooter"/>
+					<mf:htmlShowArea value="#{ForumTool.selectedMessage.message.body}" hideBorder="true" />
+					<h:dataTable value="#{ForumTool.selectedMessage.message.attachments}" var="eachAttach"  rendered="#{!empty ForumTool.selectedMessage.message.attachments}" columnClasses="attach,bogus" styleClass="attachList">
+						<h:column rendered="#{!empty ForumTool.selectedMessage.message.attachments}">
+							<h:graphicImage url="/images/attachment.gif"/>
+						</h:column>
+						<h:column>
+							<%--							<h:outputLink value="#{eachAttach.attachmentUrl}" target="_blank">
+							<h:outputText value="#{eachAttach.attachmentName}"/>
+							</h:outputLink>--%>
+							<%--							<h:outputLink value="#{ForumTool.attachmentUrl}" target="_blank">
+							<f:param name="attachmentId" value="#{eachAttach.attachment.attachmentId}"/>
+							<h:outputText value="#{eachAttach.attachment.attachmentName}"/>
+							</h:outputLink>--%>
+							<h:outputText value="#{eachAttach.attachmentName}"/>							
+						</h:column>
+					</h:dataTable>
+				</div>
+			</div>
 		<p class="instruction">
-              <h:outputText value="#{msgs.cdfm_required}"/>
-              <h:outputText value="#{msgs.cdfm_info_required_sign}" styleClass="reqStarInline" />
-		</p>	  
-          <h:panelGrid styleClass="jsfFormTable" columns="2" style="width: 100%;">
-            <h:panelGroup>
-	   			     <h:outputText value="#{msgs.cdfm_info_required_sign}" styleClass="reqStar"/>
-			  		   <h:outputLabel for="df_compose_title"><h:outputText value="#{msgs.cdfm_reply_title}" /></h:outputLabel>
- 					  </h:panelGroup>
-				   <h:inputText value="#{ForumTool.composeTitle}" style="width: 30em;" required="true" id="df_compose_title" />
+			<h:outputText value="#{msgs.cdfm_required}"/>
+			<h:outputText value="#{msgs.cdfm_info_required_sign}" styleClass="reqStarInline" />
+		</p>	 
 
-          </h:panelGrid>
-          
-          <h:message for="df_compose_title" styleClass="alertMessage" id="errorMessages" />
-		  <h4>
-		     <h:outputText value="#{msgs.cdfm_message}" /> 
-		  </h4>
-		    
-		    <h:inputHidden id="msgHidden" value="#{ForumTool.selectedMessage.message.body}" />
-		    <h:inputHidden id="titleHidden" value="#{ForumTool.selectedMessage.message.title}" />
-		    <div>
-		    	<input type="button" value="Insert Original Text" onClick="InsertHTML();" />
-		   	</div>
-		   	
-            <sakai:rich_text_area value="#{ForumTool.composeBody}" rows="17" columns="70"/>
-            <script language="javascript" type="text/javascript">
-            var textareas = document.getElementsByTagName("textarea");
-	        var rteId = textareas.item(0).id;
-	        
-//	        function FCKeditor_OnComplete( editorInstance )
-//	        {
-//	          // clears the FCK editor after initial loading
-//	          editorInstance.SetHTML( "" );
-//	        }
-	        
-	        // set the previous message variable
-	        var messagetext = document.forms['dfCompose'].elements['dfCompose:msgHidden'].value;
-	        var titletext = document.forms['dfCompose'].elements['dfCompose:titleHidden'].value;
-	        
-            function InsertHTML() 
-            { 
-              // These lines will write to the original textarea and makes the quoting work when FCK is not present
-              var finalhtml = '<b><i><h:outputText value="#{msgs.cdfm_insert_original_text_comment}" /></i></b><br/><b><i><h:outputText value="#{msgs.cdfm_from}" /></i></b> <i><h:outputText value="#{ForumTool.selectedMessage.message.author}" /><h:outputText value=" #{msgs.cdfm_openb}" /><h:outputText value="#{ForumTool.selectedMessage.message.created}" ><f:convertDateTime pattern="#{msgs.date_format}" /></h:outputText><h:outputText value="#{msgs.cdfm_closeb}" /></i><br/><b><i><h:outputText value="#{msgs.cdfm_subject}" /></i></b> <i>' + titletext + '</i><br/><br/><i>' + messagetext + '</i><br/><br/>';
-              document.forms['dfCompose'].elements[rteId].value = finalhtml;
-              // Get the editor instance that we want to interact with.
-              var oEditor = FCKeditorAPI.GetInstance(rteId);
-              // Check the active editing mode.
-              if ( oEditor.EditMode == FCK_EDITMODE_WYSIWYG )
-              {
-              // Insert the desired HTML.
-              oEditor.InsertHtml( finalhtml );
-              }
-              else alert( 'You must be on WYSIWYG mode!' );
-            }
+			<h:panelGrid styleClass="jsfFormTable" columns="1" style="width: 100%;margin:0;">
+				
+			<h:panelGroup style="padding-top:.5em">
+				<h:message for="df_compose_title" styleClass="messageAlert" id="errorMessages"/>	
+				<h:outputLabel for="df_compose_title" styleClass="block" style="display:block;float:none;clear:both;padding-bottom:.3em;padding-top:.5em"><h:outputText value="#{msgs.cdfm_info_required_sign}" styleClass="reqStar"/><h:outputText value="#{msgs.cdfm_reply_title}" /></h:outputLabel>
+					<h:inputText value="#{ForumTool.composeTitle}" style="width: 30em;" required="true" id="df_compose_title" />
+				</h:panelGroup>
+			</h:panelGrid>
+			<h:outputText value="#{msgs.cdfm_message}" /> 
+
+			<h:inputHidden id="msgHidden" value="#{ForumTool.selectedMessage.message.body}" />
+			<h:inputHidden id="titleHidden" value="#{ForumTool.selectedMessage.message.title}" />
+			<h:outputText value="&nbsp;&nbsp;&nbsp; " escape="false" />
+			<a  href="#"  onclick="InsertHTML();">
+			<img src="/library/image/silk/paste_plain.png" />
+			<h:outputText value="#{msgs.cdfm_message_insert}" /></a>
+			<sakai:rich_text_area value="#{ForumTool.composeBody}" rows="17" columns="70"/>
+			<script language="javascript" type="text/javascript">
+				var textareas = document.getElementsByTagName("textarea");
+				var rteId = textareas.item(0).id;
+	
+				//	        function FCKeditor_OnComplete( editorInstance )
+				//	        {
+				//	          // clears the FCK editor after initial loading
+				//	          editorInstance.SetHTML( "" );
+				//	        }
+							
+				// set the previous message variable
+				var messagetext = document.forms['dfCompose'].elements['dfCompose:msgHidden'].value;
+				var titletext = document.forms['dfCompose'].elements['dfCompose:titleHidden'].value;
+			
+				function InsertHTML() 
+				{ 
+				  // These lines will write to the original textarea and makes the quoting work when FCK is not present
+				  var finalhtml = '<b><i><h:outputText value="#{msgs.cdfm_insert_original_text_comment}" /></i></b><br/><b><i><h:outputText value="#{msgs.cdfm_from}" /></i></b> <i><h:outputText value="#{ForumTool.selectedMessage.message.author}" /><h:outputText value=" #{msgs.cdfm_openb}" /><h:outputText value="#{ForumTool.selectedMessage.message.created}" ><f:convertDateTime pattern="#{msgs.date_format}" /></h:outputText><h:outputText value="#{msgs.cdfm_closeb}" /></i><br/><b><i><h:outputText value="#{msgs.cdfm_subject}" /></i></b> <i>' + titletext + '</i><br/><br/><i>' + messagetext + '</i><br/><br/>';
+				  document.forms['dfCompose'].elements[rteId].value = finalhtml;
+				  // Get the editor instance that we want to interact with.
+				  var oEditor = FCKeditorAPI.GetInstance(rteId);
+				  // Check the active editing mode.
+				  if ( oEditor.EditMode == FCK_EDITMODE_WYSIWYG )
+				  {
+				  // Insert the desired HTML.
+				  oEditor.InsertHtml( finalhtml );
+				  }
+				  else alert( 'You must be on WYSIWYG mode!' );
+				}
             </script>
             
-<%--********************* Attachment *********************--%>	
-	        <h4>
-	          <h:outputText value="#{msgs.cdfm_att}"/>
-	        </h4>
-			<h:outputText value="#{msgs.cdfm_no_attachments}" rendered="#{empty ForumTool.attachments}" styleClass="instruction" />
-
-	          <sakai:button_bar>
-	          	<sakai:button_bar_item action="#{ForumTool.processAddAttachmentRedirect}" value="#{msgs.cdfm_button_bar_add_attachment_redirect}" immediate="true"/>
-	          </sakai:button_bar>
-	        <%-- gsilver:moving rendered attr from column to table to avoid childless table if empty--%>
-		    <h:dataTable styleClass="listHier lines nolines" id="attmsg" width="100%" value="#{ForumTool.attachments}" var="eachAttach"   rendered="#{!empty ForumTool.attachments}"
-			columnClasses="attach,bogus,specialLink itemAction,bogus,bogus">
-			  <h:column rendered="#{!empty ForumTool.attachments}">
-				  <h:graphicImage url="/images/excel.gif" rendered="#{eachAttach.attachment.attachmentType == 'application/vnd.ms-excel'}" alt="" />
-				  <h:graphicImage url="/images/html.gif" rendered="#{eachAttach.attachment.attachmentType == 'text/html'}" alt="" />
-				  <h:graphicImage url="/images/pdf.gif" rendered="#{eachAttach.attachment.attachmentType == 'application/pdf'}"/>
-				  <h:graphicImage url="/images/ppt.gif" rendered="#{eachAttach.attachment.attachmentType == 'application/vnd.ms-powerpoint'}" alt="" />
-				  <h:graphicImage url="/images/text.gif" rendered="#{eachAttach.attachment.attachmentType == 'text/plain'}" alt="" />
-				  <h:graphicImage url="/images/word.gif" rendered="#{eachAttach.attachment.attachmentType == 'application/msword'}" alt="" />
+			<%--********************* Attachment *********************--%>	
+			<h4>
+				<h:outputText value="#{msgs.cdfm_att}"/>
+			</h4>
+			<p>
+				<h:outputText value="#{msgs.cdfm_no_attachments}" rendered="#{empty ForumTool.attachments}" styleClass="instruction" />
+			</p>	
+	    <%--//designNote: moving rendered attr from column to table to avoid childless table if empty--%>
+			<h:dataTable styleClass="attachPanel" id="attmsg"  value="#{ForumTool.attachments}" var="eachAttach"   rendered="#{!empty ForumTool.attachments}"
+				columnClasses="attach,bogus,specialLink itemAction,bogus,bogus">
+				<h:column rendered="#{!empty ForumTool.attachments}">
+					<h:graphicImage url="/images/excel.gif" rendered="#{eachAttach.attachment.attachmentType == 'application/vnd.ms-excel'}" alt="" />
+					<h:graphicImage url="/images/html.gif" rendered="#{eachAttach.attachment.attachmentType == 'text/html'}" alt="" />
+					<h:graphicImage url="/images/pdf.gif" rendered="#{eachAttach.attachment.attachmentType == 'application/pdf'}"/>
+					<h:graphicImage url="/images/ppt.gif" rendered="#{eachAttach.attachment.attachmentType == 'application/vnd.ms-powerpoint'}" alt="" />
+					<h:graphicImage url="/images/text.gif" rendered="#{eachAttach.attachment.attachmentType == 'text/plain'}" alt="" />
+					<h:graphicImage url="/images/word.gif" rendered="#{eachAttach.attachment.attachmentType == 'application/msword'}" alt="" />
 				</h:column>
-				  <h:column>
-					  <f:facet name="header">
+				<h:column>
+					<f:facet name="header">
 						<h:outputText value="#{msgs.cdfm_title}"/>
 					</f:facet>
-					  <h:outputText value="#{eachAttach.attachment.attachmentName}"/>			
+					<h:outputText value="#{eachAttach.attachment.attachmentName}"/>			
 				</h:column>
 				<h:column>
-				  <h:commandLink action="#{ForumTool.processDeleteAttach}" 
-								immediate="true"
-								onfocus="document.forms[0].onsubmit();"
-								title="#{msgs.cdfm_remove}">
-				    <h:outputText value="#{msgs.cdfm_remove}"/>
-<%--									<f:param value="#{eachAttach.attachment.attachmentId}" name="dfmsg_current_attach"/>--%>
-					<f:param value="#{eachAttach.attachment.attachmentId}" name="dfmsg_current_attach"/>
-				  </h:commandLink>
-			  </h:column>
-			  <h:column rendered="#{!empty ForumTool.attachments}">
-			    <f:facet name="header">
-				  <h:outputText value="#{msgs.cdfm_attsize}" />
-				</f:facet>
-				<h:outputText value="#{eachAttach.attachment.attachmentSize}"/>
-			  </h:column>
-			  <h:column rendered="#{!empty ForumTool.attachments}">
-			    <f:facet name="header">
-		  		  <h:outputText value="#{msgs.cdfm_atttype}" />
-				</f:facet>
-				<h:outputText value="#{eachAttach.attachment.attachmentType}"/>
-			  </h:column>
+					<h:commandLink action="#{ForumTool.processDeleteAttach}" 
+							immediate="true"
+							onfocus="document.forms[0].onsubmit();"
+							title="#{msgs.cdfm_remove}">
+						<h:outputText value="#{msgs.cdfm_remove}"/>
+						<%--<f:param value="#{eachAttach.attachment.attachmentId}" name="dfmsg_current_attach"/>--%>
+						<f:param value="#{eachAttach.attachment.attachmentId}" name="dfmsg_current_attach"/>
+					</h:commandLink>
+				</h:column>
+				<h:column rendered="#{!empty ForumTool.attachments}">
+					<f:facet name="header">
+						<h:outputText value="#{msgs.cdfm_attsize}" />
+					</f:facet>
+					<h:outputText value="#{eachAttach.attachment.attachmentSize}"/>
+				</h:column>
+				<h:column rendered="#{!empty ForumTool.attachments}">
+					<f:facet name="header">
+						<h:outputText value="#{msgs.cdfm_atttype}" />
+					</f:facet>
+					<h:outputText value="#{eachAttach.attachment.attachmentType}"/>
+				</h:column>
 			</h:dataTable>   
-  
-        		
-<%--********************* Label *********************
-				<sakai:panel_titled>
-          <table width="80%" align="left">
-            <tr>
-              <td align="left" width="20%">
-                <h:outputText value="Label"/>
-              </td>
-              <td align="left">
- 							  <h:selectOneListbox size="1" id="viewlist">
-            		  <f:selectItem itemLabel="Normal" itemValue="none"/>
-          			</h:selectOneListbox>  
-              </td>                           
-            </tr>                                
-          </table>
-        </sakai:panel_titled>
---%>
 
-	        
-            
-            <%--
-            <tr>
-              <td>
-                <h:outputText value="Label" />
-              </td>
-              <td>
-              	<h:outputText value="#{ForumTool.selectedMessage.message.label}" />  
-              </td>
-            </tr>
-            --%>
-<%--********************* Reply *********************--%>	     	
+			<p style="padding:0" class="act">
+				<sakai:button_bar_item action="#{ForumTool.processAddAttachmentRedirect}" value="#{msgs.cdfm_button_bar_add_attachment_redirect}" immediate="true"
+					rendered="#{empty ForumTool.attachments}" style="font-size:95%"/>
+				<sakai:button_bar_item action="#{ForumTool.processAddAttachmentRedirect}" value="#{msgs.cdfm_button_bar_add_attachment_more_redirect}" immediate="true"
+					rendered="#{!empty ForumTool.attachments}" style="font-size:95%"/>
+			</p>
 
-		<h4 class="textPanelHeader">
-	  	<h:outputText value="#{msgs.cdfm_replyto}"/>  
-	  </h4> 
-	  
-	<f:verbatim><div class="hierItemBlock"></f:verbatim>
-	<f:verbatim><h4 class="textPanelHeader"></f:verbatim>
-	
-	  <h:panelGrid columns="2" styleClass="itemSummary">
-	    <h:outputText value="#{msgs.cdfm_from}" />
-	    <h:panelGroup>
-	      <h:outputText value="#{ForumTool.selectedMessage.message.author}" />
-	      <h:outputText value=" #{msgs.cdfm_openb}" />
-	      <h:outputText value="#{ForumTool.selectedMessage.message.created}" >
-          <f:convertDateTime pattern="#{msgs.date_format}" />  
-        </h:outputText>
-        <h:outputText value=" #{msgs.cdfm_closeb}" />
-	    </h:panelGroup>
-	    
-	    <h:outputText value="#{msgs.cdfm_subject}" />
-	    <h:outputText value="#{ForumTool.selectedMessage.message.title}" />
-	    
-	    <h:outputText value="#{msgs.cdfm_att}" rendered="#{!empty ForumTool.selectedMessage.message.attachments}"/>
-	    <h:panelGroup rendered="#{!empty ForumTool.selectedMessage.message.attachments}">
-	      <h:dataTable value="#{ForumTool.selectedMessage.message.attachments}" var="eachAttach"  rendered="#{!empty ForumTool.selectedMessage.message.attachments}" columnClasses="attach,bogus" styleClass="attachList">
-					  <h:column rendered="#{!empty ForumTool.selectedMessage.message.attachments}">
-						  <h:graphicImage url="/images/excel.gif" rendered="#{eachAttach.attachmentType == 'application/vnd.ms-excel'}" alt="" />
-							<h:graphicImage url="/images/html.gif" rendered="#{eachAttach.attachmentType == 'text/html'}" alt="" />
-							<h:graphicImage url="/images/pdf.gif" rendered="#{eachAttach.attachmentType == 'application/pdf'}" alt="" />
-							<h:graphicImage url="/sakai-messageforums-tool/images/ppt.gif" rendered="#{eachAttach.attachmentType == 'application/vnd.ms-powerpoint'}" alt="" />
-							<h:graphicImage url="/images/text.gif" rendered="#{eachAttach.attachmentType == 'text/plain'}" alt="" />
-							<h:graphicImage url="/images/word.gif" rendered="#{eachAttach.attachmentType == 'application/msword'}" alt="" />
-							</h:column>
-								<h:column>
-<%--							<h:outputLink value="#{eachAttach.attachmentUrl}" target="_blank">
-							  <h:outputText value="#{eachAttach.attachmentName}"/>
-							  </h:outputLink>--%>
-<%--							<h:outputLink value="#{ForumTool.attachmentUrl}" target="_blank">
-							  <f:param name="attachmentId" value="#{eachAttach.attachment.attachmentId}"/>
-							  <h:outputText value="#{eachAttach.attachment.attachmentName}"/>
-							</h:outputLink>--%>
-						  <h:outputText value="#{eachAttach.attachmentName}"/>							
-					  </h:column>
-					</h:dataTable>
-	    </h:panelGroup> 
-	    </h:panelGrid>
-	    <f:verbatim></h4></f:verbatim>
-	    <mf:htmlShowArea value="#{ForumTool.selectedMessage.message.body}" hideBorder="true" />
-	       
-	<f:verbatim></div></f:verbatim>
-			
-      <sakai:button_bar>
-        <sakai:button_bar_item action="#{ForumTool.processDfReplyMsgPost}" value="#{msgs.cdfm_button_bar_post_message}" accesskey="s" styleClass="active" />
-    <%--    <sakai:button_bar_item action="#{ForumTool.processDfReplyMsgSaveDraft}" value="#{msgs.cdfm_button_bar_save_draft}" /> --%>
-        <sakai:button_bar_item action="#{ForumTool.processDfReplyMsgCancel}" value="#{msgs.cdfm_button_bar_cancel}" accesskey="x" />
-      </sakai:button_bar>
-
-<script type="text/javascript">
-setTimeout(function(){ 
-  var _div = document.getElementsByTagName('div');
-  for(i=0;i<_div.length; i++)
-  {
-    if(_div[i].className == 'htmlarea')
-    {
-      var children = _div[i].childNodes;
-    	for (j=0; j<children.length; j++)
-	    {
-    	  if(children.item(j).tagName == 'IFRAME')
-	      {
-    	    children.item(j).contentWindow.focus();
-	      }
-      }
-    }
-  }
-}, 800);
-</script>
+			<p style="padding:0" class="act">
+				<sakai:button_bar_item action="#{ForumTool.processDfReplyMsgPost}" value="#{msgs.cdfm_button_bar_post_message}" accesskey="s" styleClass="active" />
+				<%-- <sakai:button_bar_item action="#{ForumTool.processDfReplyMsgSaveDraft}" value="#{msgs.cdfm_button_bar_save_draft}" /> --%>
+				<sakai:button_bar_item action="#{ForumTool.processDfReplyMsgCancel}" value="#{msgs.cdfm_button_bar_cancel}" accesskey="x" />
+			</p>
+			<%--
+				<sakai:button_bar>
+				</sakai:button_bar>
+			--%>
+			<script type="text/javascript">
+				setTimeout(function(){ 
+				  var _div = document.getElementsByTagName('div');
+				  for(i=0;i<_div.length; i++)
+				  {
+					if(_div[i].className == 'htmlarea')
+					{
+					  var children = _div[i].childNodes;
+						for (j=0; j<children.length; j++)
+						{
+						  if(children.item(j).tagName == 'IFRAME')
+						  {
+							children.item(j).contentWindow.focus();
+						  }
+					  }
+					}
+				  }
+				}, 800);
+			</script>
       
-    </h:form>
-
-  </sakai:view>
+		</h:form>
+	</sakai:view>
 </f:view> 

Index: msgcntr/messageforums-app/src/webapp/jsp/synoptic/synMain.jsp
===================================================================
--- msgcntr/messageforums-app/src/webapp/jsp/synoptic/synMain.jsp	(revision 46869)
+++ msgcntr/messageforums-app/src/webapp/jsp/synoptic/synMain.jsp	(working copy)
@@ -1,160 +1,189 @@
 <%@ page import="java.io.PrintWriter" %>
 <%@ page import="java.util.*, javax.faces.context.*, javax.faces.application.*,
-                 javax.faces.el.*, org.sakaiproject.tool.messageforums.ui.*"%>
+		javax.faces.el.*, org.sakaiproject.tool.messageforums.ui.*"%>
 
 <%
-	/** if MyWorkspace, display wait page. **/
-	FacesContext context = FacesContext.getCurrentInstance();
-	Application app = context.getApplication();
-	ValueBinding binding = app.createValueBinding("#{mfSynopticBean}");
-	MessageForumSynopticBean mfsb = (MessageForumSynopticBean) binding.getValue(context);
+/** if MyWorkspace, display wait page. **/
+FacesContext context = FacesContext.getCurrentInstance();
+Application app = context.getApplication();
+ValueBinding binding = app.createValueBinding("#{mfSynopticBean}");
+MessageForumSynopticBean mfsb = (MessageForumSynopticBean) binding.getValue(context);
 
-	// If user navigates back to tool and in myWorkspace, display wait page first.
-	if (! "1".equals(request.getParameter("time")) && mfsb.isMyWorkspace()) {
-	   	PrintWriter writer = response.getWriter();
-   		writer.println("<script language='JavaScript'>var url = window.location.href;");
-  		writer.println("var lastSlash = url.lastIndexOf('/');");
-   		writer.println("url = url.substring(0, lastSlash+1) + 'wait?url=' + url.substring(lastSlash+1);");
-     	writer.println("window.location.href = url;");
-   		writer.println("</script>");
- 		return;
+// If user navigates back to tool and in myWorkspace, display wait page first.
+if (! "1".equals(request.getParameter("time")) && mfsb.isMyWorkspace()) {
+	PrintWriter writer = response.getWriter();
+	writer.println("<script language='JavaScript'>var url = window.location.href;");
+	writer.println("var lastSlash = url.lastIndexOf('/');");
+	writer.println("url = url.substring(0, lastSlash+1) + 'wait?url=' + url.substring(lastSlash+1);");
+	writer.println("window.location.href = url;");
+	writer.println("</script>");
+	return;
 	}
-	else {
-%>
-
-<%@ taglib uri="http://java.sun.com/jsf/html" prefix="h" %>
-<%@ taglib uri="http://java.sun.com/jsf/core" prefix="f" %>
-<%@ taglib uri="http://sakaiproject.org/jsf/sakai" prefix="sakai" %>
-
-<jsp:useBean id="msgs" class="org.sakaiproject.util.ResourceLoader" scope="session">
-   <jsp:setProperty name="msgs" property="baseName" value="org.sakaiproject.api.app.messagecenter.bundle.Messages"/>
-</jsp:useBean>
-
-<f:view>
-  <sakai:view>
-	<h:form>
-	  <sakai:script contextBase="/sakai-messageforums-tool" path="/js/popupscripts.js"/>
-
-	  <h:panelGroup rendered="#{mfSynopticBean.myWorkspace}" > 
-
-		<h:outputText value="#{msgs.syn_no_sites}" rendered="#{! mfSynopticBean.sitesToView}" />
-
-		<%-- ===== Display when in MyWorkspace ===== --%>
-		<f:subview id="myWorkspaceUnread" >
-	 	<h:dataTable value="#{mfSynopticBean.contents}" var="eachSite" styleClass="listHier lines nolines"
-	 			rendered = "#{mfSynopticBean.sitesToView}" >
- 
-       		<h:column>
-				<f:facet name="header">
-			 		<h:outputText  value="#{msgs.syn_site_heading}"/>
-				</f:facet>
-			
-				<h:outputText value="#{eachSite.siteName}" />
-	   		</h:column>
-
-			<h:column>
-				<f:facet name="header">
- 					<h:outputText  value="#{msgs.syn_private_heading}"/>
- 				</f:facet>
-
-				<h:panelGroup rendered="#{eachSite.messagesandForums || eachSite.messages}" >			
-	 				<%-- === To create a link to Messages (& Forums) home page === --%>
-					<h:outputText value="#{msgs.syn_tool_link_begin}#{eachSite.privateMessagesUrl}';\">#{eachSite.unreadPrivateAmt}</a>" 
-						escape="false" title="#{msgs.syn_goto_messages}" rendered="#{eachSite.unreadPrivateAmt > 0}"/>
-					<h:outputText value="  " rendered="#{eachSite.unreadPrivateAmt > 0}" />
-
-		 			<h:commandLink action="synMain"
-						actionListener="#{mfSynopticBean.processReadAll}"
-						rendered="#{eachSite.unreadPrivateAmt > 0}"
-						styleClass="active">
-							<h:graphicImage url="/../library/image/silk/email_edit.png" title="#{msgs.syn_mark_as_read}"
-								onmouseover="ImageRollOver(this, '/..//library/image/silk/email_open.png');"
-								onmouseout="ImageRollOver(this, '/../library/image/silk/email_edit.png');"
-								rendered="#{eachSite.unreadPrivateAmt > 0}" />
-							<f:param name="contextId" value="#{eachSite.siteId}" />
-					</h:commandLink>
+else {
+	%>
+	
+	<%@ taglib uri="http://java.sun.com/jsf/html" prefix="h" %>
+	<%@ taglib uri="http://java.sun.com/jsf/core" prefix="f" %>
+	<%@ taglib uri="http://sakaiproject.org/jsf/sakai" prefix="sakai" %>
+	
+	<jsp:useBean id="msgs" class="org.sakaiproject.util.ResourceLoader" scope="session">
+		<jsp:setProperty name="msgs" property="baseName" value="org.sakaiproject.api.app.messagecenter.bundle.Messages"/>
+	</jsp:useBean>
+	
+	<f:view>
+		<sakai:view>
+			<h:form styleClass="specialLink">
+				<sakai:script contextBase="/sakai-messageforums-tool" path="/js/popupscripts.js"/>
 				
-					<h:outputText value="#{msgs.syn_no_messages}" rendered="#{eachSite.unreadPrivateAmt == 0}" />			
-				</h:panelGroup>
-			</h:column>
+				<h:panelGroup rendered="#{mfSynopticBean.myWorkspace}" > 
+					<h:outputText value="#{msgs.syn_no_sites}" rendered="#{!mfSynopticBean.sitesToView}" />
+					
+					<%-- ===== Display when in MyWorkspace ===== --%>
+					<f:subview id="myWorkspaceUnread" >
+						<h:dataTable value="#{mfSynopticBean.contents}" var="eachSite" styleClass="listHier lines nolines"
+								rendered = "#{mfSynopticBean.sitesToView}" >
+						
+							<h:column>
+								<f:facet name="header">
+									<h:outputText  value="#{msgs.syn_site_heading}"/>
+								</f:facet>
+							
+								<h:outputText value="#{eachSite.siteName}" />
+							</h:column>
+							
+							<h:column>
+								<f:facet name="header">
+									<h:outputText  value="#{msgs.syn_private_heading}"/>
+								</f:facet>
+								
+								<h:panelGroup rendered="#{eachSite.messagesandForums || eachSite.messages}" >
+									<%-- === To create a link to Messages (& Forums) home page === 
+									--%>
+											<h:outputText value="#{eachSite.unreadPrivateAmt}" rendered="#{eachSite.unreadPrivateAmt > 0}" style="width:3.5em;display:block;float:left"/>
+											<h:panelGroup style="display:block;float:left">
+											<h:graphicImage url="/../library/image/silk/email_go.png" rendered="#{eachSite.unreadPrivateAmt > 0}" />	
+											<h:outputText value="#{msgs.syn_tool_link_begin}#{eachSite.privateMessagesUrl}';\">
+												Read</a>" 
+													escape="false" title="#{msgs.syn_goto_messages}" rendered="#{eachSite.unreadPrivateAmt > 0}"
+													/>
+											<%--
+												<h:outputText value="  " rendered="#{eachSite.unreadPrivateAmt > 0}" />
+											--%>									
+												<h:commandLink action="synMain"
+														actionListener="#{mfSynopticBean.processReadAll}"
+														rendered="#{eachSite.unreadPrivateAmt > 0}"
+														style="padding: 0 1em"
+														title="#{msgs.syn_mark_as_read}">
 
-			<h:column>
-				<f:facet name="header">
-					<h:outputText  value="#{msgs.syn_discussion_heading}"/>
- 				</f:facet>
- 				
-				<h:panelGroup rendered="#{eachSite.messagesandForums || eachSite.forums}" > 				
-					<%-- === To create a link to (Messages &) Forums home page === --%>
-					<h:outputText value="#{msgs.syn_tool_link_begin}#{eachSite.mcPageURL}';\">#{eachSite.unreadForumsAmt}</a>" 
-							escape="false" title="#{msgs.syn_goto_forums}" rendered="#{eachSite.unreadForumsAmt > 0}"/>
-					<h:outputText value="  " rendered="#{eachSite.unreadForumsAmt > 0}" />
-
-					<h:graphicImage url="#{PrivateMessagesTool.serverUrl}/library/image/silk/email.png" rendered="#{eachSite.unreadForumsAmt > 0}" />
-
-					<h:outputText value="#{msgs.syn_no_messages}" rendered="#{eachSite.unreadForumsAmt == 0}" />
+													<h:graphicImage url="/images/12-em-check.png" alt="#{msgs.syn_mark_as_read}"
+															rendered="#{eachSite.unreadPrivateAmt > 0}" />
+															<h:outputText  value="#{msgs.syn_mark_as_read}"/>
+													<%--		
+													<h:graphicImage url="/../library/image/silk/email_edit.png" title="#{msgs.syn_mark_as_read}"
+															onmouseover="ImageRollOver(this, '/..//library/image/silk/email_open.png');"
+															onmouseout="ImageRollOver(this, '/../library/image/silk/email_edit.png');"
+															rendered="#{eachSite.unreadPrivateAmt > 0}" />
+													--%>	
+														
+														
+													<f:param name="contextId" value="#{eachSite.siteId}" />
+												</h:commandLink>
+											</h:panelGroup>	
+										<h:outputText value="#{msgs.syn_no_messages}" rendered="#{eachSite.unreadPrivateAmt == 0}" />
+								</h:panelGroup>
+							</h:column>
+							
+							<h:column>
+								<f:facet name="header">
+									<h:outputText  value="#{msgs.syn_discussion_heading}"/>
+								</f:facet>
+								
+								<h:panelGroup rendered="#{eachSite.messagesandForums || eachSite.forums}" >
+									
+										<h:outputText value="#{eachSite.unreadForumsAmt}" rendered="#{eachSite.unreadForumsAmt > 0}" style="width:3.5em;display:block;float:left"/>								
+										<h:panelGroup style="display:block;float:left">
+										<%-- === To create a link to (Messages &) Forums home page === --%>
+										<h:graphicImage url="/../library/image/silk/comments.png" alt="#{msgs.syn_goto_forums}"  rendered="#{eachSite.unreadForumsAmt > 0}"/>
+										<h:outputText value="#{msgs.syn_tool_link_begin}#{eachSite.mcPageURL}';\">Read</a>" 
+												escape="false" title="#{msgs.syn_goto_forums}" rendered="#{eachSite.unreadForumsAmt > 0}" />
+										<%--
+											<h:graphicImage url="#{PrivateMessagesTool.serverUrl}/library/image/silk/email.png" rendered="#{eachSite.unreadForumsAmt > 0}" />
+										--%>
+									</h:panelGroup>
+									
+									<h:outputText value="#{msgs.syn_no_messages}" rendered="#{eachSite.unreadForumsAmt == 0}" />
+									
+								</h:panelGroup>
+							</h:column>
+						</h:dataTable>
+					</f:subview>
 				</h:panelGroup>
-			</h:column>
-	 	</h:dataTable>
-	 	</f:subview>
-	</h:panelGroup>
-
-	<%-- ====== Dispaly for homepage of a site ===== --%>
-	
-	<%-- *** Display this if Message & Forums or either piece is not part of site *** --%>
-	<h:outputText value="#{msgs.syn_no_mc}" rendered="#{(! mfSynopticBean.myWorkspace) && (! mfSynopticBean.anyMFToolInSite)}" />
-
-	<%-- *** Display this if Message Center is part of site *** --%>
-	<h:panelGrid columns="2" styleClass="listHier lines nolines"
-		rendered="#{(! mfSynopticBean.myWorkspace) && mfSynopticBean.anyMFToolInSite}" >
-		
-		<h:panelGroup rendered="#{mfSynopticBean.messageForumsPageInSite || mfSynopticBean.messagesPageInSite}" >
-			<h:outputText value="#{msgs.syn_tool_link_begin}#{mfSynopticBean.siteInfo.privateMessagesUrl}';\">#{msgs.syn_private_heading}</a>"
+				
+				<%-- ====== Dispaly for homepage of a site ===== --%>
+				
+				<%-- *** Display this if Message & Forums or either piece is not part of site *** --%>
+				<h:outputText value="#{msgs.syn_no_mc}" rendered="#{(! mfSynopticBean.myWorkspace) && (! mfSynopticBean.anyMFToolInSite)}" />
+				
+				<%-- *** Display this if Message Center is part of site *** --%>
+				<h:panelGrid columns="2" styleClass="listHier lines nolines"
+						rendered="#{(! mfSynopticBean.myWorkspace) && mfSynopticBean.anyMFToolInSite}" >
+					
+					<h:panelGroup rendered="#{mfSynopticBean.messageForumsPageInSite || mfSynopticBean.messagesPageInSite}" >
+						<h:outputText value="#{msgs.syn_tool_link_begin}#{mfSynopticBean.siteInfo.privateMessagesUrl}';\">#{msgs.syn_private_heading}</a>"
 							escape="false" title="#{msgs.syn_goto_messages}" />
-		</h:panelGroup>
-		
-		<h:panelGroup rendered="#{mfSynopticBean.messageForumsPageInSite || mfSynopticBean.messagesPageInSite}" >
-			<h:outputText value="#{msgs.syn_no_messages}" rendered="#{mfSynopticBean.siteInfo.unreadPrivateAmt == 0}" />
+					</h:panelGroup>
+					
+					<h:panelGroup rendered="#{mfSynopticBean.messageForumsPageInSite || mfSynopticBean.messagesPageInSite}" >
+						<h:outputText value="#{msgs.syn_no_messages}" rendered="#{mfSynopticBean.siteInfo.unreadPrivateAmt == 0}"  />
+					
+						<h:panelGroup rendered="#{mfSynopticBean.siteInfo.unreadPrivateAmt > 0}">
+							<h:outputText value="#{mfSynopticBean.siteInfo.unreadPrivateAmt}" rendered="#{mfSynopticBean.siteInfo.unreadPrivateAmt > 0}" style="width:3.5em;display:block;float:left"/>
+							<h:panelGroup style="display:block;float:left">
+								<h:graphicImage url="/../library/image/silk/email_go.png" alt="#{msgs.syn_mark_as_read}"
+										rendered="#{mfSynopticBean.siteInfo.unreadPrivateAmt > 0}"/>
+								<h:outputText 
+										value="#{msgs.syn_tool_link_begin}#{mfSynopticBean.siteInfo.privateMessagesUrl}';\">Read</a>"
+										escape="false" title="#{msgs.syn_goto_messages}" rendered="#{mfSynopticBean.siteInfo.unreadPrivateAmt > 0}" />
+										<h:outputText value="  " rendered="true" />
+										<h:outputText escape="false" value="&nbsp;&nbsp;" />
+								<h:commandLink action="synMain" actionListener="#{mfSynopticBean.processReadAll}" styleClass="active" >
+									<h:graphicImage url="/images/12-em-check.png" alt="#{msgs.syn_mark_as_read}" />
+										<h:outputText value="#{msgs.syn_mark_as_read} " />
+									<f:param name="contextId" value="#{eachSite.siteId}" />
+								</h:commandLink>
+							</h:panelGroup>	
+						</h:panelGroup>
+					</h:panelGroup>
+					
+					<h:panelGroup rendered="#{mfSynopticBean.messageForumsPageInSite || mfSynopticBean.forumsPageInSite}">
+					<h:outputText 
+								value="#{msgs.syn_tool_link_begin}#{mfSynopticBean.siteInfo.mcPageURL}';\">#{msgs.syn_discussion_heading}</a>"
+								escape="false" title="#{msgs.syn_goto_forums}" />
+					</h:panelGroup>			
+						<h:panelGroup rendered="#{mfSynopticBean.messageForumsPageInSite || mfSynopticBean.forumsPageInSite}">			
+						<h:outputText value="#{msgs.syn_no_messages}" rendered="#{mfSynopticBean.siteInfo.unreadForumsAmt == 0}"/>
+						<h:panelGroup>
+							<h:outputText value="#{mfSynopticBean.siteInfo.unreadForumsAmt}" rendered="#{mfSynopticBean.siteInfo.unreadForumsAmt > 0}"   style="width:3.5em;display:block;float:left"/>
+							<h:panelGroup   style="display:block;float:left">
+								<h:graphicImage url="/../library/image/silk/comments.png" alt="#{msgs.syn_goto_forums}"  rendered="#{mfSynopticBean.siteInfo.unreadForumsAmt > 0}"/>
+								<h:outputText value="#{msgs.syn_tool_link_begin}#{mfSynopticBean.siteInfo.mcPageURL}';\">Read</a>" 
+										escape="false" title="#{msgs.syn_goto_forums}" rendered="#{mfSynopticBean.siteInfo.unreadForumsAmt > 0}"/>
+									<%--
+									<h:graphicImage url="/sakai-messageforums-tool/images/12-em-check.png" rendered="#{mfSynopticBean.siteInfo.unreadForumsAmt > 0}" />
+									--%>
+								</h:panelGroup>	
+						</h:panelGroup>
+					</h:panelGroup>
+				</h:panelGrid>
+				
+				<!-- This is the div for the popup definition. It is not displayed until the element is moused over -->
+				<div id="markAsRead" class="markasread_popup" 
+						style="position:absolute; top: -1000px; left: -1000px;" >
+					<h:outputText value="#{msgs.syn_mark_as_read}" />
+				</div>
+				
+			</h:form> 
+		</sakai:view>
+	</f:view>
 
-			<h:panelGroup rendered="#{mfSynopticBean.siteInfo.unreadPrivateAmt > 0}" >
-				<h:outputText 
-					value="#{msgs.syn_tool_link_begin}#{mfSynopticBean.siteInfo.privateMessagesUrl}';\">#{mfSynopticBean.siteInfo.unreadPrivateAmt}</a>"
-					escape="false" title="#{msgs.syn_goto_messages}" rendered="#{mfSynopticBean.siteInfo.unreadPrivateAmt > 0}" />
-				<h:outputText value="  " rendered="true" />
-
-	 			<h:commandLink action="synMain" actionListener="#{mfSynopticBean.processReadAll}" styleClass="active" >
-					<h:graphicImage url="/../library/image/silk/email_edit.png" title="#{msgs.syn_mark_as_read}" 
-						onmouseover="ImageRollOver(this, '/../library/image/silk/email_open.png');"
-						onmouseout="ImageRollOver(this, '/../library/image/silk/email_edit.png');" />
-					<f:param name="contextId" value="#{eachSite.siteId}" />
-				</h:commandLink>
-			</h:panelGroup>
-		</h:panelGroup>
-		
-		<h:panelGroup rendered="#{mfSynopticBean.messageForumsPageInSite || mfSynopticBean.forumsPageInSite}">
-			<h:outputText 
-				value="#{msgs.syn_tool_link_begin}#{mfSynopticBean.siteInfo.mcPageURL}';\">#{msgs.syn_discussion_heading}</a>"
-				escape="false" title="#{msgs.syn_goto_forums}" />
-		</h:panelGroup>
-
-		<h:panelGroup rendered="#{mfSynopticBean.messageForumsPageInSite || mfSynopticBean.forumsPageInSite}">
-			<h:outputText value="#{msgs.syn_no_messages}" rendered="#{mfSynopticBean.siteInfo.unreadForumsAmt == 0}" />
-			
-			<h:outputText value="#{msgs.syn_tool_link_begin}#{mfSynopticBean.siteInfo.mcPageURL}';\">#{mfSynopticBean.siteInfo.unreadForumsAmt}</a>" 
-							escape="false" title="#{msgs.syn_goto_forums}" rendered="#{mfSynopticBean.siteInfo.unreadForumsAmt > 0}"/>
-			<h:outputText value="  " rendered="true" />
-
-			<h:graphicImage url="/../library/image/silk/email.png" rendered="#{mfSynopticBean.siteInfo.unreadForumsAmt > 0}" />
-		</h:panelGroup>
-	</h:panelGrid>
-
-    <!-- This is the div for the popup definition. It is not displayed until the element is moused over -->
-    <div id="markAsRead" class="markasread_popup" 
-        style="position:absolute; top: -1000px; left: -1000px;" >
-  	  <h:outputText value="#{msgs.syn_mark_as_read}" />
-    </div>
-
-    </h:form> 
-  </sakai:view>
- </f:view>
-
- <% } %>
\ No newline at end of file
+<% } %>
\ No newline at end of file
Index: msgcntr/messageforums-app/src/webapp/jsp/dfMsgRevise.jsp
===================================================================
--- msgcntr/messageforums-app/src/webapp/jsp/dfMsgRevise.jsp	(revision 46869)
+++ msgcntr/messageforums-app/src/webapp/jsp/dfMsgRevise.jsp	(working copy)
@@ -2,123 +2,150 @@
 <%@ taglib uri="http://java.sun.com/jsf/core" prefix="f" %>
 <%@ taglib uri="http://sakaiproject.org/jsf/sakai" prefix="sakai" %>
 <jsp:useBean id="msgs" class="org.sakaiproject.util.ResourceLoader" scope="session">
-   <jsp:setProperty name="msgs" property="baseName" value="org.sakaiproject.api.app.messagecenter.bundle.Messages"/>
+	<jsp:setProperty name="msgs" property="baseName" value="org.sakaiproject.api.app.messagecenter.bundle.Messages"/>
 </jsp:useBean>
 
 <f:view>
-  <sakai:view_container title="#{msgs.cdfm_revise_forum_msg}">
-    <sakai:view_content>
-<!--jsp/dfMsgRevise.jsp-->
-	<h:form id="dfCompose">
-	       		<script type="text/javascript" src="/library/js/jquery.js"></script>
-       		<sakai:script contextBase="/sakai-messageforums-tool" path="/js/sak-10625.js"/>
-     <h3><h:outputText value="#{msgs.cdfm_revise_forum_msg}" /></h3>
-     <h4><h:outputText value="#{ForumTool.selectedForum.forum.title}-#{ForumTool.selectedTopic.topic.title}" /></h4> 
+	<sakai:view_container title="#{msgs.cdfm_revise_forum_msg}">
+		<sakai:view_content>
+		<!--jsp/dfMsgRevise.jsp-->
+		<h:form id="dfCompose">
+			<style type="text/css">
+				@import url("/sakai-messageforums-tool/css/msgcntr.css");
+			</style>
+			<script type="text/javascript" src="/library/js/jquery.js"></script>
+			<sakai:script contextBase="/sakai-messageforums-tool" path="/js/sak-10625.js"/>
+			<h3><h:outputText value="#{msgs.cdfm_revise_forum_msg}" /></h3>
+ 
+			<table class="topicBloc topicBlocLone">
+				<tr>
+					<td>
+						<span class ="title">
+							<h:outputText value="#{ForumTool.selectedForum.forum.title}-#{ForumTool.selectedTopic.topic.title}" />
+						</span>
+						<p class="textPanel">
+							<h:outputText value="#{ForumTool.selectedTopic.topic.shortDescription}"/>
+						</p>
+					</td>
+				</tr>
+			</table>	
 
-     <div class="textPanel">
-	 <h:outputText value="#{ForumTool.selectedTopic.topic.shortDescription}"/>
-        </div>
-	<p class="instruction">		
-              <h:outputText value="#{msgs.cdfm_required}"/>
-              <h:outputText value="#{msgs.cdfm_info_required_sign}" styleClass="reqStarInline" />
-	  </p>
-		
-          <h:panelGrid styleClass="jsfFormTable" columns="2" width="100%">
-            <h:panelGroup styleClass="required">
-							     <h:outputText value="#{msgs.cdfm_info_required_sign}" styleClass="reqStar"/>
-					   <h:outputLabel for="df_compose_title"><h:outputText value="#{msgs.cdfm_reply_title}" /></h:outputLabel>
+			<p class="instruction">		
+				<h:outputText value="#{msgs.cdfm_required}"/>
+				<h:outputText value="#{msgs.cdfm_info_required_sign}" styleClass="reqStarInline" />
+			</p>
 
-            </h:panelGroup>
-            <h:panelGroup>
-					   <h:inputText value="#{ForumTool.composeTitle}" size="40" required="true" id="df_compose_title" />
-				   </h:panelGroup>
+		<h:panelGrid styleClass="jsfFormTable" columns="1" style="width: 100%;">
+			<h:panelGroup>
+				<h:outputLabel for="df_compose_title" style="display:block;float:none;clear:both;padding-bottom:.3em">
+					<h:outputText value="#{msgs.cdfm_info_required_sign}" styleClass="reqStar"/>
+					<h:outputText value="#{msgs.cdfm_reply_title}" />
+				</h:outputLabel>
+				<h:inputText value="#{ForumTool.composeTitle}" size="40" required="true" id="df_compose_title" />
+			</h:panelGroup>
+		</h:panelGrid>
 
-          </h:panelGrid>
-		  <h4>
-	            <h:outputText value="#{msgs.cdfm_message}" />
-			</h4>	
-	            <sakai:rich_text_area value="#{ForumTool.composeBody}" rows="17" columns="70"/>
-	      
-	      
-<%--********************* Attachment *********************--%>	
-	        <h4>
-	          <h:outputText value="#{msgs.cdfm_att}"/>
-	        </h4>
-			<div class="instruction">
-	        <h:outputText value="#{msgs.cdfm_no_attachments}" rendered="#{empty ForumTool.attachments}"/>
-			</div>
-	          <sakai:button_bar>
-	          	<sakai:button_bar_item action="#{ForumTool.processAddAttachmentRedirect}" value="#{msgs.cdfm_button_bar_add_attachment_redirect}" immediate="true" accesskey="a" />
-	          </sakai:button_bar>
-			  	<%-- gsilver:moved rendered attribute from h:colun to dataTable - we do not want empty tables--%>
-					<h:dataTable styleClass="listHier lines nolines" id="attmsg" width="100%" value="#{ForumTool.attachments}" var="eachAttach"
-					columnClasses="att,bogus,itemAction specialLink,bogus,bogus" rendered="#{!empty ForumTool.attachments}">
-					  <h:column>
-							<f:facet name="header">
-							</f:facet>
-								<h:graphicImage url="/images/excel.gif" rendered="#{eachAttach.attachment.attachmentType == 'application/vnd.ms-excel'}" alt="" />
-								<h:graphicImage url="/images/html.gif" rendered="#{eachAttach.attachment.attachmentType == 'text/html'}" alt="" />
-								<h:graphicImage url="/images/pdf.gif" rendered="#{eachAttach.attachment.attachmentType == 'application/pdf'}" alt="" />
-								<h:graphicImage url="/images/ppt.gif" rendered="#{eachAttach.attachment.attachmentType == 'application/vnd.ms-powerpoint'}" alt="" />
-								<h:graphicImage url="/images/text.gif" rendered="#{eachAttach.attachment.attachmentType == 'text/plain'}" alt="" />
-								<h:graphicImage url="/images/word.gif" rendered="#{eachAttach.attachment.attachmentType == 'application/msword'}" alt="" />
-							</h:column>	
-							<h:column>
-							<f:facet name="header">
-								<h:outputText value="#{msgs.cdfm_title}"/>
-							</f:facet>
-							<h:outputText value="#{eachAttach.attachment.attachmentName}"/>
-							</h:column>
-							<h:column>
-								<h:commandLink action="#{ForumTool.processDeleteAttachRevise}" 
-									immediate="true"
-									onfocus="document.forms[0].onsubmit();"
-									title="#{msgs.cdfm_remove}">
-									<h:outputText value="#{msgs.cdfm_remove}"/>
-<%--									<f:param value="#{eachAttach.attachmentId}" name="dfmsg_current_attach"/>--%>
-									<f:param value="#{eachAttach.attachment.attachmentId}" name="dfmsg_current_attach"/>
-								</h:commandLink>
+
+
+			<h:outputText value="#{msgs.cdfm_message}" />
+
+			<sakai:rich_text_area value="#{ForumTool.composeBody}" rows="17" columns="70"/>
 			
-						</h:column>
-					  <h:column>
-							<f:facet name="header">
-								<h:outputText value="#{msgs.cdfm_attsize}" />
-							</f:facet>
-							<h:outputText value="#{eachAttach.attachment.attachmentSize}"/>
-						</h:column>
-					  <h:column>
-							<f:facet name="header">
-		  			    <h:outputText value="#{msgs.cdfm_atttype}" />
-							</f:facet>
-							<h:outputText value="#{eachAttach.attachment.attachmentType}"/>
-						</h:column>
-						</h:dataTable>   
+			<%--********************* Attachment *********************--%>	
+			<h4>
+				<h:outputText value="#{msgs.cdfm_att}"/>
+			</h4>
 
-        		
-<%--********************* Label *********************
-				<sakai:panel_titled>
-          <table width="80%" align="left">
-            <tr>
-              <td align="left" width="20%">
-                <h:outputText value="Label"/>
-              </td>
-              <td align="left">
- 							  <h:selectOneListbox size="1" id="viewlist">
-            		  <f:selectItem itemLabel="Normal" itemValue="none"/>
-          			</h:selectOneListbox>  
-              </td>                           
-            </tr>                                
-          </table>
-        </sakai:panel_titled>
---%>		        
-      <sakai:button_bar>
-        <sakai:button_bar_item action="#{ForumTool.processDfMsgRevisedPost}" value="#{msgs.cdfm_button_bar_post_revised_msg}" accesskey="s" styleClass="active" />
-       <%-- <sakai:button_bar_item action="#{ForumTool.processDfMsgSaveRevisedDraft}" value="#{msgs.cdfm_button_bar_save_draft}" /> --%>
-        <sakai:button_bar_item action="#{ForumTool.processDfMsgRevisedCancel}" value="#{msgs.cdfm_button_bar_cancel}" immediate="true" accesskey="x" />
-      </sakai:button_bar>
-    </h:form>
-     
-    </sakai:view_content>
-  </sakai:view_container>
+			<p class="instruction">
+				<h:outputText value="#{msgs.cdfm_no_attachments}" rendered="#{empty ForumTool.attachments}"/>
+			</p>
+			
+	
+			<%-- designNote: moved rendered attribute from h:colun to dataTable - we do not want empty tables--%>
+			<h:dataTable styleClass="attachPanel" id="attmsg" width="100%" value="#{ForumTool.attachments}" var="eachAttach"
+					columnClasses="att,bogus,itemAction specialLink,bogus,bogus" rendered="#{!empty ForumTool.attachments}" style="width:auto">
+				<h:column>
+					<f:facet name="header">
+					</f:facet>
+					<h:graphicImage url="/images/excel.gif" rendered="#{eachAttach.attachment.attachmentType == 'application/vnd.ms-excel'}" alt="" />
+					<h:graphicImage url="/images/html.gif" rendered="#{eachAttach.attachment.attachmentType == 'text/html'}" alt="" />
+					<h:graphicImage url="/images/pdf.gif" rendered="#{eachAttach.attachment.attachmentType == 'application/pdf'}" alt="" />
+					<h:graphicImage url="/images/ppt.gif" rendered="#{eachAttach.attachment.attachmentType == 'application/vnd.ms-powerpoint'}" alt="" />
+					<h:graphicImage url="/images/text.gif" rendered="#{eachAttach.attachment.attachmentType == 'text/plain'}" alt="" />
+					<h:graphicImage url="/images/word.gif" rendered="#{eachAttach.attachment.attachmentType == 'application/msword'}" alt="" />
+				</h:column>	
+				<h:column>
+					<f:facet name="header">
+						<h:outputText value="#{msgs.cdfm_title}"/>
+					</f:facet>
+					<h:outputText value="#{eachAttach.attachment.attachmentName}"/>
+				</h:column>
+				<h:column>
+					<h:commandLink action="#{ForumTool.processDeleteAttachRevise}" 
+							immediate="true"
+							onfocus="document.forms[0].onsubmit();"
+							title="#{msgs.cdfm_remove}">
+						<h:outputText value="#{msgs.cdfm_remove}"/>
+						<%--<f:param value="#{eachAttach.attachmentId}" name="dfmsg_current_attach"/>--%>
+						<f:param value="#{eachAttach.attachment.attachmentId}" name="dfmsg_current_attach"/>
+					</h:commandLink>
+				</h:column>
+				<h:column>
+					<f:facet name="header">
+						<h:outputText value="#{msgs.cdfm_attsize}" />
+					</f:facet>
+					<h:outputText value="#{eachAttach.attachment.attachmentSize}"/>
+				</h:column>
+				<h:column>
+					<f:facet name="header">
+						<h:outputText value="#{msgs.cdfm_atttype}" />
+					</f:facet>
+					<h:outputText value="#{eachAttach.attachment.attachmentType}"/>
+				</h:column>
+			</h:dataTable>   
+			
+			<p style="padding:0" class="act">
+				<sakai:button_bar_item 
+					rendered="#{empty ForumTool.attachments}"
+						action="#{ForumTool.processAddAttachmentRedirect}" 
+						value="#{msgs.cdfm_button_bar_add_attachment_redirect}" 
+						immediate="true" 
+						accesskey="a" 
+						style="font-size:95%"/>
+				<sakai:button_bar_item
+					rendered="#{!empty ForumTool.attachments}"
+						action="#{ForumTool.processAddAttachmentRedirect}"
+						value="#{msgs.cdfm_button_bar_add_attachment_more_redirect}"
+						immediate="true"
+						accesskey="a"
+						style="font-size:95%"/>
+			 </p>
+			
+			
+			<%--********************* Label *********************
+			<sakai:panel_titled>
+			<table width="80%" align="left">
+			<tr>
+			<td align="left" width="20%">
+			<h:outputText value="Label"/>
+			</td>
+			<td align="left">
+			<h:selectOneListbox size="1" id="viewlist">
+			<f:selectItem itemLabel="Normal" itemValue="none"/>
+			</h:selectOneListbox>  
+			</td>                           
+			</tr>                                
+			</table>
+			</sakai:panel_titled>
+			--%>		        
+			<p style="padding:0" class="act">
+				<sakai:button_bar_item action="#{ForumTool.processDfMsgRevisedPost}" value="#{msgs.cdfm_button_bar_post_revised_msg}" accesskey="s" styleClass="active" />
+				<%-- <sakai:button_bar_item action="#{ForumTool.processDfMsgSaveRevisedDraft}" value="#{msgs.cdfm_button_bar_save_draft}" /> --%>
+				<sakai:button_bar_item action="#{ForumTool.processDfMsgRevisedCancel}" value="#{msgs.cdfm_button_bar_cancel}" immediate="true" accesskey="x" />
+			</p>	
+		</h:form>
+		
+		</sakai:view_content>
+	</sakai:view_container>
 </f:view> 
 
Index: msgcntr/messageforums-app/src/webapp/jsp/dfCompose.jsp
===================================================================
--- msgcntr/messageforums-app/src/webapp/jsp/dfCompose.jsp	(revision 46869)
+++ msgcntr/messageforums-app/src/webapp/jsp/dfCompose.jsp	(working copy)
@@ -3,147 +3,161 @@
 <%@ taglib uri="http://sakaiproject.org/jsf/sakai" prefix="sakai" %>
 <%@ taglib uri="http://sakaiproject.org/jsf/messageforums" prefix="mf" %>
 <jsp:useBean id="msgs" class="org.sakaiproject.util.ResourceLoader" scope="session">
-   <jsp:setProperty name="msgs" property="baseName" value="org.sakaiproject.api.app.messagecenter.bundle.Messages"/>
+	<jsp:setProperty name="msgs" property="baseName" value="org.sakaiproject.api.app.messagecenter.bundle.Messages"/>
 </jsp:useBean>
 
 <f:view>
-  <sakai:view title="#{msgs.cdfm_container_title}">
-  <!--jsp/dfCompose.jsp-->
-    <h:form id="dfCompose">
-           		<script type="text/javascript" src="/library/js/jquery.js"></script>
-       		<sakai:script contextBase="/sakai-messageforums-tool" path="/js/sak-10625.js"/>
-      <h3><h:outputText value="#{msgs.cdfm_tool_bar_message}" /></h3>
-      <h4><h:outputText value="#{ForumTool.selectedForum.forum.title} - #{ForumTool.selectedTopic.topic.title}" /></h4> 
-	  <div class="textPanel">
-	  <h:outputText value="#{ForumTool.selectedTopic.topic.shortDescription}" />
-	  </div>
-	  <div class="textPanelFooter">
-        <h:commandLink immediate="true" 
-		                  action="#{ForumTool.processDfComposeToggle}" 
-					  			     onmousedown="document.forms[0].onsubmit();"
-						  		     rendered="#{ForumTool.selectedTopic.hasExtendedDesciption}" 
-							   	   value="#{msgs.cdfm_read_full_description}"
-							   	   title="#{msgs.cdfm_read_full_description}">
-		      <f:param value="dfCompose" name="redirectToProcessAction"/>
-		      <f:param value="true" name="composeExpand"/>
-		    </h:commandLink>
-		    <h:commandLink immediate="true" 
-		                action="#{ForumTool.processDfComposeToggle}" 
-								   onmousedown="document.forms[0].onsubmit();"
-			  					   value="#{msgs.cdfm_hide_full_description}" 
-			  					   rendered="#{ForumTool.selectedTopic.readFullDesciption}"
-			  					   title=" #{msgs.cdfm_hide_full_description}">
-		       <f:param value="dfCompose" name="redirectToProcessAction"/>
-		     </h:commandLink>					
-			</div>		 			 
-			 			 
-			<mf:htmlShowArea value="#{ForumTool.selectedTopic.topic.extendedDescription}" 
-		                   rendered="#{ForumTool.selectedTopic.readFullDesciption}"
-		                   id="topic_extended_description" 
-		                   hideBorder="false" />
-		                   
-		  <br />
-		                   
-			<div class="instruction">			 
+	<sakai:view title="#{msgs.cdfm_container_title}">
+		<!--jsp/dfCompose.jsp-->
+		<h:form id="dfCompose">
+			<style type="text/css">
+				@import url("/sakai-messageforums-tool/css/msgcntr.css");
+			</style>
+			<script type="text/javascript" src="/library/js/jquery.js"></script>
+			<sakai:script contextBase="/sakai-messageforums-tool" path="/js/sak-10625.js"/>
+			<h3><h:outputText value="#{msgs.cdfm_tool_bar_message}" /></h3>
+			<table class="topicBloc topicBlocLone specialLink">
+				<tr>
+					<td>
+						<h:outputText value="#{ForumTool.selectedForum.forum.title} /  #{ForumTool.selectedTopic.topic.title}"  styleClass="title"/> 
+						<div class="textPanel">
+							<h:outputText value="#{ForumTool.selectedTopic.topic.shortDescription}" />
+						</div>
+						<div>
+							<h:commandLink immediate="true" 
+									action="#{ForumTool.processDfComposeToggle}" 
+									onmousedown="document.forms[0].onsubmit();"
+									rendered="#{ForumTool.selectedTopic.hasExtendedDesciption}" 
+									title="#{msgs.cdfm_read_full_description}"
+									styleClass="show">
+								<h:graphicImage url="/images/collapse.gif"/>
+								<h:outputText value="#{msgs.cdfm_read_full_description}" />
+								<f:param value="dfCompose" name="redirectToProcessAction"/>
+								<f:param value="true" name="composeExpand"/>
+							</h:commandLink>
+							<h:commandLink immediate="true" 
+									action="#{ForumTool.processDfComposeToggle}" 
+									onmousedown="document.forms[0].onsubmit();"
+									rendered="#{ForumTool.selectedTopic.readFullDesciption}"
+									title=" #{msgs.cdfm_hide_full_description}"
+									styleClass="hide">
+								<h:graphicImage url="/images/expand.gif"/>
+								<h:outputText value="#{msgs.cdfm_hide_full_description}" />
+								<f:param value="dfCompose" name="redirectToProcessAction"/>
+							</h:commandLink>
+	
+							<%-- //designNote: am assuming that the thinking is that once the user is here 
+								there is no longer need for the long description context (or as much), so do not put it in
+								the response by default - same goes for attachment list if any --%>
+							<mf:htmlShowArea value="#{ForumTool.selectedTopic.topic.extendedDescription}" 
+									rendered="#{ForumTool.selectedTopic.readFullDesciption}"
+									id="topic_extended_description" 
+									hideBorder="true" />
+						</div>
+					</td>
+				</tr>
+			</table>
+			<div class="instruction"> 
 				 <h:outputText value="#{msgs.cdfm_required}"/>
 				 <h:outputText value="#{msgs.cdfm_info_required_sign}" styleClass="reqStarInline" />
-			  </div>
-			
-          <h:panelGrid styleClass="jsfFormTable" columns="2" width="100%">
-            <h:panelGroup styleClass="required">
-				     <h:outputText value="#{msgs.cdfm_info_required_sign}" styleClass="reqStar"/>
-					   <h:outputLabel for="df_compose_title"><h:outputText value="#{msgs.cdfm_title}" /></h:outputLabel>
-				   </h:panelGroup>
-            <h:panelGroup styleClass="shorttext">
-					   <h:inputText value="#{ForumTool.composeTitle}" style="width:30em;" required="true" id="df_compose_title">
-					     <f:validator validatorId="MessageTitle" />
-					   </h:inputText>
-				   </h:panelGroup>
-          </h:panelGrid>
+			 </div>
+			 <h:message for="df_compose_title" warnStyle="WARN" styleClass="messageAlert"/>
+			 <h:panelGrid styleClass="jsfFormTable" columns="1" width="100%" border="0" cellpadding="0">
+				<h:panelGroup>
+					<h:outputLabel for="df_compose_title" style="padding-bottom:.3em;display:block;clear:both;float:none">
+					<h:outputText value="#{msgs.cdfm_info_required_sign}" styleClass="reqStar"/>
+					<h:outputText value="#{msgs.cdfm_title}"/>
+				</h:outputLabel>
+					<h:inputText value="#{ForumTool.composeTitle}" style="width:30em;" required="true" id="df_compose_title">
+						<f:validator validatorId="MessageTitle" />
+					</h:inputText>
+				</h:panelGroup>
+			</h:panelGrid>
+				
 
-          <h:message for="df_compose_title" warnStyle="WARN" styleClass="alertMessage"/>
-		  <h4>
-	            <h:outputText value="#{msgs.cdfm_message}" />
-			</h4>	
-	            <sakai:rich_text_area value="#{ForumTool.composeBody}" rows="17" columns="70"/>
-<%--********************* Attachment *********************--%>	
-	      <h4>
-	        <h:outputText value="#{msgs.cdfm_att}" />
-	      </h4>
-		  <p class="instruction">	        
-		        <h:outputText value="#{msgs.cdfm_no_attachments}" rendered="#{empty ForumTool.attachments}"/>
+			<h:outputText value="#{msgs.cdfm_message}" />
+			<sakai:rich_text_area value="#{ForumTool.composeBody}" rows="17" columns="70"/>
+		
+			<%--********************* Attachment *********************--%>
+			<h4>
+				<h:outputText value="#{msgs.cdfm_att}" />
+			</h4>
+			<p>	        
+				<h:outputText value="#{msgs.cdfm_no_attachments}" rendered="#{empty ForumTool.attachments}" styleClass="instruction" style="display:block"/>
 			</p>	
-	        
-		  <sakai:button_bar>
-	          	<sakai:button_bar_item action="#{ForumTool.processAddAttachmentRedirect}" value="#{msgs.cdfm_button_bar_add_attachment_redirect}" immediate="true" accesskey="a" />
-	          </sakai:button_bar>
+		
+			<h:dataTable styleClass="attachPanel" id="attmsg" width="100%" value="#{ForumTool.attachments}"  rendered="#{!empty ForumTool.attachments}" var="eachAttach"  columnClasses=",itemAction specialLink,," cellpadding="0" cellspacing="0" style="width:auto">
+				<h:column rendered="#{!empty ForumTool.attachments}">
+					<f:facet name="header">
+						<h:outputText value="#{msgs.cdfm_title}"/>
+					</f:facet>
+					<h:graphicImage url="/images/attachment.gif" />
+					<h:outputText value=" "/>
+					<h:outputText value="#{eachAttach.attachment.attachmentName}"/>
+				</h:column>
+				<h:column>
+					<h:commandLink action="#{ForumTool.processDeleteAttach}" 
+							immediate="true"
+							onfocus="document.forms[0].onsubmit();"
+							title="#{msgs.cdfm_remove}">
+						<h:outputText value="#{msgs.cdfm_remove}"/>
+						<%-- <f:param value="#{eachAttach.attachmentId}" name="dfmsg_current_attach"/>--%>
+						<f:param value="#{eachAttach.attachment.attachmentId}" name="dfmsg_current_attach"/>
+					</h:commandLink>
+				</h:column>
+				<h:column rendered="#{!empty ForumTool.attachments}">
+					<f:facet name="header">
+						<h:outputText value="#{msgs.cdfm_attsize}" />
+					</f:facet>
+					<h:outputText value="#{eachAttach.attachment.attachmentSize}"/>
+				</h:column>
+				<h:column rendered="#{!empty ForumTool.attachments}">
+					<f:facet name="header">
+						<h:outputText value="#{msgs.cdfm_atttype}" />
+					</f:facet>
+					<h:outputText value="#{eachAttach.attachment.attachmentType}"/>
+				</h:column>
+			</h:dataTable>   
 
-	        
-	        
-					<h:dataTable styleClass="listHier lines nolines" id="attmsg" width="100%" value="#{ForumTool.attachments}" var="eachAttach"  columnClasses=",itemAction specialLink,," cellpadding="0" cellspacing="0">
-					  <h:column rendered="#{!empty ForumTool.attachments}">
-							<f:facet name="header">
-								<h:outputText value="#{msgs.cdfm_title}"/>
-							</f:facet>
-								<h:graphicImage url="/images/excel.gif" rendered="#{eachAttach.attachment.attachmentType == 'application/vnd.ms-excel'}" alt="" />
-								<h:graphicImage url="/images/html.gif" rendered="#{eachAttach.attachment.attachmentType == 'text/html'}" alt="" />
-								<h:graphicImage url="/images/pdf.gif" rendered="#{eachAttach.attachment.attachmentType == 'application/pdf'}"/>
-								<h:graphicImage url="/images/ppt.gif" rendered="#{eachAttach.attachment.attachmentType == 'application/vnd.ms-powerpoint'}" alt="" />
-								<h:graphicImage url="/images/text.gif" rendered="#{eachAttach.attachment.attachmentType == 'text/plain'}" alt="" />
-								<h:graphicImage url="/images/word.gif" rendered="#{eachAttach.attachment.attachmentType == 'application/msword'}" alt="" />
-							
-								<h:outputText value="#{eachAttach.attachment.attachmentName}"/>
-							</h:column>
-							<h:column>
+			<p style="padding:0" class="act">
+				<h:commandButton action="#{ForumTool.processAddAttachmentRedirect}" value="#{msgs.cdfm_button_bar_add_attachment_redirect}" immediate="true" accesskey="a" 
+					style="font-size:96%"  rendered="#{empty ForumTool.attachments}"/>
+				<h:commandButton action="#{ForumTool.processAddAttachmentRedirect}" value="#{msgs.cdfm_button_bar_add_attachment_more_redirect}" immediate="true" accesskey="a" 
+					style="font-size:96%"  rendered="#{!empty ForumTool.attachments}"/>
+			</p>
 
-								<h:commandLink action="#{ForumTool.processDeleteAttach}" 
-									             immediate="true"
-									             onfocus="document.forms[0].onsubmit();"
-									             title="#{msgs.cdfm_remove}">
-									<h:outputText value="#{msgs.cdfm_remove}"/>
-<%--									<f:param value="#{eachAttach.attachmentId}" name="dfmsg_current_attach"/>--%>
-									<f:param value="#{eachAttach.attachment.attachmentId}" name="dfmsg_current_attach"/>
-								</h:commandLink>
-						
-						</h:column>
-					  <h:column rendered="#{!empty ForumTool.attachments}">
-							<f:facet name="header">
-								<h:outputText value="#{msgs.cdfm_attsize}" />
-							</f:facet>
-							<h:outputText value="#{eachAttach.attachment.attachmentSize}"/>
-						</h:column>
-					  <h:column rendered="#{!empty ForumTool.attachments}">
-							<f:facet name="header">
-		  			    <h:outputText value="#{msgs.cdfm_atttype}" />
-							</f:facet>
-							<h:outputText value="#{eachAttach.attachment.attachmentType}"/>
-						</h:column>
-						</h:dataTable>   
-        		
-<%--********************* Label *********************
-				<sakai:panel_titled>
-          <table width="80%" align="left">
-            <tr>
-              <td align="left" width="20%">
-                <h:outputText value="Label"/>
-              </td>
-              <td align="left">
- 							  <h:selectOneListbox size="1" id="viewlist">
-            		  <f:selectItem itemLabel="Normal" itemValue="none"/>
-          			</h:selectOneListbox>  
-              </td>                           
-            </tr>                                
-          </table>
-        </sakai:panel_titled>
---%>		        
-      <sakai:button_bar>
-        <sakai:button_bar_item action="#{ForumTool.processDfMsgPost}" value="#{msgs.cdfm_button_bar_post_message}" accesskey="s" styleClass="active"/>
-      <%--  <sakai:button_bar_item action="#{ForumTool.processDfMsgSaveDraft}" value="#{msgs.cdfm_button_bar_save_draft}" /> --%>
-        <sakai:button_bar_item action="#{ForumTool.processDfMsgCancel}" value="#{msgs.cdfm_button_bar_cancel}" immediate="true" accesskey="x" />
-      </sakai:button_bar>
-    </h:form>
-     
+			<%--********************* Label *********************
+			<sakai:panel_titled>
+			<table width="80%" align="left">
+			<tr>
+			<td align="left" width="20%">
+			<h:outputText value="Label"/>
+			</td>
+			<td align="left">
+			<h:selectOneListbox size="1" id="viewlist">
+			<f:selectItem itemLabel="Normal" itemValue="none"/>
+			</h:selectOneListbox>  
+			</td>                           
+			</tr>                                
+			</table>
+			</sakai:panel_titled>
+			--%>        
+			<p style="padding:0" class="act">
+				<h:commandButton action="#{ForumTool.processDfMsgPost}" value="#{msgs.cdfm_button_bar_post_message}" accesskey="s" styleClass="active"/>
+				<%--  <sakai:button_bar_item action="#{ForumTool.processDfMsgSaveDraft}" value="#{msgs.cdfm_button_bar_save_draft}" /> --%>
+				<h:commandButton action="#{ForumTool.processDfMsgCancel}" value="#{msgs.cdfm_button_bar_cancel}" immediate="true" accesskey="x" />
+			</p>
+			<%--
+			<sakai:button_bar>
+				<sakai:button_bar_item action="#{ForumTool.processDfMsgPost}" value="#{msgs.cdfm_button_bar_post_message}" accesskey="s" styleClass="active"/>
+				<sakai:button_bar_item action="#{ForumTool.processDfMsgCancel}" value="#{msgs.cdfm_button_bar_cancel}" immediate="true" accesskey="x" />
+			</sakai:button_bar>
+			--%>
 
-  </sakai:view>
+			
+			
+			
+		</h:form>
+	</sakai:view>
 </f:view> 
 
Index: msgcntr/messageforums-app/src/webapp/jsp/dfReviseTopicSettingsAttach.jsp
===================================================================
--- msgcntr/messageforums-app/src/webapp/jsp/dfReviseTopicSettingsAttach.jsp	(revision 47396)
+++ msgcntr/messageforums-app/src/webapp/jsp/dfReviseTopicSettingsAttach.jsp	(working copy)
@@ -1,256 +1,279 @@
 <%@ page import="java.util.*, javax.faces.context.*, javax.faces.application.*,
-                 javax.faces.el.*, org.sakaiproject.tool.messageforums.*"%>
+	javax.faces.el.*, org.sakaiproject.tool.messageforums.*"%>
 <%@ taglib uri="http://java.sun.com/jsf/html" prefix="h" %>
 <%@ taglib uri="http://java.sun.com/jsf/core" prefix="f" %>
 <%@ taglib uri="http://sakaiproject.org/jsf/sakai" prefix="sakai" %>
 <%@ taglib uri="http://sakaiproject.org/jsf/messageforums" prefix="mf" %>
 <jsp:useBean id="msgs" class="org.sakaiproject.util.ResourceLoader" scope="session">
-   <jsp:setProperty name="msgs" property="baseName" value="org.sakaiproject.api.app.messagecenter.bundle.Messages"/>
+	<jsp:setProperty name="msgs" property="baseName" value="org.sakaiproject.api.app.messagecenter.bundle.Messages"/>
 </jsp:useBean>
 <f:view>
 	<sakai:script contextBase="/sakai-messageforums-tool" path="/js/permissions_header.js"/>
 	<sakai:script contextBase="/sakai-messageforums-tool" path="/js/forum.js"/>
-  <sakai:view title="#{msgs.cdfm_discussion_topic_settings}">
-<!--jsp/dfReviseTopicSettingsAttach.jsp-->
-    <h:form id="revise">
-           		<script type="text/javascript" src="/library/js/jquery.js"></script>
-       		<sakai:script contextBase="/sakai-messageforums-tool" path="/js/sak-10625.js"/>
-      <sakai:tool_bar_message value="#{msgs.cdfm_discussion_topic_settings}" />
- 			<div class="instruction">
-  			<h:outputText id="instruction"  value="#{msgs.cdfm_settings_instruction}"/>
-			 	<h:outputText value="#{msgs.cdfm_info_required_sign}" styleClass="reqStarInline" />
-			</div>
-			<h:messages errorClass="alertMessage" infoClass="success" id="errorMessages" /> 
-
-		  <h:panelGrid styleClass="jsfFormTable" columns="3" columnClasses="shorttext,">
-				<h:outputText id="req_star"  value="#{msgs.cdfm_info_required_sign}" styleClass="reqStarInline"/>	
-				<h:outputLabel id="outputLabel" for="topic_title"  value="#{msgs.cdfm_topic_title}"/>	
+	<sakai:view title="#{msgs.cdfm_discussion_topic_settings}">
+		<!--jsp/dfReviseTopicSettingsAttach.jsp-->
+		<h:form id="revise">
+			<style type="text/css">
+			@import url("/sakai-messageforums-tool/css/msgcntr.css");
+			</style>
+			<script type="text/javascript" src="/library/js/jquery.js"></script>
+			<sakai:script contextBase="/sakai-messageforums-tool" path="/js/sak-10625.js"/>      
+			<sakai:tool_bar_message value="#{msgs.cdfm_discussion_topic_settings}" />
+				<div class="instruction">
+					<h:outputText id="instruction"  value="#{msgs.cdfm_settings_instruction}"/>
+					<h:outputText value="#{msgs.cdfm_info_required_sign}" styleClass="reqStarInline" />
+				</div>
+			<h:messages errorClass="messageAlert" infoClass="success" id="errorMessages" /> 
+			
+			<h:panelGrid styleClass="jsfFormTable" columns="1"  columnClasses="shorttext">
+			<h:panelGroup>
+		
+				<h:outputLabel id="outputLabel" for="topic_title"   style="padding-bottom:.3em;display:block;clear:both;float:none">
+					<h:outputText id="req_star"  value="#{msgs.cdfm_info_required_sign}" styleClass="reqStarInline" style="padding-right:3px"/>
+					<h:outputText value="#{msgs.cdfm_topic_title}" />
+				</h:outputLabel>	 
 				<h:inputText size="50" id="topic_title"  value="#{ForumTool.selectedTopic.topic.title}"/>
+			</h:panelGroup>	
+			</h:panelGrid>
+			<h:panelGrid columns="1"  columnClasses="longtext">
+				<h:panelGroup>
+					<h:outputLabel id="outputLabel1" for="topic_shortDescription"  value="#{msgs.cdfm_shortDescription}"  styleClass="block"/>
+					<h:inputTextarea rows="3" cols="45" id="topic_shortDescription"  value="#{ForumTool.selectedTopic.topic.shortDescription}"/>
+				</h:panelGroup>	
+			</h:panelGrid>
 
-				<h:outputText value="" />
-				<h:outputLabel id="outputLabel1" for="topic_shortDescription"  value="#{msgs.cdfm_shortDescription}"/>
-				<h:inputTextarea rows="3" cols="45" id="topic_shortDescription"  value="#{ForumTool.selectedTopic.topic.shortDescription}"/>
-     	</h:panelGrid>
-		<h:panelGroup rendered="#{! ForumTool.disableLongDesc}">
-		  <h4>
-				<h:outputText id="outputLabel2"   value="#{msgs.cdfm_fullDescription}"/>
-			</h4>
-			<sakai:rich_text_area rows="10" columns="70"  value="#{ForumTool.selectedTopic.topic.extendedDescription}"/>
-		</h:panelGroup>
-		
-		<h4><h:outputText value="#{msgs.cdfm_att}"/></h4>
-		
-		<div class="instruction">	     
-			<h:outputText value="#{msgs.cdfm_no_attachments}" rendered="#{empty ForumTool.attachments}"/>
-			</div>
+			<%--RTEditor area - if enabled--%>
+			<h:panelGroup rendered="#{! ForumTool.disableLongDesc}">
+				<h4>
+					<h:outputText id="outputLabel2"   value="#{msgs.cdfm_fullDescription}"/>
+				</h4>
+				<sakai:rich_text_area rows="10" columns="70"  value="#{ForumTool.selectedTopic.topic.extendedDescription}"/>
+			</h:panelGroup>
+			
+			<%--Attachment area  --%>
+			<h4><h:outputText value="#{msgs.cdfm_att}"/></h4>
+			
+			
+			<%--designNote: would be nice to make this an include, as well as a more comprehensive MIME type check  --%>
+			<h:dataTable styleClass="attachPanel" id="attmsg" value="#{ForumTool.attachments}" var="eachAttach"  cellpadding="0" cellspacing="0" columnClasses="attach,bogus,specialLink,bogus,bogus" rendered="#{!empty ForumTool.attachments}">
+				<h:column>
+					<f:facet name="header">   <h:outputText escape="false"  value="&nbsp;"/>                                          
+					</f:facet>
 
-	        <sakai:button_bar>
-	        	<sakai:button_bar_item action="#{ForumTool.processAddAttachmentRedirect}" 
-	        	                       value="#{msgs.cdfm_button_bar_add_attachment_redirect}" 
-	        	                       immediate="true"
-	        	                       accesskey="a" />
-	        </sakai:button_bar>
-	        
-				<h:dataTable styleClass="listHier lines nolines" id="attmsg" width="100%" value="#{ForumTool.attachments}" var="eachAttach"  cellpadding="0" cellspacing="0" columnClasses="attach,bogus,itemAction specialLink,bogus,bogus" rendered="#{!empty ForumTool.attachments}">
+					<h:graphicImage url="/images/excel.gif" rendered="#{eachAttach.attachment.attachmentType == 'application/vnd.ms-excel'}" alt="" />
+					<h:graphicImage url="/images/html.gif" rendered="#{eachAttach.attachment.attachmentType == 'text/html'}" alt="" />
+					<h:graphicImage url="/images/pdf.gif" rendered="#{eachAttach.attachment.attachmentType == 'application/pdf'}" alt="" />
+					<h:graphicImage url="/images/ppt.gif" rendered="#{eachAttach.attachment.attachmentType == 'application/vnd.ms-powerpoint'}" alt="" />
+					<h:graphicImage url="/images/text.gif" rendered="#{eachAttach.attachment.attachmentType == 'text/plain'}" alt="" />
+					<h:graphicImage url="/images/word.gif" rendered="#{eachAttach.attachment.attachmentType == 'application/msword'}" alt="" />
+				</h:column>
+				<h:column>
 					<f:facet name="header">
+						<h:outputText value="#{msgs.cdfm_title}"/>
 					</f:facet>
-			  
-				<h:column>
-							<h:graphicImage url="/images/excel.gif" rendered="#{eachAttach.attachment.attachmentType == 'application/vnd.ms-excel'}" alt="" />
-							<h:graphicImage url="/images/html.gif" rendered="#{eachAttach.attachment.attachmentType == 'text/html'}" alt="" />
-							<h:graphicImage url="/images/pdf.gif" rendered="#{eachAttach.attachment.attachmentType == 'application/pdf'}" alt="" />
-							<h:graphicImage url="/images/ppt.gif" rendered="#{eachAttach.attachment.attachmentType == 'application/vnd.ms-powerpoint'}" alt="" />
-							<h:graphicImage url="/images/text.gif" rendered="#{eachAttach.attachment.attachmentType == 'text/plain'}" alt="" />
-							<h:graphicImage url="/images/word.gif" rendered="#{eachAttach.attachment.attachmentType == 'application/msword'}" alt="" />
+					<h:outputText value="#{eachAttach.attachment.attachmentName}"/>
 				</h:column>
 				<h:column>
-						<f:facet name="header">
-							<h:outputText value="#{msgs.cdfm_title}"/>
-						</f:facet>
-							<h:outputText value="#{eachAttach.attachment.attachmentName}"/>
+				<f:facet name="header"><h:outputText escape="false" value="&nbsp;"/>
+				</f:facet>
+					<h:commandLink action="#{ForumTool.processDeleteAttachSetting}" 
+							immediate="true"
+							onfocus="document.forms[0].onsubmit();"
+							title="#{msgs.cdfm_remove}">
+						<h:outputText value="#{msgs.cdfm_remove}"/>
+						<f:param value="#{eachAttach.attachment.attachmentId}" name="dfmsg_current_attach"/>
+					</h:commandLink>
 				</h:column>
-				<h:column>
-							<h:commandLink action="#{ForumTool.processDeleteAttachSetting}" 
-								immediate="true"
-								onfocus="document.forms[0].onsubmit();"
-								title="#{msgs.cdfm_remove}">
-							<h:outputText value="#{msgs.cdfm_remove}"/>
-								<f:param value="#{eachAttach.attachment.attachmentId}" name="dfmsg_current_attach"/>
-							</h:commandLink>
-						
-				  </h:column>
-					<h:column rendered="#{!empty ForumTool.attachments}">
-						<f:facet name="header">
-							<h:outputText value="#{msgs.cdfm_attsize}" />
-						</f:facet>
-						<h:outputText value="#{eachAttach.attachment.attachmentSize}"/>
-					</h:column>
-					<h:column rendered="#{!empty ForumTool.attachments}">
-						<f:facet name="header">
-		  			  <h:outputText value="#{msgs.cdfm_atttype}" />
-						</f:facet>
-						<h:outputText value="#{eachAttach.attachment.attachmentType}"/>
-					</h:column>
-					</h:dataTable>   
+				<h:column rendered="#{!empty ForumTool.attachments}">
+					<f:facet name="header">
+						<h:outputText value="#{msgs.cdfm_attsize}" />
+					</f:facet>
+					<h:outputText value="#{eachAttach.attachment.attachmentSize}"/>
+				</h:column>
+				<h:column rendered="#{!empty ForumTool.attachments}">
+					<f:facet name="header">
+						<h:outputText value="#{msgs.cdfm_atttype}" />
+					</f:facet>
+					<h:outputText value="#{eachAttach.attachment.attachmentType}"/>
+				</h:column>
+			</h:dataTable>   
+
+			<div class="instruction">	     
+				<h:outputText value="#{msgs.cdfm_no_attachments}" rendered="#{empty ForumTool.attachments}"/>
+			</div>
 			
-
-       <div class="discTria" style="padding: 0.5em; margin-top:0.8em;"><h4><h:outputText  value="#{msgs.cdfm_topic_posting}"/></h4></div>
-
-			<h:panelGrid columns="2">
-				
+			<p class="act" style="padding:0 0 1em 0;">
+				<sakai:button_bar_item action="#{ForumTool.processAddAttachmentRedirect}" 
+					value="#{msgs.cdfm_button_bar_add_attachment_more_redirect}" 
+					immediate="true"
+					accesskey="a" 
+					 rendered="#{!empty ForumTool.attachments}"
+					 />
+				<sakai:button_bar_item action="#{ForumTool.processAddAttachmentRedirect}" 
+					value="#{msgs.cdfm_button_bar_add_attachment_redirect}" 
+					immediate="true"
+					accesskey="a" 
+					 rendered="#{empty ForumTool.attachments}" 
+					 />
+			</p>
+			                                                                                  
+			<%--general posting  forum settings --%>
+			<h4><h:outputText  value="#{msgs.cdfm_topic_posting}"/></h4>
+			
+			<h:panelGrid columns="2"  styleClass="jsfFormTable">
 				<h:panelGroup>
-				  <h:outputLabel for="topic_locked"  value="#{msgs.cdfm_lock_topic}" styleClass="shorttext"/>	
+					<h:outputLabel for="topic_locked"  value="#{msgs.cdfm_lock_topic}" styleClass="shorttext"/>	
 				</h:panelGroup>
 				<h:panelGroup>
-					<h:selectOneRadio layout="pageDirection"  id="topic_locked"  value="#{ForumTool.selectedTopic.locked}" styleClass="checkbox inlineForm">
-    					<f:selectItem itemValue="true" itemLabel="#{msgs.cdfm_yes}"/>
-    					<f:selectItem itemValue="false" itemLabel="#{msgs.cdfm_no}"/>
-  					</h:selectOneRadio>
+					<h:selectOneRadio layout="lineDirection"  id="topic_locked"  value="#{ForumTool.selectedTopic.locked}" styleClass="checkbox inlineForm">
+						<f:selectItem itemValue="true" itemLabel="#{msgs.cdfm_yes}"/>
+						<f:selectItem itemValue="false" itemLabel="#{msgs.cdfm_no}"/>
+					</h:selectOneRadio>
 				</h:panelGroup>
 				<h:panelGroup>
-				  <h:outputLabel for="moderated"  value="#{msgs.cdfm_moderate_topic}" styleClass="shorttext"/>	
+					<h:outputLabel for="moderated"  value="#{msgs.cdfm_moderate_topic}" styleClass="shorttext"/>	
 				</h:panelGroup>
 				<h:panelGroup>
-					<h:selectOneRadio layout="pageDirection"  id="moderated"  value="#{ForumTool.selectedTopic.moderated}" styleClass="checkbox inlineForm"
-								onclick="javascript:disableOrEnableModeratePerm();" >
-    					<f:selectItem itemValue="true" itemLabel="#{msgs.cdfm_yes}"/>
-    					<f:selectItem itemValue="false" itemLabel="#{msgs.cdfm_no}"/>
-  					</h:selectOneRadio>
+					<h:selectOneRadio layout="lineDirection"  id="moderated"  value="#{ForumTool.selectedTopic.moderated}" styleClass="checkbox inlineForm"
+							onclick="javascript:disableOrEnableModeratePerm();" >
+						<f:selectItem itemValue="true" itemLabel="#{msgs.cdfm_yes}"/>
+						<f:selectItem itemValue="false" itemLabel="#{msgs.cdfm_no}"/>
+					</h:selectOneRadio>
 				</h:panelGroup>
 			</h:panelGrid>
-
-		<%--
-		   <h4><h:outputText  value="Confidential Responses"/></h4>
-		   <h:selectBooleanCheckbox   title= "#{msgs.cdfm_topic_allow_anonymous_postings}"  value="false" />
-		   <h:outputText   value="  #{msgs.cdfm_topic_allow_anonymous_postings}" /> 
-		   <br/>
-		   <h:selectBooleanCheckbox   title= "#{msgs.cdfm_topic_author_identity}"  value="false" />
-		   <h:outputText   value="  #{msgs.cdfm_topic_author_identity}" />
-     
-       <h4><h:outputText  value="#{mags.cdfm_topic_post_before_reading}"/></h4>
-    	   <p class="shorttext">
+			
+			<%--
+			<h4><h:outputText  value="Confidential Responses"/></h4>
+			<h:selectBooleanCheckbox   title= "#{msgs.cdfm_topic_allow_anonymous_postings}"  value="false" />
+			<h:outputText   value="  #{msgs.cdfm_topic_allow_anonymous_postings}" /> 
+			<br/>
+			<h:selectBooleanCheckbox   title= "#{msgs.cdfm_topic_author_identity}"  value="false" />
+			<h:outputText   value="  #{msgs.cdfm_topic_author_identity}" />
+			
+			<h4><h:outputText  value="#{mags.cdfm_topic_post_before_reading}"/></h4>
+			<p class="shorttext">
 			<h:panelGrid columns="2">
-				<h:panelGroup><h:outputLabel id="outputLabel4" for="topic_reading"  value="#{msgs.cdfm_topic_post_before_reading_desc}"/>	</h:panelGroup>
-				<h:panelGroup>
-					<h:selectOneRadio layout="pageDirection"  id="topic_reading" value="#{ForumTool.selectedTopic.mustRespondBeforeReading}">
-    					<f:selectItem itemValue="true" itemLabel="#{msgs.cdfm_yes}"/>
-    					<f:selectItem itemValue="false" itemLabel="#{msgs.cdfm_no}"/>
-  					</h:selectOneRadio>
-				</h:panelGroup>
+			<h:panelGroup><h:outputLabel id="outputLabel4" for="topic_reading"  value="#{msgs.cdfm_topic_post_before_reading_desc}"/>	</h:panelGroup>
+			<h:panelGroup>
+			<h:selectOneRadio layout="pageDirection"  id="topic_reading" value="#{ForumTool.selectedTopic.mustRespondBeforeReading}">
+			<f:selectItem itemValue="true" itemLabel="#{msgs.cdfm_yes}"/>
+			<f:selectItem itemValue="false" itemLabel="#{msgs.cdfm_no}"/>
+			</h:selectOneRadio>
+			</h:panelGroup>
 			</h:panelGrid>
-		</p>
-		  --%>
-      		  
-      <%@include file="/jsp/discussionForum/permissions/permissions_include.jsp"%>
-	  <%--
-      <mf:forumHideDivision title="#{msgs.cdfm_access}" id="access_perm" hideByDefault="true">
-	  	<p class="shorttext">
+			</p>
+			--%>
+			
+			<%@include file="/jsp/discussionForum/permissions/permissions_include.jsp"%>
+			<%--
+			<mf:forumHideDivision title="#{msgs.cdfm_access}" id="access_perm" hideByDefault="true">
+			<p class="shorttext">
 			<h:panelGrid columns="2" width="50%">
-				<h:panelGroup><h:outputLabel id="outputLabelCont" for="contributors"  value="#{msgs.cdfm_contributors}"/>	</h:panelGroup>
-				<h:panelGroup>
-					<h:selectManyListbox id="contributors"  value="#{ForumTool.selectedTopic.contributorsList}" size="5" style="width:200px;">
-    					<f:selectItems value="#{ForumTool.totalComposeToList}" />
-  					</h:selectManyListbox>
-				</h:panelGroup>
-
-			  <h:panelGroup><h:outputLabel id="outputLabelRead" for="readOnly"  value="#{msgs.cdfm_read_only_access}"/>	</h:panelGroup>
-				<h:panelGroup>
-					<h:selectManyListbox  id="readOnly"  value="#{ForumTool.selectedTopic.accessorList}" size="5" style="width:200px;">
-    					<f:selectItems value="#{ForumTool.totalComposeToList}"  />
-  					</h:selectManyListbox>
-				</h:panelGroup>
+			<h:panelGroup><h:outputLabel id="outputLabelCont" for="contributors"  value="#{msgs.cdfm_contributors}"/>	</h:panelGroup>
+			<h:panelGroup>
+			<h:selectManyListbox id="contributors"  value="#{ForumTool.selectedTopic.contributorsList}" size="5" style="width:200px;">
+			<f:selectItems value="#{ForumTool.totalComposeToList}" />
+			</h:selectManyListbox>
+			</h:panelGroup>
+			
+			<h:panelGroup><h:outputLabel id="outputLabelRead" for="readOnly"  value="#{msgs.cdfm_read_only_access}"/>	</h:panelGroup>
+			<h:panelGroup>
+			<h:selectManyListbox  id="readOnly"  value="#{ForumTool.selectedTopic.accessorList}" size="5" style="width:200px;">
+			<f:selectItems value="#{ForumTool.totalComposeToList}"  />
+			</h:selectManyListbox>
+			</h:panelGroup>
 			</h:panelGrid>
-		</p>
-	  </mf:forumHideDivision>
-      <mf:forumHideDivision title="#{msgs.cdfm_control_permissions}" id="cntrl_perm" hideByDefault="true">
-          <h:dataTable styleClass="listHier" id="control_permissions" value="#{ForumTool.topicControlPermissions}" var="cntrl_settings">
-   			<h:column>
-				<f:facet name="header"><h:outputText value="#{msgs.perm_role}" /></f:facet>
-				<h:outputText value="#{cntrl_settings.role}"/>
+			</p>
+			</mf:forumHideDivision>
+			<mf:forumHideDivision title="#{msgs.cdfm_control_permissions}" id="cntrl_perm" hideByDefault="true">
+			<h:dataTable styleClass="listHier" id="control_permissions" value="#{ForumTool.topicControlPermissions}" var="cntrl_settings">
+			<h:column>
+			<f:facet name="header"><h:outputText value="#{msgs.perm_role}" /></f:facet>
+			<h:outputText value="#{cntrl_settings.role}"/>
 			</h:column>			 
 			<h:column>
-				<f:facet name="header"><h:outputText value="#{msgs.perm_new_response}" /></f:facet>
-				<h:selectBooleanCheckbox disabled="true" value="#{cntrl_settings.newResponse}"/>
+			<f:facet name="header"><h:outputText value="#{msgs.perm_new_response}" /></f:facet>
+			<h:selectBooleanCheckbox disabled="true" value="#{cntrl_settings.newResponse}"/>
 			</h:column>
 			<h:column>
-				<f:facet name="header"><h:outputText value="#{msgs.perm_response_to_response}" /></f:facet>
-				<h:selectBooleanCheckbox disabled="true"  value="#{cntrl_settings.responseToResponse}"/>
+			<f:facet name="header"><h:outputText value="#{msgs.perm_response_to_response}" /></f:facet>
+			<h:selectBooleanCheckbox disabled="true"  value="#{cntrl_settings.responseToResponse}"/>
 			</h:column>
 			<h:column>
-				<f:facet name="header">	<h:outputText value="#{msgs.perm_move_postings}" /></f:facet>
-				<h:selectBooleanCheckbox value="#{cntrl_settings.movePostings}"/>
+			<f:facet name="header">	<h:outputText value="#{msgs.perm_move_postings}" /></f:facet>
+			<h:selectBooleanCheckbox value="#{cntrl_settings.movePostings}"/>
 			</h:column>
 			<h:column>
-				<f:facet name="header"><h:outputText value="#{msgs.perm_change_settings}" /></f:facet>
-				<h:selectBooleanCheckbox disabled="true" value="#{cntrl_settings.changeSettings}"/>
+			<f:facet name="header"><h:outputText value="#{msgs.perm_change_settings}" /></f:facet>
+			<h:selectBooleanCheckbox disabled="true" value="#{cntrl_settings.changeSettings}"/>
 			</h:column>
 			<h:column>
-				<f:facet name="header"><h:outputText value="#{msgs.perm_post_to_gradebook}" /></f:facet>
-				<h:selectBooleanCheckbox value="#{cntrl_settings.postToGradebook}"/>
+			<f:facet name="header"><h:outputText value="#{msgs.perm_post_to_gradebook}" /></f:facet>
+			<h:selectBooleanCheckbox value="#{cntrl_settings.postToGradebook}"/>
 			</h:column>
-		</h:dataTable>
-      </mf:forumHideDivision>
-      <mf:forumHideDivision title="#{msgs.cdfm_message_permissions}" id="msg_perm" hideByDefault="true">
-            <h:dataTable styleClass="listHier" id="message_permissions" value="#{ForumTool.topicMessagePermissions}" var="msg_settings">
-   			<h:column>
-				<f:facet name="header"><h:outputText value="#{msgs.perm_role}" /></f:facet>
-				<h:outputText value="#{msg_settings.role}"/>
+			</h:dataTable>
+			</mf:forumHideDivision>
+			<mf:forumHideDivision title="#{msgs.cdfm_message_permissions}" id="msg_perm" hideByDefault="true">
+			<h:dataTable styleClass="listHier" id="message_permissions" value="#{ForumTool.topicMessagePermissions}" var="msg_settings">
+			<h:column>
+			<f:facet name="header"><h:outputText value="#{msgs.perm_role}" /></f:facet>
+			<h:outputText value="#{msg_settings.role}"/>
 			</h:column>
-			 <h:column>
-				<f:facet name="header"><h:outputText value="#{msgs.perm_read}" /></f:facet>
-				<h:selectBooleanCheckbox  disabled="true" value="#{msg_settings.read}"/>
+			<h:column>
+			<f:facet name="header"><h:outputText value="#{msgs.perm_read}" /></f:facet>
+			<h:selectBooleanCheckbox  disabled="true" value="#{msg_settings.read}"/>
 			</h:column>
 			<h:column>
-				<f:facet name="header"><h:outputText value="#{msgs.perm_revise_any}" /></f:facet>
-				<h:selectBooleanCheckbox disabled="true" value="#{msg_settings.reviseAny}"/>
+			<f:facet name="header"><h:outputText value="#{msgs.perm_revise_any}" /></f:facet>
+			<h:selectBooleanCheckbox disabled="true" value="#{msg_settings.reviseAny}"/>
 			</h:column>
 			<h:column>
-				<f:facet name="header">	<h:outputText value="#{msgs.perm_revise_own}" /></f:facet>
-				<h:selectBooleanCheckbox disabled="true" value="#{msg_settings.reviseOwn}"/>
+			<f:facet name="header">	<h:outputText value="#{msgs.perm_revise_own}" /></f:facet>
+			<h:selectBooleanCheckbox disabled="true" value="#{msg_settings.reviseOwn}"/>
 			</h:column>
 			<h:column>
-				<f:facet name="header"><h:outputText value="#{msgs.perm_delete_any}" /></f:facet>
-				<h:selectBooleanCheckbox disabled="true" value="#{msg_settings.deleteAny}"/>
+			<f:facet name="header"><h:outputText value="#{msgs.perm_delete_any}" /></f:facet>
+			<h:selectBooleanCheckbox disabled="true" value="#{msg_settings.deleteAny}"/>
 			</h:column>
 			<h:column>
-				<f:facet name="header">	<h:outputText value="#{msgs.perm_delete_own}" /></f:facet>
-				<h:selectBooleanCheckbox  disabled="true" value="#{msg_settings.deleteOwn}"/>
+			<f:facet name="header">	<h:outputText value="#{msgs.perm_delete_own}" /></f:facet>
+			<h:selectBooleanCheckbox  disabled="true" value="#{msg_settings.deleteOwn}"/>
 			</h:column>
 			<h:column>
-				<f:facet name="header"><h:outputText value="#{msgs.perm_mark_as_read}" /></f:facet>
-				<h:selectBooleanCheckbox disabled="true" value="#{msg_settings.markAsRead}"/>
+			<f:facet name="header"><h:outputText value="#{msgs.perm_mark_as_read}" /></f:facet>
+			<h:selectBooleanCheckbox disabled="true" value="#{msg_settings.markAsRead}"/>
 			</h:column>			 		
-		</h:dataTable>
-      </mf:forumHideDivision>
-      --%>
-      
-      <div class="act">
-          <h:commandButton action="#{ForumTool.processActionSaveTopicSettings}" value="#{msgs.cdfm_button_bar_save_setting}" accesskey="s"
-          								 rendered="#{!ForumTool.selectedTopic.markForDeletion}"> 
-    	 	  	<f:param value="#{ForumTool.selectedTopic.topic.id}" name="topicId"/>    
-    	 	  	<f:param value="#{ForumTool.selectedForum.forum.id}" name="forumId"/>         
-          </h:commandButton>
-          <h:commandButton action="#{ForumTool.processActionSaveTopicAsDraft}" value="#{msgs.cdfm_button_bar_save_draft}" accesskey="v"
-          								 rendered="#{!ForumTool.selectedTopic.markForDeletion}">
-	        	<f:param value="#{ForumTool.selectedTopic.topic.id}" name="topicId"/>
-	        	<f:param value="#{ForumTool.selectedForum.forum.id}" name="forumId"/> 
-          </h:commandButton>
-          <h:commandButton action="#{ForumTool.processActionSaveTopicAndAddTopic}" value="#{msgs.cdfm_button_bar_save_setting_add_topic}" accesskey="t"
-          								 rendered="#{!ForumTool.selectedTopic.markForDeletion}">
-	        	<f:param value="#{ForumTool.selectedTopic.topic.id}" name="topicId"/>
-	        	<f:param value="#{ForumTool.selectedForum.forum.id}" name="forumId"/> 
-          </h:commandButton>
-          <h:commandButton action="#{ForumTool.processActionDeleteTopicConfirm}" id="delete_confirm" 
-                           value="#{msgs.cdfm_button_bar_delete}" accesskey="d" rendered="#{!ForumTool.selectedTopic.markForDeletion && ForumTool.displayTopicDeleteOption}">
-	        	<f:param value="#{ForumTool.selectedTopic.topic.id}" name="topicId"/>
-          </h:commandButton>
-          <h:commandButton action="#{ForumTool.processActionDeleteTopic}" id="delete" accesskey="d"
-                           value="#{msgs.cdfm_button_bar_delete}" rendered="#{ForumTool.selectedTopic.markForDeletion}">
-	        	<f:param value="#{ForumTool.selectedTopic.topic.id}" name="topicId"/>
-          </h:commandButton>
-          <h:commandButton  action="#{ForumTool.processActionHome}" value="#{msgs.cdfm_button_bar_cancel}" accesskey="c" />
-       </div>
-       
-	 </h:form>
-    </sakai:view>
+			</h:dataTable>
+			</mf:forumHideDivision>
+			--%>
+			
+			<div class="act">
+			<h:commandButton action="#{ForumTool.processActionSaveTopicSettings}" value="#{msgs.cdfm_button_bar_save_setting}" accesskey="s"
+			rendered="#{!ForumTool.selectedTopic.markForDeletion}"> 
+			<f:param value="#{ForumTool.selectedTopic.topic.id}" name="topicId"/>    
+			<f:param value="#{ForumTool.selectedForum.forum.id}" name="forumId"/>         
+			</h:commandButton>
+			<h:commandButton action="#{ForumTool.processActionSaveTopicAsDraft}" value="#{msgs.cdfm_button_bar_save_draft}" accesskey="v"
+			rendered="#{!ForumTool.selectedTopic.markForDeletion}">
+			<f:param value="#{ForumTool.selectedTopic.topic.id}" name="topicId"/>
+			<f:param value="#{ForumTool.selectedForum.forum.id}" name="forumId"/> 
+			</h:commandButton>
+			<h:commandButton action="#{ForumTool.processActionSaveTopicAndAddTopic}" value="#{msgs.cdfm_button_bar_save_setting_add_topic}" accesskey="t"
+			rendered="#{!ForumTool.selectedTopic.markForDeletion}">
+			<f:param value="#{ForumTool.selectedTopic.topic.id}" name="topicId"/>
+			<f:param value="#{ForumTool.selectedForum.forum.id}" name="forumId"/> 
+			</h:commandButton>
+			<h:commandButton action="#{ForumTool.processActionDeleteTopicConfirm}" id="delete_confirm" 
+			value="#{msgs.cdfm_button_bar_delete}" accesskey="d" rendered="#{!ForumTool.selectedTopic.markForDeletion && ForumTool.displayTopicDeleteOption}">
+			<f:param value="#{ForumTool.selectedTopic.topic.id}" name="topicId"/>
+			</h:commandButton>
+			<h:commandButton action="#{ForumTool.processActionDeleteTopic}" id="delete" accesskey="d"
+			value="#{msgs.cdfm_button_bar_delete}" rendered="#{ForumTool.selectedTopic.markForDeletion}">
+			<f:param value="#{ForumTool.selectedTopic.topic.id}" name="topicId"/>
+			</h:commandButton>
+			<h:commandButton  action="#{ForumTool.processActionHome}" value="#{msgs.cdfm_button_bar_cancel}" accesskey="c" />
+			</div>
+			
+		</h:form>
+	</sakai:view>
 </f:view>
